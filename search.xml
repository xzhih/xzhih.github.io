<?xml version="1.0" encoding="utf-8"?>
<search> 
  
    
    <entry>
      <title>ç»™ä½ çš„NginxåŠ ä¸ªé˜²ç«å¢™</title>
      <link href="/ngx-lua-waf/"/>
      <url>/ngx-lua-waf/</url>
      
        <content type="html"><![CDATA[<h2 id="å¼•è¨€"><a href="#å¼•è¨€" class="headerlink" title="å¼•è¨€"></a>å¼•è¨€</h2><p>å‰å‡ å¤©æœ‰ä¸ªæœ‹å‹è·Ÿæˆ‘è¯´ï¼Œä»–çš„ä¸€ä¸ª WordPress ç«™ç»å¸¸è®¿é—®æ…¢ã€‚</p><p>å¸®ä»–çœ‹äº†ä¸€ä¸‹æ—¥å¿—ï¼Œå‘ç°æ•´å¤©è¢«äººæ‰«ç½‘ç«™ç›®å½•çš„ä»€ä¹ˆ phpmyadmin æˆ–è€… SQL æ–‡ä»¶ï¼Œè¦ä¸å°±æ˜¯è¢« CCï¼Œåˆšå¼€å§‹æˆ‘è¿˜ä»¥ä¸ºæ˜¯ä¸»æœºå•†å¸®æ‰«æ¼æ´ä¹‹ç±»çš„ï¼Œåæ¥å‘ç°å®åœ¨æ˜¯å¤ªå¯†é›†äº†ï¼Œçœ‹æ¥ä¸æ˜¯ã€‚</p><p>æˆ‘å°±ç¬‘äº†ï¼Œä»–é‚£ç ´ç«™æœ‰å•¥å€¼å¾—æ‰«çš„ï¼Œä¸è¿‡ CC çš„è¯å€’ä¹Ÿä¸å¥‡æ€ªï¼Œæœ‰äº›äººå°±æ˜¯çˆ±æè¿™äº›æ— èŠçš„äº‹æƒ…ã€‚</p><p>ç„¶åä»–åˆè¯´ï¼Œç”¨çš„æ˜¯è…¾è®¯äº‘çš„1å…ƒå°é¸¡ï¼Œåˆšå¼€å§‹éå¸¸æµç•…çš„å•Šï¼Œä¸è‡³äºç°åœ¨è¿™ä¹ˆæƒ¨å§ã€‚</p><p>æˆ‘çœ‹äº†ä¸€ä¸‹çœŸæç¬‘ï¼Œæœ¬èº«æœºå™¨æ€§èƒ½å°±ä¸è¡Œäº†ï¼Œè¿˜ä¸åšé™æ€åŒ–ï¼Œè¢« CC çš„æ—¶å€™è´Ÿè½½è‡ªç„¶ä¸Šå»äº†ï¼Œè€Œä¸”å°é¸¡æ‰ 1M çš„å¸¦å®½ï¼Œä¸æ…¢æ‰æ€ªã€‚</p><p>ä»–è¯´ä»–çš„ç«™å°±å†™å†™ç¬”è®°æˆ–è€…è½¬è½½ä¸€äº›æ–‡ç« ï¼Œä¹Ÿä¸æ˜¯ä»€ä¹ˆé‡è¦çš„ä¸œè¥¿ï¼Œä½†æ˜¯æ•´å¤©è¢«æä¹Ÿæ˜¯ä¸å¤ªçˆ½ï¼Œæ€ä¹ˆå¼„æ‰èƒ½è§£å†³ã€‚ã€‚ã€‚</p><p>æˆ‘æƒ³ä¹Ÿæ˜¯ï¼Œè™½ç„¶ä¸œè¥¿æ˜¯åƒåœ¾ï¼Œä½†å¥½æ­¹è¿˜æ˜¯åœ¨ç”¨çš„ï¼Œä¸è¿‡å˜›è§£å†³æ˜¯ä¸å¯èƒ½è§£å†³çš„ï¼Œåªè¦åˆ«äººèƒ½è®¿é—®ï¼Œä½ å°±ä¼šé‡åˆ°è¿™æ ·é‚£æ ·çš„å‚»é€¼ï¼Œä¸è¿‡æ”¹å–„è¿˜æ˜¯å¯ä»¥å•¦ã€‚æ—¢ç„¶ä¸»æœºå•†çš„å„ç§å®‰å…¨å¥—é¤å’±ä»¬ç”¨ä¸èµ·ï¼Œé‚£å°±ç”¨ä¸€äº›å¤§ä½¬å†™å¥½çš„æ–¹æ¡ˆå§ã€‚</p><p>æ‰¾äº†ä¸€ä¸‹ï¼Œå‘ç° ngx_lua_waf æ˜¯ä¸ªä¸é”™çš„æ–¹æ¡ˆï¼Œä½†æ˜¯å¤ªä¹…ä¸æ›´æ–°äº†ï¼Œè€Œä¸”ä»£ç æˆ‘çœ‹ä¸æ‡‚ï¼ŒçŒ</p><p>æœ€åæ‰¾åˆ° oneinstack ä¸€é”®åŒ…å†…ç½®çš„ ngx_lua_wafï¼ŒåŸºäºä¹‹å‰çš„ä»£ç ï¼Œä¸è¿‡é‡æ„ äº†ï¼Œè¿™ä¸‹æˆ‘èƒ½çœ‹æ‡‚äº†ï¼Œä»¥åè¦ä¿®æ”¹ä¹Ÿèƒ½ç®€å•ä¸€äº›</p><h2 id="ä»‹ç»"><a href="#ä»‹ç»" class="headerlink" title="ä»‹ç»"></a>ä»‹ç»</h2><p><a href="https://github.com/xzhih/ngx_lua_waf" target="_blank" rel="noopener">ngx_lua_waf</a> æ˜¯ä¸€ä¸ªé«˜æ€§èƒ½çš„è½»é‡çº§ web åº”ç”¨é˜²ç«å¢™ï¼ŒåŸºäº lua-nginx-moduleã€‚</p><p><img src="https://pic.zhih.me/blog/posts/ngx-lua-waf/waf.jpg" alt="ngx_lua_waf"></p><p>å®ƒå…·æœ‰ä»¥ä¸‹åŠŸèƒ½ï¼š</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">é˜²æ­¢sqlæ³¨å…¥ï¼Œæœ¬åœ°åŒ…å«ï¼Œéƒ¨åˆ†æº¢å‡ºï¼Œfuzzingæµ‹è¯•ï¼Œxss,SSRFç­‰webæ”»å‡»</span><br><span class="line">é˜²æ­¢svn/å¤‡ä»½ä¹‹ç±»æ–‡ä»¶æ³„æ¼</span><br><span class="line">é˜²æ­¢ApacheBenchä¹‹ç±»å‹åŠ›æµ‹è¯•å·¥å…·çš„æ”»å‡»</span><br><span class="line">å±è”½å¸¸è§çš„æ‰«æé»‘å®¢å·¥å…·ï¼Œæ‰«æå™¨</span><br><span class="line">å±è”½å¼‚å¸¸çš„ç½‘ç»œè¯·æ±‚</span><br><span class="line">å±è”½å›¾ç‰‡é™„ä»¶ç±»ç›®å½•phpæ‰§è¡Œæƒé™</span><br><span class="line">é˜²æ­¢webshellä¸Šä¼ </span><br></pre></td></tr></table></figure><p>ç»è¿‡ <a href="https://github.com/unixhot/waf" target="_blank" rel="noopener">unixhot</a> çš„ä¿®æ”¹å’Œé‡æ„ï¼Œæ‹¥æœ‰äº†ä»¥ä¸‹åŠŸèƒ½ï¼š</p><figure class="highlight livecodeserver"><table><tr><td class="code"><pre><span class="line">æ”¯æŒIPç™½åå•å’Œé»‘åå•åŠŸèƒ½ï¼Œç›´æ¥å°†é»‘åå•çš„IPè®¿é—®æ‹’ç»</span><br><span class="line">æ”¯æŒ<span class="built_in">URL</span>ç™½åå•ï¼Œå°†ä¸éœ€è¦è¿‡æ»¤çš„<span class="built_in">URL</span>è¿›è¡Œå®šä¹‰</span><br><span class="line">æ”¯æŒUser-Agentçš„è¿‡æ»¤ï¼ŒåŒ¹é…è‡ªå®šä¹‰è§„åˆ™ä¸­çš„æ¡ç›®ï¼Œç„¶åè¿›è¡Œå¤„ç†ï¼ˆè¿”å›<span class="number">403</span>ï¼‰</span><br><span class="line">æ”¯æŒCCæ”»å‡»é˜²æŠ¤ï¼Œå•ä¸ª<span class="built_in">URL</span>æŒ‡å®šæ—¶é—´çš„è®¿é—®æ¬¡æ•°ï¼Œè¶…è¿‡è®¾å®šå€¼ï¼Œç›´æ¥è¿”å›<span class="number">403</span></span><br><span class="line">æ”¯æŒCookieè¿‡æ»¤ï¼ŒåŒ¹é…è‡ªå®šä¹‰è§„åˆ™ä¸­çš„æ¡ç›®ï¼Œç„¶åè¿›è¡Œå¤„ç†ï¼ˆè¿”å›<span class="number">403</span>ï¼‰</span><br><span class="line">æ”¯æŒ<span class="built_in">URL</span>è¿‡æ»¤ï¼ŒåŒ¹é…è‡ªå®šä¹‰è§„åˆ™ä¸­çš„æ¡ç›®ï¼Œå¦‚æœç”¨æˆ·è¯·æ±‚çš„<span class="built_in">URL</span>åŒ…å«è¿™äº›ï¼Œè¿”å›<span class="number">403</span></span><br><span class="line">æ”¯æŒ<span class="built_in">URL</span>å‚æ•°è¿‡æ»¤ï¼ŒåŸç†åŒä¸Š</span><br><span class="line">æ”¯æŒæ—¥å¿—è®°å½•ï¼Œå°†æ‰€æœ‰æ‹’ç»çš„æ“ä½œï¼Œè®°å½•åˆ°æ—¥å¿—ä¸­å»</span><br><span class="line">æ—¥å¿—è®°å½•ä¸ºJSONæ ¼å¼ï¼Œä¾¿äºæ—¥å¿—åˆ†æï¼Œä¾‹å¦‚ä½¿ç”¨ELKStackè¿›è¡Œæ”»å‡»æ—¥å¿—æ”¶é›†ã€å­˜å‚¨ã€æœç´¢å’Œå±•ç¤º</span><br></pre></td></tr></table></figure><p>è¿™äº›åŠŸèƒ½åˆšå¥½èƒ½æ»¡è¶³æˆ‘æœ‹å‹çš„éœ€æ±‚</p><h2 id="å®‰è£…"><a href="#å®‰è£…" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h2><p>å®‰è£…èµ·æ¥ä¹Ÿæ˜¯ç›¸å½“å®¹æ˜“ï¼Œè¯´ç™½äº†å°±æ˜¯ç»™ nginx å¢åŠ  ngx_devel_kitã€lua-nginx-module è¿™ä¸¤ä¸ªæ¨¡å—ï¼Œç„¶åå†ä¿®æ”¹ nginx é…ç½®æ¥è¿è¡Œ ngx_lua_wafã€‚</p><h3 id="ä¸€é”®å®‰è£…"><a href="#ä¸€é”®å®‰è£…" class="headerlink" title="ä¸€é”®å®‰è£…"></a>ä¸€é”®å®‰è£…</h3><p>ä¸€é”®å‘½ä»¤æˆ‘å·²ç»ç»™ä½ ä»¬å‡†å¤‡å¥½äº†ï¼Œä¸€é”®å‘½ä»¤ä¼šç¼–è¯‘ nginx-1.15.6ï¼Œç¼–è¯‘çš„è¯¦ç»†æ¨¡å—å¯ä»¥çœ‹æˆ‘çš„è¿™ç¯‡å¸–å­ <a href="https://zhih.me/make-your-website-support-tls1-3">https://zhih.me/make-your-website-support-tls1-3</a> ï¼Œå½“ç„¶ä½ ä¹Ÿå¯ä»¥ç›´æ¥çœ‹è„šæœ¬çš„ä»£ç </p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sh -c <span class="string">"<span class="variable">$(curl -kfsSl https://raw.githubusercontent.com/xzhih/nginx-compile/master/install.sh)</span>"</span></span><br></pre></td></tr></table></figure><h3 id="æ‰‹åŠ¨å®‰è£…"><a href="#æ‰‹åŠ¨å®‰è£…" class="headerlink" title="æ‰‹åŠ¨å®‰è£…"></a>æ‰‹åŠ¨å®‰è£…</h3><h4 id="ä¸‹è½½-ngx-lua-waf-é˜²ç«å¢™çš„å„ç§ä¾èµ–åŠæ¨¡å—"><a href="#ä¸‹è½½-ngx-lua-waf-é˜²ç«å¢™çš„å„ç§ä¾èµ–åŠæ¨¡å—" class="headerlink" title="ä¸‹è½½ ngx_lua_waf é˜²ç«å¢™çš„å„ç§ä¾èµ–åŠæ¨¡å—"></a>ä¸‹è½½ ngx_lua_waf é˜²ç«å¢™çš„å„ç§ä¾èµ–åŠæ¨¡å—</h4><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">cd</span> /usr/src/</span><br><span class="line">wget https://github.com/openresty/luajit2/archive/v2.1-20181029.tar.gz</span><br><span class="line">tar xzvf v2.1-20181029.tar.gz</span><br><span class="line">mv luajit2-2.1-20181029 luajit-2.1</span><br><span class="line"></span><br><span class="line">wget https://github.com/openresty/lua-cjson/archive/2.1.0.6.tar.gz</span><br><span class="line">tar xzvf 2.1.0.6.tar.gz</span><br><span class="line">mv lua-cjson-2.1.0.6 lua-cjson</span><br><span class="line"></span><br><span class="line">wget https://github.com/simplresty/ngx_devel_kit/archive/v0.3.1rc1.tar.gz</span><br><span class="line">tar xzvf v0.3.1rc1.tar.gz</span><br><span class="line">mv ngx_devel_kit-0.3.1rc1 ngx_devel_kit</span><br><span class="line"></span><br><span class="line">wget https://github.com/openresty/lua-nginx-module/archive/v0.10.13.tar.gz</span><br><span class="line">tar xzvf v0.10.13.tar.gz  </span><br><span class="line">mv lua-nginx-module-0.10.13 lua-nginx-module</span><br></pre></td></tr></table></figure><h4 id="ç¼–è¯‘å®‰è£…-luajit"><a href="#ç¼–è¯‘å®‰è£…-luajit" class="headerlink" title="ç¼–è¯‘å®‰è£… luajit"></a>ç¼–è¯‘å®‰è£… luajit</h4><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">cd</span> luajit-2.1</span><br><span class="line">make -j2 &amp;&amp; make install</span><br><span class="line"><span class="built_in">echo</span> <span class="string">'/usr/local/lib'</span> &gt;&gt; /etc/ld.so.conf.d/local.conf</span><br><span class="line">ldconfig</span><br></pre></td></tr></table></figure><h4 id="ç¼–è¯‘å®‰è£…-lua-cjson"><a href="#ç¼–è¯‘å®‰è£…-lua-cjson" class="headerlink" title="ç¼–è¯‘å®‰è£… lua-cjson"></a>ç¼–è¯‘å®‰è£… lua-cjson</h4><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">cd</span> /usr/src/lua-cjson</span><br><span class="line"><span class="built_in">export</span> LUA_INCLUDE_DIR=/usr/<span class="built_in">local</span>/include/luajit-2.1 </span><br><span class="line">make -j2 &amp;&amp; make install</span><br></pre></td></tr></table></figure><h4 id="è®¾ç½®-LUAJIT-ç¯å¢ƒå˜é‡"><a href="#è®¾ç½®-LUAJIT-ç¯å¢ƒå˜é‡" class="headerlink" title="è®¾ç½® LUAJIT ç¯å¢ƒå˜é‡"></a>è®¾ç½® LUAJIT ç¯å¢ƒå˜é‡</h4><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">export</span> LUAJIT_LIB=/usr/<span class="built_in">local</span>/lib</span><br><span class="line"><span class="built_in">export</span> LUAJIT_INC=/usr/<span class="built_in">local</span>/include/luajit-2.1</span><br></pre></td></tr></table></figure><h4 id="ç¼–è¯‘-nginx-çš„æ—¶å€™åŠ ä¸Šä»¥ä¸‹ä¸¤ä¸ªæ¨¡å—"><a href="#ç¼–è¯‘-nginx-çš„æ—¶å€™åŠ ä¸Šä»¥ä¸‹ä¸¤ä¸ªæ¨¡å—" class="headerlink" title="ç¼–è¯‘ nginx çš„æ—¶å€™åŠ ä¸Šä»¥ä¸‹ä¸¤ä¸ªæ¨¡å—"></a>ç¼–è¯‘ nginx çš„æ—¶å€™åŠ ä¸Šä»¥ä¸‹ä¸¤ä¸ªæ¨¡å—</h4><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">--add-module=../lua-nginx-module</span><br><span class="line">--add-module=../ngx_devel_kit</span><br></pre></td></tr></table></figure><h4 id="ä¸‹è½½é…ç½®-ngx-lua-waf"><a href="#ä¸‹è½½é…ç½®-ngx-lua-waf" class="headerlink" title="ä¸‹è½½é…ç½® ngx_lua_waf"></a>ä¸‹è½½é…ç½® ngx_lua_waf</h4><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">cd</span> /usr/<span class="built_in">local</span>/nginx/conf/</span><br><span class="line">git <span class="built_in">clone</span> https://github.com/xzhih/ngx_lua_waf.git waf </span><br><span class="line"></span><br><span class="line">cat &gt; /usr/<span class="built_in">local</span>/nginx/conf/waf.conf &lt;&lt; EOF</span><br><span class="line">lua_shared_dict <span class="built_in">limit</span> 20m;</span><br><span class="line">lua_package_path <span class="string">"/usr/local/nginx/conf/waf/?.lua"</span>;</span><br><span class="line">init_by_lua_file <span class="string">"/usr/local/nginx/conf/waf/init.lua"</span>;</span><br><span class="line">access_by_lua_file <span class="string">"/usr/local/nginx/conf/waf/access.lua"</span>;</span><br><span class="line">EOF</span><br><span class="line"></span><br><span class="line">mkdir -p /usr/<span class="built_in">local</span>/nginx/logs/waf </span><br><span class="line">chown www-data:www-data /usr/<span class="built_in">local</span>/nginx/logs/waf</span><br></pre></td></tr></table></figure><p>ä½ å¯ä»¥åœ¨ <code>/usr/local/nginx/logs/waf</code> æ‰¾åˆ°é˜²ç«å¢™æ—¥å¿—</p><h4 id="åœ¨-nginx-conf-é‡Œ-include-waf-conf"><a href="#åœ¨-nginx-conf-é‡Œ-include-waf-conf" class="headerlink" title="åœ¨ nginx.conf é‡Œ include waf.conf"></a>åœ¨ <code>nginx.conf</code> é‡Œ include <code>waf.conf</code></h4><figure class="highlight actionscript"><table><tr><td class="code"><pre><span class="line"><span class="meta"><span class="meta-keyword">include</span> waf.conf;</span></span><br></pre></td></tr></table></figure><p>å¯åŠ¨ nginx å¹¶è®¿é—® http://ä½ çš„IP/?a=a.sql</p><p>å°±å¯ä»¥çœ‹åˆ°é˜²ç«å¢™æç¤ºäº†</p><h2 id="Copyright"><a href="#Copyright" class="headerlink" title="Copyright"></a>Copyright</h2><p><a href="https://github.com/lj2007331/ngx_lua_waf" target="_blank" rel="noopener">https://github.com/lj2007331/ngx_lua_waf</a></p><p><a href="https://github.com/loveshell/ngx_lua_waf" target="_blank" rel="noopener">https://github.com/loveshell/ngx_lua_waf</a></p><p><a href="https://github.com/unixhot/waf" target="_blank" rel="noopener">https://github.com/unixhot/waf</a></p><blockquote><p>æœ¬æ–‡ç« å‘è¡¨äºåº•å™ªåšå®¢ <a href="https://zhih.me">https://zhih.me</a> , è½¬è½½è¯·æ³¨æ˜</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> æ•™ç¨‹ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> nginx </tag>
            
            <tag> webä¼˜åŒ– </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>ä½¿ç”¨acme.shè·å–å…è´¹SSLè¯ä¹¦</title>
      <link href="/acme-sh-guide/"/>
      <url>/acme-sh-guide/</url>
      
        <content type="html"><![CDATA[<h2 id="å¼•è¨€"><a href="#å¼•è¨€" class="headerlink" title="å¼•è¨€"></a>å¼•è¨€</h2><p><a href="https://github.com/Neilpang/acme.sh" target="_blank" rel="noopener">acme.sh</a> æ˜¯ä¸€ä¸ª ACME(è‡ªåŠ¨åŒ–è¯ä¹¦ç®¡ç†ç¯å¢ƒ) è„šæœ¬ï¼Œå¯ä»¥ä» letsencrypt ç”Ÿæˆå…è´¹çš„è¯ä¹¦ã€‚</p><p>æœ¬æ¥è¿™ä¸ªæ•™ç¨‹æ˜¯å†™åœ¨ <a href="https://zhih.me/make-your-website-support-tls1-3/">ç¼–è¯‘Nginxæ”¯æŒTLS1.3</a> é‚£ç¯‡å¸–å­é‡Œçš„ï¼Œåæ¥æ„Ÿè§‰è¿˜æ˜¯å•ç‹¬æ‹¿å‡ºæ¥æ¯”è¾ƒå¥½ï¼Œå³èƒ½è®©é‚£ç¯‡æ•™ç¨‹æ›´ç®€æ´ï¼Œä¹Ÿèƒ½æ›´æ–¹ä¾¿çš„è®©éœ€è¦çš„äººçœ‹åˆ°è¿™ä¸ªæ•™ç¨‹ã€‚</p><h2 id="å®‰è£…å·¥å…·"><a href="#å®‰è£…å·¥å…·" class="headerlink" title="å®‰è£…å·¥å…·"></a>å®‰è£…å·¥å…·</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">apt-get install cron socat -y</span><br></pre></td></tr></table></figure><h2 id="è·å–-acme-sh"><a href="#è·å–-acme-sh" class="headerlink" title="è·å– acme.sh"></a>è·å– acme.sh</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">curl  https://get.acme.sh | sh</span><br></pre></td></tr></table></figure><p>é‡å¯ç»ˆç«¯ï¼Œå¦‚æœä½ ä½¿ç”¨ zsh å¯ä»¥è¿™æ · <code>source ~/.zshrc</code></p><h2 id="ç”Ÿæˆè¯ä¹¦"><a href="#ç”Ÿæˆè¯ä¹¦" class="headerlink" title="ç”Ÿæˆè¯ä¹¦"></a>ç”Ÿæˆè¯ä¹¦</h2><p>ä½¿ç”¨ http æ–¹å¼éªŒè¯åŸŸåï¼Œéœ€è¦å…ˆæ­å»º HTTP ç«™ç‚¹ï¼Œæ¥ä¸‹æ¥æŒ‡å®šåŸŸåã€æŒ‡å®šç«™ç‚¹ç›®å½•ï¼Œå¼€å§‹ç­¾å‘</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">acme.sh --issue -d onmp.ooo \</span><br><span class="line">          --webroot /wwwroot/onmp.ooo/ \</span><br><span class="line">          --keylength ec-256 \</span><br><span class="line">          --nginx</span><br></pre></td></tr></table></figure><p>å¦‚æœæ˜¯å¤šåŸŸåï¼Œå¯ä»¥ä½¿ç”¨ -d å‚æ•°æ·»åŠ ï¼Œå¦‚ï¼š<code>-d www.onmp.ooo</code><br><code>--keylength ec-256</code> æ˜¯ç­¾å‘ ECC ç±»å‹çš„è¯ä¹¦ï¼Œå®ƒçš„å®‰å…¨æ€§æ›´é«˜ï¼Œåˆ é™¤åˆ™ä½¿ç”¨é»˜è®¤çš„ RSA è¯ä¹¦</p><h2 id="å¤åˆ¶è¯ä¹¦"><a href="#å¤åˆ¶è¯ä¹¦" class="headerlink" title="å¤åˆ¶è¯ä¹¦"></a>å¤åˆ¶è¯ä¹¦</h2><p>è¯ä¹¦å·²ç»ç­¾å‘äº†ï¼Œä¸è¿‡é»˜è®¤æ˜¯ä¿å­˜åœ¨ <code>~/.acme.sh/</code> é‡Œ</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">acme.sh --ecc --installcert -d onmp.ooo \</span><br><span class="line">          --key-file /usr/<span class="built_in">local</span>/nginx/conf/ssl/onmp.ooo.key \</span><br><span class="line">          --fullchain-file /usr/<span class="built_in">local</span>/nginx/conf/ssl/onmp.ooo.cer \</span><br><span class="line">          --reloadcmd <span class="string">"service nginx force-reload"</span></span><br></pre></td></tr></table></figure><p>æŒ‡å®šåŸŸåï¼ŒæŒ‡å®šè¯ä¹¦ä¿å­˜ç›®å½•ï¼Œæˆ‘è¿™é‡Œè®¾ç½®åœ¨ <code>/usr/local/nginx/conf/ssl/</code>ï¼ŒæŒ‡å®š Nginx é‡è½½å‘½ä»¤ï¼Œå¦‚æœç­¾å‘çš„ä¸æ˜¯ ECC è¯ä¹¦ï¼ŒæŠŠ <code>--ecc</code> å‚æ•°å»æ‰</p><p>è¿™æ ·ä½¿ç”¨ acme.sh å°±å®Œæˆäº†è¯ä¹¦çš„ç­¾å‘ï¼Œå¦‚æœè¯ä¹¦å¿«è¦è¿‡æœŸäº†ï¼Œè„šæœ¬ä¼šè‡ªåŠ¨æ›´æ–°è¯ä¹¦</p><p>è„šæœ¬è‡ªåŠ¨æ›´æ–°ï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">acme.sh --upgrade --auto-upgrade</span><br></pre></td></tr></table></figure><h2 id="è¯ä¹¦å®‰è£…"><a href="#è¯ä¹¦å®‰è£…" class="headerlink" title="è¯ä¹¦å®‰è£…"></a>è¯ä¹¦å®‰è£…</h2><p>è¯ä¹¦å·²ç»è·å–å¹¶ä¸”å¯ä»¥è‡ªåŠ¨æ›´æ–°äº†ï¼Œå…·ä½“å®‰è£…æ–¹æ³•çœ‹ <a href="https://zhih.me/make-your-website-support-tls1-3/">ç¼–è¯‘Nginxæ”¯æŒTLS1.3</a></p><blockquote><p>æœ¬æ–‡ç« å‘è¡¨äºåº•å™ªåšå®¢ <a href="https://zhih.me">https://zhih.me</a> , è½¬è½½è¯·æ³¨æ˜</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> æ•™ç¨‹ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> nginx </tag>
            
            <tag> https </tag>
            
            <tag> web </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>ç¼–è¯‘Nginxæ”¯æŒTLS1.3</title>
      <link href="/make-your-website-support-tls1-3/"/>
      <url>/make-your-website-support-tls1-3/</url>
      
        <content type="html"><![CDATA[<h2 id="å¼•è¨€"><a href="#å¼•è¨€" class="headerlink" title="å¼•è¨€"></a>å¼•è¨€</h2><p>TLS1.2 å‘å¸ƒäº 2008 å¹´ 8 æœˆï¼Œè‡³ä»Šæ­£å¥½æœ‰ 10 å¹´ï¼Œéšç€äº’è”ç½‘å®‰å…¨è¶Šæ¥è¶Šå—åˆ°é‡è§†ï¼Œæ–°åè®® TLS1.3 å‘¼ä¹‹æ¬²å‡ºã€‚å€¼å¾—ä¸€æçš„æ˜¯ï¼Œä»ç¬¬ä¸€ä»½è‰æ¡ˆç¼–å†™è‡³ä»Šï¼Œå·²ç»æœ‰å‡ å¹´æ—¶é—´äº†ï¼Œæˆªæ­¢è¿™ç¯‡æ–‡ç« ç¼–å†™ï¼Œå·²ç»æ˜¯ç¬¬ 28 ä»½è‰æ¡ˆã€‚åœ¨æœ€è¿‘çš„ Chrome ç‰ˆæœ¬æ›´æ–°ä¸­ä¹Ÿé€æ­¥å¯¹ TLS1.3 è¿›è¡Œæ”¯æŒï¼ŒChrome 65 å¼€å§‹é»˜è®¤å¼€å¯ draft 23ã€Chrome 68 å¼€å§‹æ”¯æŒ draft 28</p><blockquote><p>æ›´æ–°ï¼šTLS 1.3 æ ‡å‡†å·²äº 2018 å¹´ 8 æœˆæ­£å¼å‘å¸ƒä¸º <a href="https://tools.ietf.org/html/rfc8446" target="_blank" rel="noopener">RFC 8446 </a>ï¼Œè· TLS1.2 å‘å¸ƒæ­£å¥½ 10 å‘¨å¹´</p></blockquote><p>TLS1.3 å¯¹äº TLS1.2 æœ‰é‡å¤§æ”¹å†™ï¼Œæ—¢æé«˜äº†å®‰å…¨æ€§åˆæé«˜äº†é€Ÿåº¦ï¼Œä»¥è‡³äºæœ‰äº‰è®®ç§°ï¼Œåº”è¯¥æŠŠå®ƒå«åš TLS2.0</p><p>å…³äº TLS1.3 çš„ç§‘æ™®å¯ä»¥çœ‹ä¸‹é¢çš„é¡µé¢</p><p><a href="https://wiki.openssl.org/index.php/TLS1.3" target="_blank" rel="noopener">https://wiki.openssl.org/index.php/TLS1.3</a><br><a href="https://zhuanlan.zhihu.com/p/28850798" target="_blank" rel="noopener">https://zhuanlan.zhihu.com/p/28850798</a></p><p>ä¹‹å‰æˆ‘ä¹Ÿå†™è¿‡ Nginx çš„ https çš„é…ç½® <a href="https://zhih.me/nginx-http2-https/">https://zhih.me/nginx-http2-https/</a> ï¼Œå½“æ—¶æ˜¯ä½¿ç”¨ TLS1.2 çš„</p><p>ç¢°å·§å‰å‡ å¤©å‘ç° <code>.ooo</code> å¯ä»¥å…è´¹ç”¨ 1 å¹´ï¼Œå°±æ’¸äº†ä¸€ä¸ª <code>onmp.ooo</code> æ¥åšä¸ºæˆ‘ onmp é¡¹ç›®çš„é¡µé¢ï¼ŒæŠŠå®ƒæ­åœ¨ 4 åˆ€å¹´ä»˜çš„ virmach ä¸Šï¼Œé¡ºä¾¿æµ‹è¯• TLS1.3</p><h2 id="ä¸€é”®å®‰è£…"><a href="#ä¸€é”®å®‰è£…" class="headerlink" title="ä¸€é”®å®‰è£…"></a>ä¸€é”®å®‰è£…</h2><p>æœ€è¿‘æ›´æ–°æ”¯æŒé˜²ç«å¢™åŠŸèƒ½ï¼Œè¯¦æƒ…å¯ä»¥çœ‹ <a href="https://zhih.me/ngx-lua-waf/">https://zhih.me/ngx-lua-waf/</a></p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sh -c <span class="string">"<span class="variable">$(curl -kfsSl https://raw.githubusercontent.com/xzhih/nginx-compile/master/install.sh)</span>"</span></span><br></pre></td></tr></table></figure><h2 id="å®‰è£…"><a href="#å®‰è£…" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h2><p>æˆ‘è¿™é‡Œç”¨çš„ç³»ç»Ÿæ˜¯ Debian 8</p><h3 id="å®‰è£…ä¾èµ–"><a href="#å®‰è£…ä¾èµ–" class="headerlink" title="å®‰è£…ä¾èµ–"></a>å®‰è£…ä¾èµ–</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">apt-get install git gcc make build-essential -y</span><br></pre></td></tr></table></figure><h3 id="ä¸‹è½½æºç "><a href="#ä¸‹è½½æºç " class="headerlink" title="ä¸‹è½½æºç "></a>ä¸‹è½½æºç </h3><p>æˆ‘ä»¬æŠŠæºç å…¨éƒ½æ”¾åœ¨ä¸€ä¸ªåœ°æ–¹ï¼Œæ–¹ä¾¿ä½¿ç”¨ï¼Œåˆ›å»º nginx çš„è¿è¡Œç”¨æˆ· www-data</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">rm -rf /usr/src/</span><br><span class="line">mkdir -p /usr/src/</span><br><span class="line">mkdir -p /var/<span class="built_in">log</span>/nginx/</span><br><span class="line">useradd -s /sbin/nologin -M www-data</span><br></pre></td></tr></table></figure><p><strong>å…‹éš† OpenSSL</strong></p><p>è¿™é‡Œç”¨çš„æ˜¯ 1.1.1 ç¨³å®šç‰ˆçš„æºç </p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">cd</span> /usr/src</span><br><span class="line">wget https://github.com/openssl/openssl/archive/OpenSSL_1_1_1.tar.gz </span><br><span class="line">tar xzvf OpenSSL_1_1_1.tar.gz</span><br><span class="line">mv openssl-OpenSSL_1_1_1 openssl</span><br></pre></td></tr></table></figure><p><strong>ä¸‹è½½ Nginx çš„æºç </strong></p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">cd</span> /usr/src/</span><br><span class="line">wget https://nginx.org/download/nginx-1.15.6.tar.gz</span><br><span class="line">tar zxf ./nginx-1.15.6.tar.gz </span><br><span class="line">mv nginx-1.15.6 nginx</span><br></pre></td></tr></table></figure><p><strong>å…‹éš† zlib</strong></p><p>å¼€å¯ gzip è¦ç”¨åˆ° zlib åº“ï¼Œè¿™é‡Œä½¿ç”¨çš„æ˜¯ Cloudflare ä¼˜åŒ–çš„ç‰ˆæœ¬ï¼Œæ¯”åŸç‰ˆå…·æœ‰æ›´é«˜çš„å‹ç¼©æ€§èƒ½</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">cd</span> /usr/src/</span><br><span class="line">git <span class="built_in">clone</span> https://github.com/cloudflare/zlib.git zlib</span><br><span class="line"><span class="built_in">cd</span> zlib</span><br><span class="line">make -f Makefile.in distclean</span><br></pre></td></tr></table></figure><p><strong>å…‹éš† Brotli</strong></p><p>å°±åƒ gzip ä¸€æ ·ï¼ŒBrotli ä¹Ÿæ˜¯ä¸€ç§å‹ç¼©ç®—æ³•ï¼Œå®ƒæ˜¯ç”±è°·æ­Œå¼€å‘çš„ä¸€ä¸ªæ›´é€‚åˆæ–‡æœ¬å‹ç¼©çš„ç®—æ³•ï¼Œå› ä¸ºå®ƒä½¿ç”¨äº†å­—å…¸ï¼Œæ‰€ä»¥æœ‰æ›´å¥½çš„å‹ç¼©æ¯”ã€‚</p><p>ç°åœ¨ä¸»æµæµè§ˆå™¨éƒ½å·²ç»æ”¯æŒ Brotli äº†ï¼Œè€Œä¸”ä¹Ÿèƒ½ä¸ gzip å…±å­˜ï¼Œå¦‚æœæµè§ˆå™¨æ”¯æŒ Brotli å°±ä¼šä¼˜å…ˆä½¿ç”¨ï¼Œæ‰€ä»¥å¯ä»¥æ”¾å¿ƒå…¼å®¹æ€§ï¼Œå¯ä»¥åœ¨è¿™é‡Œçœ‹åˆ°æ”¯æŒçš„æ•°æ® <a href="https://caniuse.com/#search=Brotli" target="_blank" rel="noopener">https://caniuse.com/#search=Brotli</a></p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">cd</span> /usr/src/</span><br><span class="line">git <span class="built_in">clone</span> --recursive https://github.com/google/ngx_brotli.git</span><br></pre></td></tr></table></figure><p>æˆ‘ç»™ nginx é»˜è®¤é…ç½®çš„ Brotli å‹ç¼©ç­‰çº§ä¸º 6 çº§ï¼Œè¿™å¯¹äºåŠ¨æ€å†…å®¹æ¯”è¾ƒå‹å¥½ï¼Œå¦‚æœä½ æ˜¯åƒæˆ‘ç°åœ¨è¿™ä¸ªåšå®¢ä¸€æ ·æ˜¯é™æ€åŒ–çš„ï¼Œé‚£ä¹ˆå»ºè®®å¼€å¯ 11 çº§å‹ç¼©ï¼Œè¿™æ ·å¯ä»¥è·å¾—æœ€å¥½çš„ä½“éªŒ</p><p><strong>ä¸‹è½½ PCRE</strong></p><p>nginx rewrite æ¨¡å—éœ€è¦ pcre åº“</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">cd</span> /usr/src/</span><br><span class="line">wget https://ftp.pcre.org/pub/pcre/pcre-8.42.tar.gz</span><br><span class="line">tar zxf ./pcre-8.42.tar.gz</span><br></pre></td></tr></table></figure><h3 id="ç»™-OpenSSL-æ‰“è¡¥ä¸"><a href="#ç»™-OpenSSL-æ‰“è¡¥ä¸" class="headerlink" title="ç»™ OpenSSL æ‰“è¡¥ä¸"></a>ç»™ OpenSSL æ‰“è¡¥ä¸</h3><p>è¡¥ä¸æ¥è‡ªï¼š<a href="https://github.com/hakasenyang/openssl-patch" target="_blank" rel="noopener">https://github.com/hakasenyang/openssl-patch</a></p><p>æ­¤è¡¥ä¸çš„ç›®çš„æ˜¯è®© OpenSSL æ”¯æŒ TLS1.3 çš„ 23,26,28 è‰æ¡ˆï¼Œä»¥åŠ Final ç‰ˆæ ‡å‡†</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">cd</span> /usr/src/</span><br><span class="line">git <span class="built_in">clone</span> https://github.com/hakasenyang/openssl-patch.git</span><br><span class="line"><span class="built_in">cd</span> /usr/src/openssl </span><br><span class="line">patch -p1 &lt; ../openssl-patch/openssl-equal-1.1.1_ciphers.patch</span><br><span class="line">patch -p1 &lt; ../openssl-patch/openssl-1.1.1-chacha_draft.patch</span><br></pre></td></tr></table></figure><h3 id="ç»™-Nginx-æ‰“è¡¥ä¸"><a href="#ç»™-Nginx-æ‰“è¡¥ä¸" class="headerlink" title="ç»™ Nginx æ‰“è¡¥ä¸"></a>ç»™ Nginx æ‰“è¡¥ä¸</h3><p>è¡¥ä¸æ¥è‡ªï¼š<a href="https://github.com/kn007/patch" target="_blank" rel="noopener">https://github.com/kn007/patch</a></p><p>nginx è¡¥ä¸</p><ul><li>æ·»åŠ SPDYæ”¯æŒã€‚</li><li>æ·»åŠ HTTP2 HPACKç¼–ç æ”¯æŒã€‚</li><li>æ·»åŠ åŠ¨æ€TLSè®°å½•æ”¯æŒã€‚</li></ul><p>nginx_auto_using_PRIORITIZE_CHACHA è¡¥ä¸</p><ul><li>æ”¯æŒæ—¶ä½¿ç”¨ SSL_OP_PRIORITIZE_CHACHA</li></ul><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">cd</span> /usr/src/</span><br><span class="line">git <span class="built_in">clone</span> https://github.com/kn007/patch.git nginx-patch</span><br><span class="line"><span class="built_in">cd</span> /usr/src/nginx</span><br><span class="line">patch -p1 &lt; ../nginx-patch/nginx.patch </span><br><span class="line">patch -p1 &lt; ../nginx-patch/nginx_auto_using_PRIORITIZE_CHACHA.patch</span><br></pre></td></tr></table></figure><h3 id="ä½¿ç”¨-jemalloc-ä½œä¸ºå†…å­˜ç®¡ç†"><a href="#ä½¿ç”¨-jemalloc-ä½œä¸ºå†…å­˜ç®¡ç†" class="headerlink" title="ä½¿ç”¨ jemalloc ä½œä¸ºå†…å­˜ç®¡ç†"></a>ä½¿ç”¨ jemalloc ä½œä¸ºå†…å­˜ç®¡ç†</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">cd</span> /usr/src/</span><br><span class="line">wget https://github.com/jemalloc/jemalloc/releases/download/5.1.0/jemalloc-5.1.0.tar.bz2</span><br><span class="line">tar xjvf jemalloc-5.1.0.tar.bz2</span><br><span class="line"><span class="built_in">cd</span> jemalloc-5.1.0</span><br><span class="line">./configure</span><br><span class="line">make &amp;&amp; make install</span><br><span class="line"><span class="built_in">echo</span> <span class="string">'/usr/local/lib'</span> &gt;&gt; /etc/ld.so.conf.d/local.conf</span><br><span class="line">ldconfig</span><br></pre></td></tr></table></figure><h3 id="å…¶ä»–ç¼–è¯‘é…ç½®"><a href="#å…¶ä»–ç¼–è¯‘é…ç½®" class="headerlink" title="å…¶ä»–ç¼–è¯‘é…ç½®"></a>å…¶ä»–ç¼–è¯‘é…ç½®</h3><p>Nginx é»˜è®¤ä¼šä»¥ debug æ¨¡å¼ç¼–è¯‘ï¼Œæˆ‘ä»¬éœ€è¦æ³¨é‡Šæ‰ <code>/usr/src/nginx/auto/cc/gcc</code> ä¸­ <code>CFLAGS=&quot;$CFLAGS -g&quot;</code> è¿™è¡Œï¼Œè¿™æ ·å¯ä»¥å‡å°‘ç”Ÿæˆæ–‡ä»¶çš„å¤§å°</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sed -i <span class="string">'s@CFLAGS="$CFLAGS -g"@#CFLAGS="$CFLAGS -g"@'</span> /usr/src/nginx/auto/cc/gcc</span><br></pre></td></tr></table></figure><h3 id="ç¼–è¯‘å®‰è£…"><a href="#ç¼–è¯‘å®‰è£…" class="headerlink" title="ç¼–è¯‘å®‰è£…"></a>ç¼–è¯‘å®‰è£…</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">cd</span> /usr/src/nginx</span><br><span class="line">./configure \</span><br><span class="line">--user=www-data --group=www-data \</span><br><span class="line">--prefix=/usr/<span class="built_in">local</span>/nginx \</span><br><span class="line">--sbin-path=/usr/sbin/nginx \</span><br><span class="line">--with-compat --with-file-aio --with-threads \</span><br><span class="line">--with-http_v2_module --with-http_v2_hpack_enc \</span><br><span class="line">--with-http_spdy_module --with-http_realip_module \</span><br><span class="line">--with-http_flv_module --with-http_mp4_module \</span><br><span class="line">--with-openssl=../openssl --with-http_ssl_module \</span><br><span class="line">--with-pcre=../pcre-8.42 --with-pcre-jit \</span><br><span class="line">--with-zlib=../zlib --with-http_gzip_static_module \</span><br><span class="line">--add-module=../ngx_brotli \</span><br><span class="line">--with-ld-opt=-ljemalloc</span><br><span class="line"></span><br><span class="line">make </span><br><span class="line">make install</span><br></pre></td></tr></table></figure><p>Nginx çš„å¯æ‰§è¡Œæ–‡ä»¶å®‰è£…åœ¨ <code>/usr/sbin/nginx</code> ï¼ŒNginx é…ç½®åœ¨ <code>/usr/local/nginx/conf/</code> é‡Œ</p><h2 id="é…ç½®"><a href="#é…ç½®" class="headerlink" title="é…ç½®"></a>é…ç½®</h2><p>Nginx å·²ç»å®‰è£…ä¸Šäº†ï¼Œç°åœ¨æˆ‘ä»¬æ¥é…ç½®ç½‘ç«™ï¼Œè®©å®ƒè·‘èµ·æ¥</p><h3 id="Nginx-å…¨å±€é…ç½®"><a href="#Nginx-å…¨å±€é…ç½®" class="headerlink" title="Nginx å…¨å±€é…ç½®"></a>Nginx å…¨å±€é…ç½®</h3><p>æŠŠä»¥ä¸‹å†…å®¹è¦†ç›–å¡«å…¥ <code>/usr/local/nginx/conf/nginx.conf</code></p><figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line"><span class="attribute">user</span> www-data;</span><br><span class="line"><span class="attribute">pid</span> /var/run/nginx.pid;</span><br><span class="line"><span class="attribute">worker_processes</span> auto;</span><br><span class="line"><span class="attribute">worker_rlimit_nofile</span> <span class="number">65535</span>;</span><br><span class="line"></span><br><span class="line"><span class="section">events</span> &#123;</span><br><span class="line">    <span class="attribute">use</span> <span class="literal">epoll</span>;</span><br><span class="line">    <span class="attribute">multi_accept</span> <span class="literal">on</span>;</span><br><span class="line">    <span class="attribute">worker_connections</span> <span class="number">65535</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="section">http</span> &#123;</span><br><span class="line">    <span class="attribute">charset</span> utf-<span class="number">8</span>;</span><br><span class="line">    <span class="attribute">sendfile</span> <span class="literal">on</span>;</span><br><span class="line">    <span class="attribute">aio</span> threads;</span><br><span class="line">    <span class="attribute">directio</span> <span class="number">512k</span>;</span><br><span class="line">    <span class="attribute">tcp_nopush</span> <span class="literal">on</span>;</span><br><span class="line">    <span class="attribute">tcp_nodelay</span> <span class="literal">on</span>;</span><br><span class="line">    <span class="attribute">server_tokens</span> <span class="literal">off</span>;</span><br><span class="line">    <span class="attribute">log_not_found</span> <span class="literal">off</span>;</span><br><span class="line">    <span class="attribute">types_hash_max_size</span> <span class="number">2048</span>;</span><br><span class="line">    <span class="attribute">client_max_body_size</span> <span class="number">16M</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment"># MIME</span></span><br><span class="line">    <span class="attribute">include</span> mime.types;</span><br><span class="line">    <span class="attribute">default_type</span> application/octet-stream;</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Logging</span></span><br><span class="line">    <span class="attribute">access_log</span> /var/log/nginx/access.log;</span><br><span class="line">    <span class="attribute">error_log</span> /var/log/nginx/error.log <span class="literal">warn</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Gzip</span></span><br><span class="line">    <span class="attribute">gzip</span> <span class="literal">on</span>;</span><br><span class="line">    <span class="attribute">gzip_vary</span> <span class="literal">on</span>;</span><br><span class="line">    <span class="attribute">gzip_proxied</span> any;</span><br><span class="line">    <span class="attribute">gzip_comp_level</span> <span class="number">6</span>;</span><br><span class="line">    <span class="attribute">gzip_types</span> text/plain text/css text/xml application/json application/javascript application/xml+rss application/atom+xml image/svg+xml;</span><br><span class="line">    <span class="attribute">gzip_disable</span> <span class="string">"MSIE [1-6]\.(?!.*SV1)"</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Brotli</span></span><br><span class="line">    <span class="attribute">brotli</span> <span class="literal">on</span>;</span><br><span class="line">    <span class="attribute">brotli_comp_level</span> <span class="number">6</span>;</span><br><span class="line">    <span class="attribute">brotli_static</span> <span class="literal">on</span>;</span><br><span class="line">    <span class="attribute">brotli_types</span> text/plain text/css text/xml application/json application/javascript application/xml+rss application/atom+xml image/svg+xml;</span><br><span class="line"></span><br><span class="line">    <span class="attribute">include</span> vhost/<span class="regexp">*.conf</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="Nginx-ç«™ç‚¹é…ç½®"><a href="#Nginx-ç«™ç‚¹é…ç½®" class="headerlink" title="Nginx ç«™ç‚¹é…ç½®"></a>Nginx ç«™ç‚¹é…ç½®</h3><p>æˆ‘ä»¬å·²ç»åœ¨å…¨å±€é…ç½®é‡Œè®¾ç½®äº†åŒ…å« <code>/usr/local/nginx/conf/vhost/</code> ç›®å½•ä¸‹çš„ conf æ–‡ä»¶</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">mkdir -p /usr/<span class="built_in">local</span>/nginx/conf/vhost/</span><br></pre></td></tr></table></figure><p>ç„¶ååœ¨ <code>/usr/local/nginx/conf/vhost/</code> é‡Œåˆ›å»ºç«™ç‚¹é…ç½®ï¼Œæ¯”å¦‚æˆ‘çš„æ˜¯ <code>onmp.ooo.conf</code></p><figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line"><span class="section">server</span> &#123;</span><br><span class="line">  <span class="attribute">listen</span> <span class="number">80</span>;</span><br><span class="line">  <span class="attribute">server_name</span> onmp.ooo;</span><br><span class="line">  <span class="attribute">root</span> /wwwroot/onmp.ooo;</span><br><span class="line">  <span class="attribute">location</span> / &#123;</span><br><span class="line">    <span class="attribute">index</span>  index.html;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™æ · HTTP çš„ç«™ç‚¹é…ç½®å°±å¼„å¥½äº†ï¼Œä¸è¿‡è¿˜ç«™ç‚¹è¿˜æ²¡é¡µé¢ï¼Œæˆ‘ä»¬æŠŠ Nginx çš„æ¬¢è¿ä¹Ÿé¢ç»™æ”¾è¿›å»</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">mkdir -p /wwwroot</span><br><span class="line">cp -r /usr/<span class="built_in">local</span>/nginx/html /wwwroot/onmp.ooo</span><br><span class="line"></span><br><span class="line"><span class="comment"># é…ç½®ç«™ç‚¹ç›®å½•æƒé™</span></span><br><span class="line">chown -R www-data:www-data /wwwroot/</span><br><span class="line">find /wwwroot/ -<span class="built_in">type</span> d -<span class="built_in">exec</span> chmod 755 &#123;&#125; \;</span><br><span class="line">find /wwwroot/ -<span class="built_in">type</span> f -<span class="built_in">exec</span> chmod 644 &#123;&#125; \;</span><br></pre></td></tr></table></figure><h3 id="service-é…ç½®"><a href="#service-é…ç½®" class="headerlink" title="service é…ç½®"></a>service é…ç½®</h3><p>service å‘½ä»¤ç”¨äºå¯¹ç³»ç»ŸæœåŠ¡è¿›è¡Œç®¡ç†ï¼Œæ¯”å¦‚å¯åŠ¨ï¼ˆstartï¼‰ã€åœæ­¢ï¼ˆstopï¼‰ã€é‡å¯ï¼ˆrestartï¼‰ã€æŸ¥çœ‹çŠ¶æ€ï¼ˆstatusï¼‰ç­‰ï¼Œæˆ‘ä»¬æ˜¯ç¼–è¯‘å®‰è£…çš„ï¼Œæ‰€ä»¥è¦æ‰‹åŠ¨åˆ›å»ºæœåŠ¡æ–‡ä»¶ã€‚</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">mkdir -p /usr/lib/systemd/system/</span><br></pre></td></tr></table></figure><p>ç¼–è¾‘ <code>/usr/lib/systemd/system/nginx.service</code> å†™å…¥ä»¥ä¸‹å†…å®¹</p><figure class="highlight routeros"><table><tr><td class="code"><pre><span class="line">[Unit]</span><br><span class="line"><span class="attribute">Description</span>=nginx - high performance web server</span><br><span class="line"><span class="attribute">After</span>=network.target</span><br><span class="line"></span><br><span class="line">[Service]</span><br><span class="line"><span class="attribute">Type</span>=forking</span><br><span class="line"><span class="attribute">PIDFile</span>=/var/run/nginx.pid</span><br><span class="line"><span class="attribute">ExecStartPost</span>=/bin/sleep 0.1</span><br><span class="line"><span class="attribute">ExecStartPre</span>=/usr/sbin/nginx -t -c /usr/local/nginx/conf/nginx.conf</span><br><span class="line"><span class="attribute">ExecStart</span>=/usr/sbin/nginx -c /usr/local/nginx/conf/nginx.conf</span><br><span class="line"><span class="attribute">ExecReload</span>=/usr/sbin/nginx -s reload</span><br><span class="line"><span class="attribute">ExecStop</span>=/usr/sbin/nginx -s stop</span><br><span class="line"></span><br><span class="line">[Install]</span><br><span class="line"><span class="attribute">WantedBy</span>=multi-user.target</span><br></pre></td></tr></table></figure><p>å¯åŠ¨æœåŠ¡</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">systemctl daemon-reload <span class="comment">#é‡è½½</span></span><br><span class="line">systemctl <span class="built_in">enable</span> nginx <span class="comment">#å¼€æœºå¯åŠ¨</span></span><br><span class="line">systemctl start nginx <span class="comment">#è¿è¡Œ</span></span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬ç°åœ¨å¯ä»¥ç”¨ <code>service</code> æˆ– <code>systemctl</code> ç®¡ç† nginx äº†</p><p>å¯åŠ¨ Nginx å HTTP é¡µé¢å°±æ­£å¸¸äº†ï¼Œæ‰“å¼€ onmp.ooo å°±èƒ½çœ‹åˆ° Welcome to nginx!</p><h3 id="ç­¾å‘è¯ä¹¦"><a href="#ç­¾å‘è¯ä¹¦" class="headerlink" title="ç­¾å‘è¯ä¹¦"></a>ç­¾å‘è¯ä¹¦</h3><p>é…ç½® HTTPS é¦–å…ˆè¦æœ‰è¯ä¹¦ï¼Œæˆ‘è¿™é‡Œæ˜¯ä½¿ç”¨ <a href="https://github.com/Neilpang/acme.sh" target="_blank" rel="noopener">acme.sh</a> è‡ªåŠ¨é¢å‘ Letâ€™s Encrypt çš„è¯ä¹¦</p><p>å…·ä½“ä½¿ç”¨æ•™ç¨‹çœ‹æˆ‘çš„å¦ä¸€ç¯‡æ•™ç¨‹ <a href="https://zhih.me/acme-sh-guide/">ä½¿ç”¨acme.shè·å–å…è´¹SSLè¯ä¹¦</a></p><p>å½“ç„¶ï¼Œä½ è¦æ˜¯å·²ç»æœ‰äº† SSL è¯ä¹¦ï¼Œç›´æ¥çœ‹ä¸‹é¢é…ç½®æ–‡ä»¶é‡Œè¯ä¹¦å­˜æ”¾çš„ç›®å½•ï¼Œç›´æ¥æ”¾åˆ°é‡Œé¢å»å°±è¡Œï¼Œå…¶ä»–æ“ä½œä¸€æ ·çš„</p><h3 id="HTTPS-ç«™ç‚¹é…ç½®"><a href="#HTTPS-ç«™ç‚¹é…ç½®" class="headerlink" title="HTTPS ç«™ç‚¹é…ç½®"></a>HTTPS ç«™ç‚¹é…ç½®</h3><p>å› ä¸ºæˆ‘ç»™ OpenSSL æ‰“çš„æ˜¯ equal-1.1.1_ciphers è¡¥ä¸ï¼Œæ‰€ä»¥ ssl_ciphers é…ç½®æ–‡ä»¶å¦‚ä¸‹ï¼Œå¦‚æœä½ æ‰“çš„æ˜¯åˆ«çš„è¡¥ä¸ï¼Œåˆ™éœ€è¦æŸ¥çœ‹ <a href="https://github.com/hakasenyang/openssl-patch" target="_blank" rel="noopener">https://github.com/hakasenyang/openssl-patch</a> ç»™çš„é…ç½®</p><figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line"><span class="section">server</span> &#123;</span><br><span class="line">    <span class="attribute">listen</span> <span class="number">80</span>;</span><br><span class="line">    <span class="attribute">server_name</span> onmp.ooo;</span><br><span class="line">    <span class="attribute">return</span> <span class="number">301</span> https://onmp.ooo<span class="variable">$request_uri</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="section">server</span> &#123;</span><br><span class="line">    <span class="attribute">listen</span> <span class="number">443</span> ssl http2;</span><br><span class="line">    <span class="attribute">server_name</span> onmp.ooo;</span><br><span class="line">    <span class="attribute">root</span> /wwwroot/onmp.ooo;</span><br><span class="line"></span><br><span class="line">    <span class="comment"># SSL</span></span><br><span class="line">    <span class="attribute">ssl_certificate</span>         /usr/local/nginx/conf/ssl/onmp.ooo.cer;</span><br><span class="line">    <span class="attribute">ssl_certificate_key</span>     /usr/local/nginx/conf/ssl/onmp.ooo.key;</span><br><span class="line"></span><br><span class="line">    <span class="attribute">ssl_protocols</span> TLSv1.<span class="number">2</span> TLSv1.<span class="number">3</span>;</span><br><span class="line">    <span class="attribute">ssl_ciphers</span> <span class="string">'[TLS13+AESGCM+AES128|TLS13+AESGCM+AES256|TLS13+CHACHA20]:[EECDH+ECDSA+AESGCM+AES128|EECDH+ECDSA+CHACHA20]:EECDH+ECDSA+AESGCM+AES256:EECDH+ECDSA+AES128+SHA:EECDH+ECDSA+AES256+SHA:[EECDH+aRSA+AESGCM+AES128|EECDH+aRSA+CHACHA20]:EECDH+aRSA+AESGCM+AES256:EECDH+aRSA+AES128+SHA:EECDH+aRSA+AES256+SHA:RSA+AES128+SHA:RSA+AES256+SHA:RSA+3DES'</span>;</span><br><span class="line">    <span class="attribute">ssl_ecdh_curve</span> X25519:P-<span class="number">256</span>:P-<span class="number">384</span>;</span><br><span class="line">    <span class="attribute">ssl_prefer_server_ciphers</span> <span class="literal">on</span>;</span><br><span class="line"></span><br><span class="line">    <span class="attribute">ssl_session_cache</span> shared:SSL:<span class="number">50m</span>;</span><br><span class="line">    <span class="attribute">ssl_session_timeout</span> <span class="number">1d</span>;</span><br><span class="line">    <span class="attribute">ssl_session_tickets</span> <span class="literal">on</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment"># OCSP Stapling</span></span><br><span class="line">    <span class="attribute">ssl_stapling</span> <span class="literal">on</span>;</span><br><span class="line">    <span class="attribute">ssl_stapling_verify</span> <span class="literal">on</span>;</span><br><span class="line">    <span class="attribute">resolver</span> <span class="number">119.29.29.29</span> <span class="number">8.8.8.8</span> valid=<span class="number">300s</span>;</span><br><span class="line">    <span class="attribute">resolver_timeout</span> <span class="number">10s</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Security headers</span></span><br><span class="line">    <span class="attribute">add_header</span> X-Frame-Options <span class="string">"SAMEORIGIN"</span> always;</span><br><span class="line">    <span class="attribute">add_header</span> X-XSS-Protection <span class="string">"1; mode=block"</span> always;</span><br><span class="line">    <span class="attribute">add_header</span> X-Content-Type-Options <span class="string">"nosniff"</span> always;</span><br><span class="line">    <span class="attribute">add_header</span> Referrer-Policy <span class="string">"no-referrer-when-downgrade"</span> always;</span><br><span class="line">    <span class="attribute">add_header</span> Strict-Transport-Security <span class="string">"max-age=31536000; includeSubDomains; preload"</span> always;</span><br><span class="line"></span><br><span class="line">    <span class="attribute">location</span> / &#123;</span><br><span class="line">      <span class="attribute">index</span>  index.html;</span><br><span class="line">      <span class="attribute">http2_push</span> /style.css;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="attribute">location</span> <span class="regexp">~ .*\.(gif|jpg|jpeg|png|bmp|swf|ico)$</span> &#123;</span><br><span class="line">      <span class="attribute">expires</span> <span class="number">30d</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="attribute">location</span> <span class="regexp">~ .*\.(js|css)?$</span> &#123;</span><br><span class="line">      <span class="attribute">expires</span> <span class="number">15d</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä»¥ä¸Šå°±æ˜¯å®Œæ•´çš„ç«™ç‚¹é…ç½®æ–‡ä»¶ï¼Œè¦†ç›– <code>/usr/local/nginx/conf/vhost/onmp.ooo.conf</code> åï¼Œä½¿ç”¨ <code>service nginx reload</code> é‡è½½ Nginx å†æ‰“å¼€ç«™ç‚¹å°±èƒ½çœ‹åˆ° HTTPS çš„é¡µé¢äº†</p><h2 id="éªŒè¯"><a href="#éªŒè¯" class="headerlink" title="éªŒè¯"></a>éªŒè¯</h2><p>åœ¨ Chrome 65 æˆ–æ›´æ–°çš„ç‰ˆæœ¬ä¸­ï¼Œæ‰“å¼€å¼€å‘è€…å·¥å…·çš„ Security èœå•ï¼Œå°±èƒ½åœ¨é‡Œé¢çœ‹åˆ° ç«™ç‚¹æ˜¯å¦ä»¥ TLS1.3 è¿æ¥</p><p><img src="https://pic.zhih.me/blog/posts/make-your-website-support-tls1.3/chrome.jpg" alt="chrome"></p><p>æˆ–è€…å¯ä»¥åˆ° SSL Server Testï¼š<a href="https://www.ssllabs.com/ssltest/index.html" target="_blank" rel="noopener">https://www.ssllabs.com/ssltest/index.html</a> è¿›è¡Œæµ‹è¯•</p><p><img src="https://pic.zhih.me/blog/posts/make-your-website-support-tls1.3/ssllabs.jpg" alt="ssllabs"></p><p>æˆ‘åªå¼€å¯äº† TLSv1.2 TLSv1.3 çš„æ”¯æŒï¼Œå¦‚æœéœ€è¦ï¼Œä½ å¯ä»¥è‡ªå·±å¢åŠ å…¶ä»–åè®®çš„æ”¯æŒ</p><h2 id="ç»“è¯­"><a href="#ç»“è¯­" class="headerlink" title="ç»“è¯­"></a>ç»“è¯­</h2><p>äººä»¬çš„ç”Ÿæ´»å·²ç»ç¦»ä¸å¼€ç½‘ç»œï¼Œæ‰€ä»¥ç½‘ç»œå®‰å…¨åœ¨ç°åœ¨å’Œæœªæ¥éƒ½è‡³å…³é‡è¦ï¼Œæ›¾ç»å¾ˆå¤šç«™é•¿éƒ½ä»¥ HTTPS å½±å“ç«™ç‚¹é€Ÿåº¦ä¸ºç”±ï¼Œåˆæˆ–è€…è¯´ SSL è¯ä¹¦æ˜‚è´µï¼Œæ‹’ç»é… HTTPSï¼Œè€Œéšç€æŠ€æœ¯çš„è¿­ä»£å‡çº§ï¼Œé…ç½® HTTPS+HTTPS2 èƒ½æé«˜ç½‘ç«™é€Ÿåº¦ï¼Œè€Œ SSL ä¸ä»…å¯ä»¥å…è´¹è·å–ï¼Œè¿˜å¯ä»¥ä½¿ç”¨å‘½ä»¤è‡ªåŠ¨è·å–è‡ªåŠ¨æ›´æ–°ï¼Œåœ¨æˆ‘çœ‹æ¥å·²ç»æ²¡æœ‰ç†ç”±ä¸é…ç½® HTTPS äº†ï¼Œæ‰€ä»¥å¸Œæœ›å„ä½ç«™é•¿ï¼Œéƒ½èµ¶ç´§ä¸Šè½¦å§</p><blockquote><p>æœ¬æ–‡ç« å‘è¡¨äºåº•å™ªåšå®¢ <a href="https://zhih.me">https://zhih.me</a> , è½¬è½½è¯·æ³¨æ˜</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> æ•™ç¨‹ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> nginx </tag>
            
            <tag> https </tag>
            
            <tag> webä¼˜åŒ– </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Syncthingå°±æ˜¯æˆ‘è¦çš„åŒæ­¥å¤‡ä»½è½¯ä»¶</title>
      <link href="/syncthing-the-best/"/>
      <url>/syncthing-the-best/</url>
      
        <content type="html"><![CDATA[<h2 id="å¼•è¨€"><a href="#å¼•è¨€" class="headerlink" title="å¼•è¨€"></a>å¼•è¨€</h2><p>æ•°æ®æ— ä»·ï¼Œå¹³æ—¶ä¸æ³¨æ„å¤‡ä»½ï¼Œç”µè„‘çªç„¶ç¿»è½¦å°±è¿½æ‚”è«åŠå•¦ã€‚</p><p>æœ€å¼€å§‹çš„æ—¶å€™ï¼Œæˆ‘åœ¨è·¯ç”±å™¨ä¸Šå¼€å¯ Sambaï¼Œæ¯æ¬¡ç¼–è¾‘å®Œé¡¹ç›®å°±æ‰‹åŠ¨æ‹·è´åˆ°è·¯ç”±å™¨ç¡¬ç›˜é‡Œï¼Œéº»çƒ¦ç¨‹åº¦å¯æƒ³è€ŒçŸ¥ï¼Œåæ¥åˆç”¨äº† Google Drive/One Driveï¼Œåˆå› ä¸ºå®ƒä»¬çš„ç½‘ç»œä¸ç†æƒ³ï¼Œå°±åˆæ”¾å¼ƒä½¿ç”¨äº†ã€‚</p><p>å…¶å®å°±æ˜¯å¾ˆç®€å•çš„éœ€æ±‚ï¼Œè‡ªåŠ¨å¤‡ä»½ã€é€Ÿåº¦å¿«ï¼Œç„¶åå»æ‰¾äº†ä¸€ä¸‹ï¼Œå‘ç°ä¸€å †äººæ¨èç”¨ Rsyncï¼Œè¿™è´§æˆ‘åªåœ¨ VPS ä¸Šç”¨è¿‡ï¼Œæ‹¿æ¥åšé•œåƒåŒæ­¥ï¼Œä½†æ˜¯è¦åšå®æ—¶åŒæ­¥ï¼Œä¸å¥½é…ç½®ã€‚</p><p>æˆ‘å°±æƒ³ï¼Œè¿™éœ€æ±‚åº”è¯¥æœ‰ä¸€å¤§å †äººæœ‰å§ï¼Œå°±å» github æœç´¢ syncï¼Œå‘ç° Syncthing è¿™ä¹ˆä¸ªå¥½ä¸œè¥¿ï¼Œæˆªæ­¢ 2018-06-13 å·²ç»å¾—åˆ° 20k+ çš„ starï¼Œå¹¶ä¸”æ›´æ–°å¾ˆæ´»è·ƒ</p><h2 id="ä»‹ç»"><a href="#ä»‹ç»" class="headerlink" title="ä»‹ç»"></a>ä»‹ç»</h2><p><img src="https://pic.zhih.me/blog/posts/syncthing-the-best/logo.jpg" alt="logo"></p><p>Syncthing æ˜¯ä¸€ä¸ªæ–‡ä»¶è¿ç»­åŒæ­¥è½¯ä»¶</p><p>é¡¹ç›®åœ°å€ï¼š<a href="https://github.com/syncthing/syncthing" target="_blank" rel="noopener">https://github.com/syncthing/syncthing</a></p><p>å®ƒæœ‰ä»¥ä¸‹ç‰¹æ€§ï¼š</p><ul><li><p>è·¨å¹³å°</p><ul><li>ä½¿ç”¨ Golang å¼€å‘ï¼Œå‡ ä¹èƒ½åœ¨æ‰€æœ‰å¹³å°ä¸Šä½¿ç”¨ï¼ŒåŒ…æ‹¬å¸¸è§çš„å®‰å“æ‰‹æœºå’Œè·¯ç”±å™¨å¹³å°</li></ul></li><li><p>æ˜“äºä½¿ç”¨</p><ul><li>åªéœ€è¦ä¸‹è½½è¿è¡Œï¼Œæ‰“å¼€æµè§ˆè®¾ç½®æœ¬åœ°ç›®å½•å’Œè¿œç¨‹ä¸»æœºï¼Œå…¶ä»–çš„ä¸éœ€è¦ç®¡</li></ul></li><li><p>å®‰å…¨</p><ul><li>ç®¡ç†é¡µå¯ä»¥è®¾ç½®å¯†ç ï¼Œå¯ä»¥è®¾ç½® httpsï¼Œè®¾ç½®å¤‡ä»½éœ€è¦ä¸¤è¾¹éƒ½ç¡®è®¤ï¼Œä½¿ç”¨å”¯ä¸€è®¾å¤‡æ ‡è¯†è¿›è¡Œç¡®è®¤</li></ul></li></ul><h2 id="å®‰è£…"><a href="#å®‰è£…" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h2><p>Syncthing æœ‰å¤šç§å®‰è£…æ–¹å¼</p><p>æœ‰ä¸€å®š Linux åŸºç¡€çš„äººï¼Œå¯ä»¥ä½¿ç”¨ä¸‹é¢çš„é…ç½®æ¥è®¾ç½®å¯åŠ¨æœåŠ¡</p><ul><li><a href="https://github.com/syncthing/syncthing/tree/master/etc" target="_blank" rel="noopener">https://github.com/syncthing/syncthing/tree/master/etc</a></li></ul><p>Windowsï¼ŒMacï¼ŒLinux å’Œå®‰å“æ‰‹æœºå¯ä»¥åœ¨è¿™é‡Œä¸‹è½½æœ‰ GUI ç•Œé¢çš„ç¨‹åºä½¿ç”¨</p><ul><li><a href="https://docs.syncthing.net/users/contrib.html#gui-wrappers" target="_blank" rel="noopener">https://docs.syncthing.net/users/contrib.html#gui-wrappers</a></li></ul><p>å…¶ä»–æ–¹æ³•å¯ä»¥è‡ªå·±å†³å®šï¼Œæˆ‘æ˜¯ç›´æ¥ä¸‹è½½å®‰è£…åŒ…å‘½ä»¤è¡Œå¯åŠ¨çš„</p><h3 id="åœ¨-MacOS-ä¸Šå®‰è£…"><a href="#åœ¨-MacOS-ä¸Šå®‰è£…" class="headerlink" title="åœ¨ MacOS ä¸Šå®‰è£…"></a>åœ¨ MacOS ä¸Šå®‰è£…</h3><p>æˆ‘ç”¨çš„æ˜¯ MacOSï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨ homebrew å®‰è£…å¯åŠ¨ï¼Œå¹¶ä¸”å¯ä»¥å¼€æœºè‡ªåŠ¨å¯åŠ¨ï¼Œä½ ä¹Ÿå¯ä»¥åˆ°è¿™é‡Œ <a href="https://github.com/sieren/QSyncthingTray/releases" target="_blank" rel="noopener">QSyncthingTray</a> ä¸‹è½½ MacOS çš„ GUI ç‰ˆ</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">brew install syncthing</span><br></pre></td></tr></table></figure><p>å¯åŠ¨æœåŠ¡ï¼ˆåŒæ—¶è®¾ç½®å¼€æœºå¯åŠ¨ï¼‰</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">brew services start syncthing</span><br></pre></td></tr></table></figure><p>åœæ­¢æœåŠ¡ï¼ˆåŒæ—¶å…³é—­è‡ªå¯ï¼‰</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">brew services stop syncthing</span><br></pre></td></tr></table></figure><p>æ‰‹åŠ¨å¯åŠ¨ï¼ˆä¸ä¼šå¼€æœºè‡ªå¯ï¼‰</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">syncthing</span><br></pre></td></tr></table></figure><p>å¯åŠ¨è¿›ç¨‹åï¼Œå¯ä»¥ç”¨æµè§ˆå™¨æ‰“å¼€ <code>http://localhost:8384/</code> æ¥æŸ¥çœ‹ web ç®¡ç†é¡µ</p><h3 id="åœ¨-Windows-ä¸Šå®‰è£…"><a href="#åœ¨-Windows-ä¸Šå®‰è£…" class="headerlink" title="åœ¨ Windows ä¸Šå®‰è£…"></a>åœ¨ Windows ä¸Šå®‰è£…</h3><p>Windows ç›´æ¥åœ¨è¿™é‡Œ <a href="https://github.com/canton7/SyncTrayzor/releases" target="_blank" rel="noopener">SyncTrayzor</a> ä¸‹è½½è½¯ä»¶è¿è¡Œ</p><h3 id="åœ¨-Linux-VPS-ä¸Šå®‰è£…"><a href="#åœ¨-Linux-VPS-ä¸Šå®‰è£…" class="headerlink" title="åœ¨ Linux VPS ä¸Šå®‰è£…"></a>åœ¨ Linux VPS ä¸Šå®‰è£…</h3><p>å¤§å¤šæ•°å‘è¡Œç‰ˆå’Œä¸åŒ CPU å¹³å°çš„å®‰è£…åŒ…ï¼Œå¯ä»¥åœ¨è¿™é‡Œ <a href="https://github.com/syncthing/syncthing/releases" target="_blank" rel="noopener">Syncthing</a> æ‰¾åˆ°ï¼ŒæŠŠå®ƒä¸‹è½½åˆ°ä½ æƒ³è¦æ”¾åœ¨çš„ç›®å½•ç„¶åè®¾ç½®æƒé™ï¼Œä½¿ç”¨å‘½ä»¤è¿è¡Œ</p><p>æ–‡ç« å¼€å¤´æœ‰ GUI ç‰ˆæœ¬çš„é“¾æ¥ï¼Œä¸è¿‡æˆ‘è¦è£…åœ¨æ²¡æœ‰ GUI çš„ VPS ä¸Šï¼Œæ‰€ä»¥ç›´æ¥ç”¨å‘½ä»¤è¡Œè¿è¡Œï¼Œç³»ç»Ÿç”¨çš„æ˜¯ Debian 9ï¼Œç„¶åç”¨ supervisor è¿›ç¨‹å®ˆæŠ¤æ¥å¯åŠ¨çš„</p><p>ç¢°å·§å‰å‡ å¤©ä¹‹å‰çš„ä¸€ä¸ªå®¢æˆ·ï¼Œä»–çš„ VPS åšè¿ç§»ï¼Œé˜¿é‡Œäº‘é€äº†å¼ ä»£é‡‘åˆ¸ï¼Œç„¶åå®¢æˆ·å°±é€ç»™æˆ‘äº†</p><p><img src="https://pic.zhih.me/blog/posts/syncthing-the-best/aff.jpg" alt="aff"></p><p>ç„¶åç»­è´¹ 9 ä¸ªæœˆçš„é˜¿é‡Œäº‘å­¦ç”Ÿæœºï¼Œç¾æ»‹æ»‹ğŸ˜</p><p>è™½ç„¶å¸¦å®½æ¯”è¾ƒä½ï¼Œä½†æ˜¯å¯¹äºè¿™ç§è¿ç»­åŒæ­¥çš„å¤‡ä»½æ¥è¯´ï¼Œåœ¨ç¬¬ä¸€æ¬¡å¤‡ä»½ä¹‹åï¼Œåé¢éƒ½æ˜¯å¢é‡å¤‡ä»½äº†ï¼Œé™¤éä½ éƒ½æ˜¯å¤‡ä»½å¤§æ–‡ä»¶ï¼Œè¦ä¸å¯¹å¸¦å®½çš„è¦æ±‚ä¸æ˜¯å¾ˆé«˜ï¼Œå¦å¤– 40G çš„ç›˜ï¼Œå®Œå…¨å¤Ÿæˆ‘å¤‡ä»½ç”¨äº†ï¼Œé˜¿é‡Œäº‘æœ€ä¸»è¦å°±æ˜¯ç¨³å®šï¼Œå¾ˆé€‚åˆåšæˆ‘çš„å¤‡ä»½æœº</p><h4 id="ä¸‹è½½-Syncthing"><a href="#ä¸‹è½½-Syncthing" class="headerlink" title="ä¸‹è½½ Syncthing"></a>ä¸‹è½½ Syncthing</h4><p>ä¸‹è½½æœ€æ–°çš„åŒ…ï¼Œè§£å‹ï¼Œç§»åŠ¨åˆ° <code>/bin/</code> é‡Œï¼Œæ”¹æƒé™</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">wget https://github.com/syncthing/syncthing/releases/download/v0.14.49-rc.1/syncthing-linux-amd64-v0.14.49-rc.1.tar.gz</span><br><span class="line"></span><br><span class="line">tar xzvf ./syncthing-linux-amd64-v0.14.49-rc.1.tar.gz</span><br><span class="line"></span><br><span class="line">mv ./syncthing-linux-amd64-v0.14.49-rc.1/syncthing /bin/</span><br><span class="line"></span><br><span class="line">chmod +x /bin/syncthing</span><br></pre></td></tr></table></figure><h4 id="è¿›ç¨‹å®ˆæŠ¤"><a href="#è¿›ç¨‹å®ˆæŠ¤" class="headerlink" title="è¿›ç¨‹å®ˆæŠ¤"></a>è¿›ç¨‹å®ˆæŠ¤</h4><p>å®‰è£… supervisor</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">apt-get install supervisor</span><br></pre></td></tr></table></figure><p>é…ç½®å®ˆæŠ¤</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">vi /etc/supervisor/conf.d/syncthing.conf</span><br></pre></td></tr></table></figure><p>å¡«å…¥ä»¥ä¸‹å†…å®¹</p><figure class="highlight routeros"><table><tr><td class="code"><pre><span class="line">[program:syncthing]</span><br><span class="line">command = /bin/syncthing -no-browser <span class="attribute">-home</span>=<span class="string">"/root/.config/syncthing"</span></span><br><span class="line">directory = /root</span><br><span class="line">autorestart = <span class="literal">True</span></span><br><span class="line">user = root</span><br><span class="line">environment = <span class="attribute">STNORESTART</span>=<span class="string">"1"</span>, <span class="attribute">HOME</span>=<span class="string">"/root"</span></span><br></pre></td></tr></table></figure><p><strong>æ³¨æ„</strong>ï¼Œæˆ‘ä¾‹å­é‡Œä½¿ç”¨çš„æ˜¯ root ç”¨æˆ·ï¼Œæ‰€ä»¥å“åº”çš„ç›®å½•æ˜¯ <code>/root</code>ï¼Œä½ è¦æ˜¯ä½¿ç”¨å…¶ä»–ç”¨æˆ·ï¼Œåº”è¯¥æ˜¯ <code>/home/ç”¨æˆ·å</code>ï¼Œå°±æ˜¯ä½ ç™»å½•æ—¶é»˜è®¤æ‰€åœ¨çš„ç›®å½•</p><p>ç°åœ¨å°±å¯ä»¥ä½¿ç”¨ <code>supervisorctl</code> å‘½ä»¤æ¥ç®¡ç†è¿›ç¨‹äº†</p><ul><li>å¯åŠ¨</li></ul><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">supervisorctl start syncthing</span><br></pre></td></tr></table></figure><ul><li>é‡å¯</li></ul><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">supervisorctl restart syncthing</span><br></pre></td></tr></table></figure><ul><li>åœæ­¢</li></ul><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">supervisorctl stop syncthing</span><br></pre></td></tr></table></figure><p>å¯åŠ¨è¿›ç¨‹åï¼Œå¯ä»¥ç”¨æµè§ˆå™¨æ‰“å¼€ <code>http://ä½ çš„IP:8384/</code> æ¥æŸ¥çœ‹ web ç®¡ç†é¡µ</p><p>å¦‚æœæ— æ³•æ‰“å¼€é¡µé¢ï¼Œéœ€è¦ä¿®æ”¹ <code>/.config/syncthing/config.xml</code> é‡Œçš„ <code>127.0.0.1:8384</code> å­—æ®µä¸º <code>0.0.0.0:8384</code>ï¼Œæˆ–è€…ä½ å¯ä»¥å’Œæˆ‘ä¸€æ ·ä½¿ç”¨ nginx åšåå‘ä»£ç†ï¼Œå‰ææ˜¯ä½ çŸ¥é“æ€ä¹ˆåš</p><h3 id="åœ¨è·¯ç”±å™¨ä¸Šå®‰è£…"><a href="#åœ¨è·¯ç”±å™¨ä¸Šå®‰è£…" class="headerlink" title="åœ¨è·¯ç”±å™¨ä¸Šå®‰è£…"></a>åœ¨è·¯ç”±å™¨ä¸Šå®‰è£…</h3><p>ç›®å‰ <a href="https://entware.net/" target="_blank" rel="noopener">Entware</a> æºé‡Œå·²ç»æœ‰è¿™ä¸ªåŒ…äº†ï¼Œä½†æ˜¯æˆ‘å‘ç°å®ƒæ˜¯ä¸ªæ—§ç‰ˆæœ¬ï¼Œå¹¶ä¸”æœ‰é—®é¢˜ï¼Œæ‰€ä»¥è¿™é‡Œæˆ‘é€‰æ‹©æ‰‹åŠ¨å®‰è£…</p><p>è¿™é‡Œçš„ä¾‹å­æ˜¯ LEDE x64 ä½†æ˜¯ä¹Ÿé€‚åˆä¸€åˆ‡å®‰è£…äº† Entware çš„è·¯ç”±å™¨</p><p>åœ¨è¿™é‡Œ <a href="https://github.com/syncthing/syncthing/releases" target="_blank" rel="noopener">Syncthing</a> ä¸‹è½½å¯¹åº” CPU å¹³å°çš„å®‰è£…åŒ…ï¼Œå¯ä»¥ç”¨ <code>uname -m</code> æŸ¥çœ‹ï¼Œæˆ‘è¿™é‡Œæ˜¯ x86_64 æ‰€ä»¥é€‰æ‹© amd64</p><h4 id="ä¸‹è½½-syncthing"><a href="#ä¸‹è½½-syncthing" class="headerlink" title="ä¸‹è½½ syncthing"></a>ä¸‹è½½ syncthing</h4><p>ä¸‹è½½æœ€æ–°çš„åŒ…ï¼Œè§£å‹ï¼Œç§»åŠ¨åˆ° <code>/opt/bin/</code> é‡Œï¼Œæ”¹æƒé™</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">wget https://github.com/syncthing/syncthing/releases/download/v0.14.49-rc.1/syncthing-linux-amd64-v0.14.49-rc.1.tar.gz</span><br><span class="line"></span><br><span class="line">tar xzvf ./syncthing-linux-amd64-v0.14.49-rc.1.tar.gz</span><br><span class="line"></span><br><span class="line">mv ./syncthing-linux-amd64-v0.14.49-rc.1/syncthing /opt/bin/</span><br><span class="line"></span><br><span class="line">chmod +x /opt/bin/syncthing</span><br></pre></td></tr></table></figure><h4 id="æ·»åŠ å¯åŠ¨å‘½ä»¤"><a href="#æ·»åŠ å¯åŠ¨å‘½ä»¤" class="headerlink" title="æ·»åŠ å¯åŠ¨å‘½ä»¤"></a>æ·»åŠ å¯åŠ¨å‘½ä»¤</h4><p>åˆ›å»ºå¹¶ç¼–è¾‘ <code>/opt/etc/init.d/S92syncthing</code></p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">vi /opt/etc/init.d/S92syncthing</span><br></pre></td></tr></table></figure><p>åœ¨é‡Œé¢å¡«ä¸Šä¸‹é¢æ‰€æœ‰å­—æ®µ</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="meta">#!/bin/sh</span></span><br><span class="line">ENABLED=yes</span><br><span class="line">PROCS=syncthing</span><br><span class="line">ARGS=<span class="string">"-home=/opt/etc/syncthing"</span></span><br><span class="line">PREARGS=<span class="string">""</span></span><br><span class="line">DESC=<span class="variable">$PROCS</span></span><br><span class="line">PATH=/opt/sbin:/opt/bin:/usr/<span class="built_in">local</span>/sbin:/usr/<span class="built_in">local</span>/bin:/usr/sbin:/usr/bin:/sbin:/bin</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> [ ! -d /opt/etc/syncthing ]; <span class="keyword">then</span></span><br><span class="line">   /opt/bin/syncthing -generate=<span class="string">"/opt/etc/syncthing"</span></span><br><span class="line">   sed -i <span class="string">'s|127.0.0.1:8384|0.0.0.0:8384|'</span> /opt/etc/syncthing/config.xml</span><br><span class="line"><span class="keyword">elif</span> [[ -f /opt/etc/syncthing/config.xml -a <span class="string">"127.0.0.1:8384"</span>==<span class="string">"127.0.0.1:8384"</span> ]]; <span class="keyword">then</span></span><br><span class="line">   sed -i <span class="string">'s|127.0.0.1:8384|0.0.0.0:8384|'</span> /opt/etc/syncthing/config.xml</span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"></span><br><span class="line">. /opt/etc/init.d/rc.func</span><br></pre></td></tr></table></figure><p>ç„¶åç»™æƒé™</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">chmod +x /opt/etc/init.d/S92syncthing</span><br></pre></td></tr></table></figure><p>ç”¨æ³•: /opt/etc/init.d/S92syncthing (start|stop|restart|check)</p><p>å¯åŠ¨æœåŠ¡å°±èƒ½åœ¨æµè§ˆå™¨æ‰“å¼€ <code>è·¯ç”±å™¨IP:8384</code> ä¾‹å¦‚ <code>192.168.1.1:8384</code> æ‰“å¼€ç®¡ç†é¡µäº†</p><h2 id="ä½¿ç”¨æ–¹æ³•"><a href="#ä½¿ç”¨æ–¹æ³•" class="headerlink" title="ä½¿ç”¨æ–¹æ³•"></a>ä½¿ç”¨æ–¹æ³•</h2><p>æ˜“äºä½¿ç”¨æ˜¯ Syncthing çš„ä¸€ä¸ªé‡è¦ç‰¹æ€§ï¼Œæ‰“å¼€ç®¡ç†é¡µï¼Œä¸€ç›®äº†ç„¶</p><p>é¦–æ¬¡æ‰“å¼€ç®¡ç†é¡µï¼Œæ‰€æœ‰å¹³å°ä¸Šéƒ½æ˜¯ä¸€æ ·çš„</p><p><img src="https://pic.zhih.me/blog/posts/syncthing-the-best/syncthing.jpg" alt="syncthing"></p><p>ç„¶åä½ éœ€è¦åšçš„å°±æ˜¯</p><h3 id="è®¾ç½®ç”¨æˆ·åã€å¯†ç "><a href="#è®¾ç½®ç”¨æˆ·åã€å¯†ç " class="headerlink" title="è®¾ç½®ç”¨æˆ·åã€å¯†ç "></a>è®¾ç½®ç”¨æˆ·åã€å¯†ç </h3><p><img src="https://pic.zhih.me/blog/posts/syncthing-the-best/setpass.jpg" alt="setpass"></p><h3 id="è®¾ç½®æ–‡ä»¶å¤¹"><a href="#è®¾ç½®æ–‡ä»¶å¤¹" class="headerlink" title="è®¾ç½®æ–‡ä»¶å¤¹"></a>è®¾ç½®æ–‡ä»¶å¤¹</h3><p>åˆ é™¤é»˜è®¤çš„åŒæ­¥æ–‡ä»¶å¤¹ï¼Œæ·»åŠ æ–°åŒæ­¥æ–‡ä»¶å¤¹</p><p><img src="https://pic.zhih.me/blog/posts/syncthing-the-best/addlocal.jpg" alt="addlocal"></p><h3 id="æ·»åŠ è¿œç¨‹è®¾å¤‡"><a href="#æ·»åŠ è¿œç¨‹è®¾å¤‡" class="headerlink" title="æ·»åŠ è¿œç¨‹è®¾å¤‡"></a>æ·»åŠ è¿œç¨‹è®¾å¤‡</h3><p><img src="https://pic.zhih.me/blog/posts/syncthing-the-best/addremote.jpg" alt="addremote"></p><p>ç„¶åç¨å¾®ç­‰ä¸€åˆ†é’Ÿï¼Œä¸¤è¾¹å°±èƒ½è¿æ¥ä¸Šäº†</p><p>æœ€ç»ˆæ•ˆæœ</p><p><img src="https://pic.zhih.me/blog/posts/syncthing-the-best/end.jpg" alt="end"></p><h2 id="ç»“è¯­"><a href="#ç»“è¯­" class="headerlink" title="ç»“è¯­"></a>ç»“è¯­</h2><p>Syncthing ä½œä¸ºä¸€æ¬¾è·¨å¹³å°åŒæ­¥è½¯ä»¶ï¼Œå®ƒç®€å•æ˜“ç”¨ã€åŠŸèƒ½å®Œå–„å¼ºå¤§ï¼Œå…·æœ‰å¾ˆé«˜çš„ç¨³å®šæ€§ï¼Œå¾ˆå®¹æ˜“è®©äººæƒ³å‡ºå„ç§ä½¿ç”¨åœºæ™¯ï¼Œè€Œä¸”å®ƒè¿˜æ˜¯å¼€æºçš„ï¼Œæ„Ÿè°¢é‚£ä¸Šç™¾ä½è´¡çŒ®è€…</p><p>æœ¬æ–‡ç®€å•ä»‹ç»äº†åˆçº§ä½¿ç”¨æ–¹æ³•ï¼Œè¿˜æœªæåŠå…¶ä»–çš„è¯¸å¦‚ç‰ˆæœ¬æ§åˆ¶ç­‰åŠŸèƒ½ï¼Œå…¶ä»–åŠŸèƒ½åº”ç”¨ï¼Œå¦‚æœä»¥åæˆ‘è§‰å¾—å€¼å¾—ä¸€è¯´ï¼Œå†æ›´æ–°äº†</p><blockquote><p>æœ¬æ–‡ç« å‘è¡¨äºåº•å™ªåšå®¢ <a href="https://zhih.me">https://zhih.me</a> , è½¬è½½è¯·æ³¨æ˜</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> æ•™ç¨‹ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> MacOS </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>MacOSè¯»å†™NTFSï¼ŒåŠEXTåˆ†åŒºæ ¼å¼åŒ–å’ŒæŒ‚è½½</title>
      <link href="/macos-mount-ntfs-ext/"/>
      <url>/macos-mount-ntfs-ext/</url>
      
        <content type="html"><![CDATA[<h2 id="å¼•è¨€"><a href="#å¼•è¨€" class="headerlink" title="å¼•è¨€"></a>å¼•è¨€</h2><p>æœ‰æ—¶å€™éœ€è¦åœ¨ MacOS è¯»å†™ NTFS åˆ†åŒºï¼Œä½†æ˜¯ç³»ç»Ÿé»˜è®¤åªèƒ½è¯»å–ä¸èƒ½å†™å…¥ï¼Œä¿®æ”¹ fstab å’Œä½¿ç”¨ Paragon NTFS è½¯ä»¶éƒ½å¯ä»¥å®ç°è¯»å†™ï¼Œè€Œæˆ‘è¿™é‡Œä½¿ç”¨çš„æ˜¯ osxfuseï¼Œå› ä¸ºå®ƒä¸ä»…èƒ½æ”¯æŒ NTFS, è¿˜æ”¯æŒ Ext ç­‰å…¶ä»–æ–‡ä»¶ç³»ç»Ÿ</p><p><img src="https://pic.zhih.me/blog/posts/macos-mount-ntfs-ext/panes.jpg" alt="panes"></p><p>ä»¥ä¸‹æ“ä½œéœ€è¦å…³é—­ SIPï¼Œè¿›å…¥æ¢å¤æ¨¡å¼ï¼Œåœ¨ç»ˆç«¯é‡Œè¾“å…¥ <code>csrutil disable</code>ï¼Œå†é‡å¯å°±å…³é—­ SIP äº†ï¼Œé»‘è‹¹æœå¯ä»¥åœ¨ clover é‡Œè®¾ç½®</p><h2 id="å®‰è£…-osxfuse"><a href="#å®‰è£…-osxfuse" class="headerlink" title="å®‰è£… osxfuse"></a>å®‰è£… osxfuse</h2><p><code>FUSE for OS X</code> æ˜¯ç”¨åœ¨ MacOS ä¸Šçš„ç¬¬ä¸‰æ–¹æ–‡ä»¶ç³»ç»Ÿæ‰©å±•ï¼Œåœ°å€ï¼š<a href="https://github.com/osxfuse/osxfuse/wiki" target="_blank" rel="noopener">https://github.com/osxfuse/osxfuse/wiki</a></p><p>ä½¿ç”¨ <a href="https://brew.sh/" target="_blank" rel="noopener">homebrew</a> å®‰è£…</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">brew cask install osxfuse</span><br></pre></td></tr></table></figure><p><img src="https://pic.zhih.me/blog/posts/macos-mount-ntfs-ext/osxfuse.jpg" alt="osxfuse.jpg"></p><p>äº‹å®ä¸Š FUSE æ˜¯æä¾›äº†æä¾›äº†æ¥å£ï¼Œè¦å®ç° NTFS å’Œ Ext æ–‡ä»¶ç³»ç»Ÿçš„æ”¯æŒï¼Œè¿˜éœ€è¦å®‰è£…æ¨¡å—</p><h2 id="è¯»å†™-NTFS-åˆ†åŒº"><a href="#è¯»å†™-NTFS-åˆ†åŒº" class="headerlink" title="è¯»å†™ NTFS åˆ†åŒº"></a>è¯»å†™ NTFS åˆ†åŒº</h2><p>è®© MacOS è¯»å†™ NTFS éœ€è¦å®‰è£… ntfs-3g</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">brew install ntfs-3g</span><br></pre></td></tr></table></figure><h3 id="æ‰‹åŠ¨æŒ‚è½½"><a href="#æ‰‹åŠ¨æŒ‚è½½" class="headerlink" title="æ‰‹åŠ¨æŒ‚è½½"></a>æ‰‹åŠ¨æŒ‚è½½</h3><p>ä½¿ç”¨ <code>diskutil list</code> æŸ¥çœ‹åˆ†åŒºï¼Œä¾‹å¦‚æˆ‘çš„ U ç›˜æ˜¯ <code>disk4s1</code></p><p>é‚£ä¹ˆå¯ä»¥ç”¨ä»¥ä¸‹å‘½ä»¤æŒ‚è½½</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">mkdir ~/Desktop/UDISK</span><br><span class="line">sudo ntfs-3g /dev/disk4s1 ~/Desktop/UDISK -o allow_other</span><br></pre></td></tr></table></figure><p>è¿™æ · U ç›˜å°±è¢«æŒ‚è½½åˆ°æ¡Œé¢äº†</p><p>å¸è½½è¿™ä¸ªåˆ†åŒºçš„å‘½ä»¤å¼æ˜¯ <code>sudo umount /dev/disk4s1</code></p><p><strong>æ³¨æ„ï¼š</strong>ä¸ç®¡æ˜¯ç”¨ä»€ä¹ˆæ–¹å¼æŒ‚è½½ NTFS åˆ†åŒºï¼Œéƒ½ä¸å»ºè®®æŒ‚è½½ win çš„ç³»ç»Ÿç›˜ï¼Œæœ‰ç¿»è½¦å«Œç–‘ï¼Œæ‰€ä»¥å½“ ntfs-3g å‘ç°ä½ æŒ‚è½½çš„åˆ†åŒºæœ‰ win ä¼‘çœ å’Œå¿«é€Ÿå¯åŠ¨é—ç•™çš„ç¼“å­˜æ—¶ï¼Œä¼šä»¥åªè¯»æ¨¡å¼æŒ‚è½½ï¼Œå¦‚æœå®åœ¨éœ€è¦ä¿®æ”¹ win ç³»ç»Ÿåˆ†åŒºï¼Œéœ€è¦åœ¨ win é‡Œå…³é—­å¿«é€Ÿå¯åŠ¨</p><h3 id="è‡ªåŠ¨æŒ‚è½½"><a href="#è‡ªåŠ¨æŒ‚è½½" class="headerlink" title="è‡ªåŠ¨æŒ‚è½½"></a>è‡ªåŠ¨æŒ‚è½½</h3><p>æˆ‘ä»¬çŸ¥é“ï¼ŒMacOS å¼€æœºæ—¶ä¼šè‡ªåŠ¨æŒ‚è½½ NTFS åˆ†åŒºï¼Œä½†æ˜¯åªèƒ½è¯»å–</p><p>å®‰è£… ntfs-3g åï¼Œæˆ‘ä»¬éœ€è¦è®©æ–°çš„ mount_ntfs æ›¿æ¢ç³»ç»Ÿè‡ªå¸¦çš„ç‰ˆæœ¬ï¼Œå®ç°å†™å…¥</p><p>ä¸ºäº†å‡å°‘å¯¹ç³»ç»Ÿçš„å½±å“ï¼Œæˆ‘ä»¬æŠŠæ—§ç‰ˆæœ¬å¤‡ä»½ï¼Œå¹¶æŠŠæ–°ç‰ˆæœ¬è½¯é“¾æ¥è¿‡å»</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo mv /sbin/mount_ntfs /sbin/mount_ntfs.bak</span><br><span class="line">sudo ln -s /usr/<span class="built_in">local</span>/sbin/mount_ntfs /sbin/mount_ntfs</span><br></pre></td></tr></table></figure><p>é‡å¯ç”Ÿæ•ˆï¼Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼Œæ¯æ¬¡å‡çº§æˆ–é‡è£…ç³»ç»Ÿä¹‹åï¼Œéœ€è¦é‡æ–°åšè½¯é“¾æ¥</p><p>ç°åœ¨å¯ä»¥é‡æ–°æ‰“å¼€ SIPï¼Œåœ¨æ¢å¤æ¨¡å¼çš„ç»ˆç«¯é‡Œï¼Œè¾“å…¥ <code>csrutil enable</code> å†é‡å¯ï¼Œé»‘æœå¯ä»¥åœ¨ clover é‡Œè®¾ç½®</p><h2 id="EXT-æ ¼å¼åŒ–å’ŒæŒ‚è½½"><a href="#EXT-æ ¼å¼åŒ–å’ŒæŒ‚è½½" class="headerlink" title="EXT æ ¼å¼åŒ–å’ŒæŒ‚è½½"></a>EXT æ ¼å¼åŒ–å’ŒæŒ‚è½½</h2><p>ext2ã€ext3ã€ext4 æ ¼å¼åŒ–éœ€è¦å®‰è£… e2fsprogsï¼ŒæŒ‚è½½éœ€è¦å®‰è£… <a href="https://github.com/alperakcan/fuse-ext2" target="_blank" rel="noopener">fuse-ext2</a></p><p>fuse-ext2 ä¹Ÿä¾èµ–äº e2fsprogsï¼Œæ‰€ä»¥å…ˆè£…å®ƒ</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">brew install e2fsprogs</span><br></pre></td></tr></table></figure><p>å†å®‰è£… fuse-ext2</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">brew install https://raw.githubusercontent.com/yalp/homebrew-core/fuse-ext2/Formula/fuse-ext2.rb</span><br></pre></td></tr></table></figure><p>æ ¹æ®æç¤ºï¼Œè®¾ç½®é¢æ¿é‡Œçš„é€‰é¡¹éœ€è¦è¿™æ ·æ“ä½œæ‰èƒ½æ˜¾ç¤º</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo cp -pR /usr/<span class="built_in">local</span>/opt/fuse-ext2/System/Library/Filesystems/fuse-ext2.fs /Library/Filesystems/</span><br><span class="line"></span><br><span class="line">sudo chown -R root:wheel /Library/Filesystems/fuse-ext2.fs</span><br><span class="line"></span><br><span class="line">sudo cp -pR /usr/<span class="built_in">local</span>/opt/fuse-ext2/System/Library/PreferencePanes/fuse-ext2.prefPane /Library/PreferencePanes/</span><br><span class="line"></span><br><span class="line">sudo chown -R root:wheel /Library/PreferencePanes/fuse-ext2.prefPane</span><br></pre></td></tr></table></figure><p><img src="https://pic.zhih.me/blog/posts/macos-mount-ntfs-ext/ext.jpg" alt="ext"></p><p>è¿™æ ·å°±è£…å¥½äº†</p><h3 id="EXT-åˆ†åŒºæ ¼å¼åŒ–"><a href="#EXT-åˆ†åŒºæ ¼å¼åŒ–" class="headerlink" title="EXT åˆ†åŒºæ ¼å¼åŒ–"></a>EXT åˆ†åŒºæ ¼å¼åŒ–</h3><p>å‰é¢æˆ‘ä»¬å·²ç»å®‰è£…äº† e2fsprogsï¼Œç°åœ¨å¯ä»¥ä½¿ç”¨å®ƒæä¾›çš„å‘½ä»¤æ¥æ ¼å¼åŒ–åˆ†åŒº</p><p>å…ˆè®¾ç½®å˜é‡è®© e2fs åº“é‡Œçš„å‘½ä»¤æš´éœ²å‡ºæ¥ï¼Œå°†ä»¥ä¸‹å­—æ®µåŠ åœ¨ shell çš„é…ç½®æ–‡ä»¶ä¸­ï¼Œæˆ‘ç”¨çš„æ˜¯ zshï¼Œæ‰€ä»¥åŠ åœ¨ <code>~/.zshrc</code> é‡Œ</p><figure class="highlight routeros"><table><tr><td class="code"><pre><span class="line"><span class="builtin-name">export</span> <span class="attribute">PATH</span>=<span class="string">"/usr/local/opt/e2fsprogs/bin:<span class="variable">$PATH</span>"</span></span><br><span class="line"><span class="builtin-name">export</span> <span class="attribute">PATH</span>=<span class="string">"/usr/local/opt/e2fsprogs/sbin:<span class="variable">$PATH</span>"</span></span><br></pre></td></tr></table></figure><p>é‡å¯ç»ˆç«¯æˆ–æ‰§è¡Œ <code>source ~/.zshrc</code> ç”Ÿæ•ˆ</p><p>ç°åœ¨å°±èƒ½æ‰§è¡Œ <code>mkfs.ext2</code> <code>mkfs.ext3</code> <code>mkfs.ext4</code> ç­‰å‘½ä»¤äº†</p><p>ç”¨æ³•ï¼š</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">mkfs.ext4 [-c|-l æ–‡ä»¶å] [-b å—å¤§å°] [-C ç°‡å¤§å°]</span><br><span class="line">    [-i æ¯inodeçš„å­—èŠ‚æ•°] [-I inodeå¤§å°] [-J æ—¥å¿—é€‰é¡¹]</span><br><span class="line">    [-G å¼¹æ€§ç»„å¤§å°] [-N inodeæ•°] [-d æ ¹ç›®å½•]</span><br><span class="line">    [-m ä¿ç•™å—æ‰€å ç™¾åˆ†æ¯”] [-o åˆ›å§‹ç³»ç»Ÿå]</span><br><span class="line">    [-g æ¯ç»„çš„å—æ•°] [-L å·æ ‡] [-M ä¸Šä¸€æ¬¡æŒ‚è½½ç‚¹]</span><br><span class="line">    [-O ç‰¹æ€§[,...]] [-r æ–‡ä»¶ç³»ç»Ÿç‰ˆæœ¬] [-E æ‰©å±•é€‰é¡¹[,...]]</span><br><span class="line">    [-t æ–‡ä»¶ç³»ç»Ÿç±»å‹] [-T ç”¨æ³•ç±»å‹] [-U UUID] [-e é”™è¯¯è¡Œä¸º][-z æ’¤é”€æ–‡ä»¶]</span><br><span class="line">    [-jnqvDFKSV] è®¾å¤‡ [å—æ•°]</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨ <code>diskutil list</code> æŸ¥çœ‹åˆ†åŒºï¼Œä¾‹å¦‚æˆ‘æƒ³è¦æ ¼å¼åŒ–ä¸º ext4 çš„åˆ†åŒºæ˜¯ <code>disk3s1</code></p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo mkfs.ext4 /dev/disk3s1</span><br></pre></td></tr></table></figure><h3 id="æŒ‚è½½-EXT-åˆ†åŒº"><a href="#æŒ‚è½½-EXT-åˆ†åŒº" class="headerlink" title="æŒ‚è½½ EXT åˆ†åŒº"></a>æŒ‚è½½ EXT åˆ†åŒº</h3><p>ä½¿ç”¨ <code>diskutil list</code> æŸ¥çœ‹åˆ†åŒºï¼Œä¾‹å¦‚æˆ‘æœ‰ä¸ª Ext4 åˆ†åŒºæ˜¯ <code>disk3s1</code></p><p>é‚£ä¹ˆå‘½ä»¤æ˜¯è¿™æ ·çš„</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">mkdir ~/Desktop/DISK</span><br><span class="line">sudo mount -t fuse-ext2 /dev/disk3s1 ~/Desktop/DISK</span><br></pre></td></tr></table></figure><p>è¿™æ ·å°±æŒ‚è½½ä¸Šäº†</p><p>å¸è½½è¿™ä¸ªåˆ†åŒºçš„å‘½ä»¤å¼æ˜¯ <code>sudo umount /dev/disk3s1</code></p><h2 id="ç»“è¯­"><a href="#ç»“è¯­" class="headerlink" title="ç»“è¯­"></a>ç»“è¯­</h2><p>å¹³å¸¸è¿™äº›æŒ‚è½½å·¥å…·ç”¨çš„ç¡®å®ä¸æ˜¯å¾ˆå¤šï¼Œä½†æ˜¯éœ€è¦ç”¨çš„æ—¶å€™ï¼Œåˆå¾ˆæ— å¥ˆï¼Œæ‰€ä»¥ç›´æ¥å†™ä¸ªç¬”è®°è®°å½•ä¸€ä¸‹ï¼Œä»¥åè¦ç”¨çš„æ—¶å€™æ–¹ä¾¿äº›</p><blockquote><p>æœ¬æ–‡ç« å‘è¡¨äºåº•å™ªåšå®¢ <a href="https://zhih.me">https://zhih.me</a> , è½¬è½½è¯·æ³¨æ˜</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> æ•™ç¨‹ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> MacOS </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>WEBæ˜¯å¦‚ä½•å·¥ä½œçš„</title>
      <link href="/how-the-web-works/"/>
      <url>/how-the-web-works/</url>
      
        <content type="html"><![CDATA[<h2 id="å¼•è¨€"><a href="#å¼•è¨€" class="headerlink" title="å¼•è¨€"></a>å¼•è¨€</h2><p>æœ¬æ¥å¾ˆçŠ¹è±«æ˜¯å¦è¦å†™ä¸€ä¸‹è¿™ç¯‡æ–‡ç« çš„ï¼Œæ¯•ç«Ÿè‡ªå·±çŸ¥ä¹‹ç”šå°‘ï¼Œè¯´äº›æµ…çš„çŸ¥è¯†è¿˜è¡Œï¼Œä¸€æ—¦æ·±å…¥ï¼Œå°±ä¼šæ¼äº†é©¬è„šã€‚ä½†æ˜¯ï¼Œå¦ä¸€æ–¹é¢æƒ³ï¼Œæ—¢ç„¶çŸ¥é“è‡ªå·±æ‡‚çš„ä¸å¤Ÿï¼Œå°±æ›´åº”è¯¥æŠŠçŸ¥é“çš„ç»™æ¢³ç†å‡ºæ¥ï¼Œä¹Ÿå¥½è¿›è¡Œä¸‹ä¸€æ­¥çš„å­¦ä¹ ã€‚æ‰€ä»¥è¿™ç¯‡æ–‡ç« ä¹Ÿç®—æ˜¯å¯¹å½“å‰æ‰€å­¦æ‰€çŸ¥è¿›è¡Œä¸€ä¸ªæ€»ç»“å§ï¼Œé›ğŸ˜‚ã€‚</p><h2 id="ç®€è§£"><a href="#ç®€è§£" class="headerlink" title="ç®€è§£"></a>ç®€è§£</h2><p>å…ˆä¸Šä¸€ä¸ªå¤§æ¦‚çš„å›¾è§£</p><p><img src="https://pic.zhih.me/blog/posts/how-the-web-works/è¿‡ç¨‹å›¾è§£.jpg" alt="è¿‡ç¨‹å›¾è§£"></p><p>ä¸Šå›¾ç®€å•çš„è§£é‡Šäº†æ‰“å¼€ä¸€ä¸ªç½‘é¡µçš„è¿‡ç¨‹ï¼Œç¨å¾®è¯¦ç»†çš„è§£é‡Šå°±æ˜¯ï¼š</p><ol><li><p>æµè§ˆå™¨å¾—åˆ°ç½‘å€ï¼Œå¹¶æŠŠç½‘å€æ‹†è§£ä¸ºåŸŸåå’Œè·¯å¾„<br><img src="https://pic.zhih.me/blog/posts/how-the-web-works/ç®€è§£url.jpg" alt="URL"></p></li><li><p>æµè§ˆå™¨å¯»æ‰¾åŸŸåå¯¹åº”çš„ IP</p><ul><li>å…ˆåœ¨æµè§ˆå™¨è‡ªå·±çš„ç¼“å­˜é‡Œæ‰¾ï¼Œå¦‚æœä¹‹å‰è®¿é—®è¿‡ï¼Œä¼šæœ‰ç¼“å­˜</li><li>å¦‚æœæ²¡æœ‰ç¼“å­˜ï¼Œåˆ™è®©æ‰‹æœºæˆ–ç”µè„‘å‘ DNS æœåŠ¡å™¨è¯·æ±‚è·å–</li></ul></li><li><p>æµè§ˆå™¨å‘æœåŠ¡å™¨è¯·æ±‚æ•°æ®</p></li><li><p>æœåŠ¡å™¨è§£æè¯·æ±‚ï¼Œå¾—åˆ°è¯·æ±‚çš„è·¯å¾„å‚æ•°ç­‰</p><ul><li>å¦‚æœæ˜¯é™æ€é¡µé¢ï¼Œç›´æ¥æ‰¾åˆ°å¯¹åº”çš„é™æ€æ–‡ä»¶</li><li>å¦‚æœæ˜¯åŠ¨æ€é¡µé¢ï¼Œè°ƒç”¨åŠ¨æ€è¯­è¨€å¤„ç†æ•°æ®åˆæˆé¡µé¢ï¼Œå†äº¤ç»™ HTTP æœåŠ¡å™¨</li></ul></li><li><p>æœåŠ¡å™¨æŠŠé¡µé¢å‘å›æµè§ˆå™¨</p></li><li><p>æµè§ˆå™¨å¾—åˆ°æ•°æ®ï¼Œè¿›è¡Œè§£æã€æ¸²æŸ“ã€è¾“å‡º</p></li></ol><p>æœ€ç»ˆå°±çœ‹åˆ°äº†ç½‘é¡µã€‚</p><hr><p>ä»ä¸Šé¢çš„ç®€è§£æˆ‘ä»¬å¯ä»¥çŸ¥é“ï¼Œè®¿é—®çš„è¿‡ç¨‹å¤§æ¦‚å¯åˆ†ä¸ºï¼šURLï¼ŒDNS æŸ¥è¯¢ï¼ŒHTTPï¼Œæµè§ˆå™¨ï¼Œè¿™å››ä¸ªéƒ¨åˆ†ã€‚</p><h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><blockquote><p>URL æ˜¯ Uniform Resource Locator çš„ç®€å†™ï¼Œä¸­æ–‡ï¼šç»Ÿä¸€èµ„æºå®šä½ç¬¦ï¼Œåœ¨ web ä¸­å¾ˆå¤šæ—¶å€™è¢«å«åš â€˜ç½‘å€â€™ã€‚</p></blockquote><p>URL çš„æ ‡å‡†æ ¼å¼å¦‚ä¸‹ï¼š</p><figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">åè®®:[<span class="string">//åœ°å€[:ç«¯å£</span>]][<span class="string">/è·¯å¾„</span>]æ–‡ä»¶[<span class="string">?æ•°æ®</span>][<span class="symbol">#é”šç‚¹</span>]</span><br><span class="line"></span><br><span class="line"><span class="bullet">- </span>åè®®ï¼š åœ¨ web ä¸­é€šå¸¸ä½¿ç”¨ httpï¼Œhttps</span><br><span class="line"><span class="bullet">- </span>åœ°å€ï¼š åŸŸåæˆ–è€… IP åœ°å€</span><br><span class="line"><span class="bullet">- </span>ç«¯å£ï¼š é»˜è®¤æƒ…å†µä¸‹ï¼Œhttp ä½¿ç”¨ 80 ç«¯å£ã€https ä½¿ç”¨ 443 ç«¯å£çš„æ—¶å€™ï¼Œå¯ä»¥çœç•¥</span><br><span class="line"><span class="bullet">- </span>è·¯å¾„ï¼š è¦è®¿é—®èµ„æºæ‰€åœ¨çš„ç›®å½•</span><br><span class="line"><span class="bullet">- </span>æ–‡ä»¶ï¼š å½“è¯·æ±‚çš„æ˜¯å…·ä½“ä¸€ä¸ªæ–‡ä»¶æ—¶ï¼Œæ¯”å¦‚ä¸€å¼ å›¾ç‰‡ï¼Œéœ€è¦å†™æ¸…æ¥šï¼Œå¦åˆ™ç”±æœåŠ¡å™¨å†³å®šè¿”å›è®¾ç½®çš„æ–‡ä»¶ï¼Œä¸€èˆ¬æ˜¯ <span class="code">`index.html`</span></span><br><span class="line"><span class="bullet">- </span>æ•°æ®ï¼š ? åå†™ GET è¯·æ±‚çš„å‚æ•°ï¼Œæ¯ä¸ªå‚æ•°ä»¥ &amp; éš”å¼€ï¼Œå†ä»¥ = åˆ†å¼€å‚æ•°åç§°ä¸æ•°æ®</span><br><span class="line"><span class="bullet">- </span>é”šç‚¹ï¼š # åé¢çš„æ•°æ®ä¸ä¼šè¢«å‘é€åˆ°æœåŠ¡å™¨ï¼Œå®ƒä»£è¡¨ç½‘é¡µä¸­çš„ä¸€ä¸ªä½ç½®</span><br></pre></td></tr></table></figure><p><strong>å‘ç”Ÿäº†ä»€ä¹ˆ</strong></p><p>æµè§ˆå™¨è·å–åˆ°ç”¨æˆ·è¾“å…¥çš„ URLï¼Œå°±æŒ‰ç…§ä»¥ä¸Šæ ¼å¼è¿›è¡Œè§£æï¼Œå¦‚æœä¸ç¬¦åˆæ ‡å‡†æ ¼å¼ï¼Œåˆ™ä¼šåˆ¤æ–­ä¸ºç”¨æˆ·è¾“å…¥äº†å…³é”®å­—ï¼Œå¹¶è·³è½¬åˆ°æœç´¢å¼•æ“æœç´¢ï¼Œå½“ URL ä¸­å­˜åœ¨ä¸æ˜¯ ASCII çš„å­—ç¬¦ä¸²æ—¶ï¼Œä¼šæŠŠå­—ç¬¦ä¸²è½¬æˆ <a href="https://en.wikipedia.org/wiki/Punycode" target="_blank" rel="noopener">punycode</a> æ ‡å‡†ç¼–ç çš„å­—ç¬¦ä¸²ã€‚</p><p>è·å–åˆ°åŸŸååï¼Œæµè§ˆå™¨é¦–å…ˆä¼šåœ¨æµè§ˆå™¨çš„ç¼“å­˜ä¸­æŸ¥æ‰¾ä¸å®ƒç›¸å…³çš„èµ„æºï¼Œæ¯”å¦‚ DNS ç¼“å­˜ã€é™æ€èµ„æºç¼“å­˜</p><p>æµè§ˆå™¨çš„ DNS ç¼“å­˜ä¼šæŠŠä¹‹å‰è®¿é—®è¿‡çš„åŸŸåå¯¹åº” IP ç¼“å­˜èµ·æ¥ï¼Œæ–¹ä¾¿ä¸‹æ¬¡ä½¿ç”¨ï¼Œä¸€èˆ¬ä¼šä¿å­˜ TTL(DNS æœåŠ¡å™¨ä¸Šç¼“å­˜æ—¶é—´)ã€Expires(æµè§ˆå™¨è®°å½•çš„åˆ°æœŸæ—¶é—´)</p><p><strong>å¦‚æœæ²¡æœ‰ç¼“å­˜</strong>ï¼Œåˆ™è¿›è¡Œä¸‹ä¸€æ­¥ï¼ŒDNS æŸ¥è¯¢</p><h2 id="DNS-æŸ¥è¯¢"><a href="#DNS-æŸ¥è¯¢" class="headerlink" title="DNS æŸ¥è¯¢"></a>DNS æŸ¥è¯¢</h2><blockquote><p>DNS æŸ¥è¯¢å°±æ˜¯æŠŠç½‘å€ç¿»è¯‘æˆ IP åœ°å€ã€‚</p></blockquote><p>æ¯”æ–¹è¯´ä½ çš„ç”µè„‘ä¸çŸ¥é“ <a href="http://www.zhih.me" target="_blank" rel="noopener">www.zhih.me</a> è¿™ä¸ªåŸŸåçš„ IP åœ°å€ï¼Œä»–å°±ä¼šå‘ DNS æœåŠ¡å™¨å‘é€ä¸ªè¯·æ±‚ï¼Œè®© DNS æœåŠ¡å™¨å¸®ä»–å¯»æ‰¾ï¼Œæ­¤æ—¶ä½ çš„ç”µè„‘å°±æ˜¯ä¸€ä¸ª DNS å®¢æˆ·ç«¯ï¼Œå®é™…ä¸Šæ•´ä¸ªå…·ä½“è¿‡ç¨‹ä¼šæœ‰ä¸åŒçš„æƒ…å†µã€‚</p><h3 id="åŸŸåçš„ç»“æ„"><a href="#åŸŸåçš„ç»“æ„" class="headerlink" title="åŸŸåçš„ç»“æ„"></a>åŸŸåçš„ç»“æ„</h3><p>æƒ³è¦ç†è§£ DNS æŸ¥è¯¢è¿‡ç¨‹ï¼Œè¿˜å¾—å…ˆçŸ¥é“åŸŸåçš„ç»“æ„ã€‚</p><p>ä»¥ <a href="http://www.zhih.me" target="_blank" rel="noopener">www.zhih.me</a> è¿™ä¸ªåŸŸåä¸ºä¾‹ï¼Œå®ƒæ˜¯ä¸ªå…¨ç§°åŸŸåï¼ˆFQDNï¼‰</p><p>å½“ä½ çœ‹åˆ°å®ƒæ—¶ï¼Œåº”å½“ä»å³å¾€å·¦è¯»</p><p><img src="https://pic.zhih.me/blog/posts/how-the-web-works/domain1.jpg" alt="domain1"></p><p>è€Œæ•´ä¸ªåŸŸåç³»ç»Ÿçš„ç»“æ„æ˜¯è¿™æ ·çš„</p><p><img src="https://pic.zhih.me/blog/posts/how-the-web-works/domain2.jpg" alt="domain2"></p><p>æ ¹åŸŸï¼šå‚¨å­˜äº†è´Ÿè´£æ¯ä¸ªåŸŸï¼ˆå¦‚comã€cnã€meç­‰ï¼‰çš„è§£æçš„åŸŸåæœåŠ¡å™¨çš„åœ°å€ä¿¡æ¯</p><p>é¡¶çº§åŸŸå(TLD)ï¼šåˆ†ä¸ºé€šç”¨ã€å›½å®¶ã€èµåŠ©å’Œåœ°ç†å‡ ç§ç±»å‹ï¼Œç”¨äºè¡¨ç¤ºæŸäº›ç»„ç»‡æˆ–ç”¨é€”</p><p>äºŒçº§åŸŸå(SLD)ï¼šè¡¨ç¤ºç»„ç»‡ã€ä¸ªäººã€ç‰¹å®šæ„ä¹‰çš„åç§°</p><p>ä¸‰çº§åŸŸåï¼šä¾‹å¦‚ï¼š<code>sina.com.cn</code>ï¼Œsina æ˜¯ä¸€ä¸ªä¸‰çº§åŸŸåï¼ŒåŒæ—¶åˆæ˜¯ <code>com.cn</code> çš„å­åŸŸå</p><p>å­åŸŸåï¼šå­åŸŸåä¸ä¸‰çº§åŸŸåä¸åŒï¼Œä¾‹å¦‚ï¼š<code>www.zhih.me</code>ï¼Œwww æ˜¯ <code>zhih.me</code> çš„å­åŸŸåï¼Œä½†å´ä¸æ˜¯ä¸‰çº§åŸŸå</p><h3 id="DNS-æŸ¥è¯¢è¿‡ç¨‹"><a href="#DNS-æŸ¥è¯¢è¿‡ç¨‹" class="headerlink" title="DNS æŸ¥è¯¢è¿‡ç¨‹"></a>DNS æŸ¥è¯¢è¿‡ç¨‹</h3><p><strong>æœ¬åœ°è§£æ</strong></p><ol><li>æŸ¥çœ‹ HOSTS è®°å½•ï¼Œå¦‚æœæœ‰ï¼Œç›´æ¥è¿”å›ç»“æœ</li><li>æŸ¥çœ‹ DNS ç¼“å­˜ï¼Œçœ‹çœ‹å®ƒé‡Œé¢æ˜¯ä¸æ˜¯æœ‰ä½ è®¾ç½®çš„åŸŸå IP åœ°å€ï¼Œç¼“å­˜ä¿¡æ¯æ˜¯é€šè¿‡ä»¥å‰çš„æŸ¥è¯¢è·å¾—çš„ï¼Œç”µè„‘å…³æœºæ—¶ç¼“å­˜å°†ä¼šè¢«æ¸…ç©º</li></ol><p><strong>ç›´æ¥è§£æ</strong></p><p>æœ¬åœ°æ‰¾ä¸åˆ°ï¼Œå°±å‘ä½ ç”µè„‘é‡Œè®¾ç½®çš„ DNS æœåŠ¡å™¨è¯·æ±‚ï¼Œå¦‚æœæ²¡æœ‰è®¾ç½®å…·ä½“çš„åœ°å€ï¼Œè€Œæ˜¯è‡ªåŠ¨è·å–ï¼Œå°±ä¼šä» ISP ä¸­è·å– DNS æœåŠ¡å™¨çš„ IP åœ°å€ï¼Œæˆ‘è‡ªå·±ä½¿ç”¨çš„æ˜¯è…¾è®¯çš„ DNS æœåŠ¡å™¨ï¼Œæˆ‘ä»¬ä¸€èˆ¬æŠŠå®ƒå«åšæœ¬åœ° DNS æœåŠ¡å™¨</p><p><img src="https://pic.zhih.me/blog/posts/how-the-web-works/dnsquery-1.jpg" alt="dnsquery-1"></p><p>å½“æœ¬åœ° DNS æœåŠ¡å™¨æ‰¾ä¸åˆ°ç»“æœæ—¶ï¼Œå°±éœ€è¦è·Ÿå…¶ä»– DNS æœåŠ¡å™¨æŸ¥è¯¢è·å–</p><p><strong>å®Œæ•´è§£æè¿‡ç¨‹</strong></p><p><img src="https://pic.zhih.me/blog/posts/how-the-web-works/dnsquery-2.jpg" alt="dnsquery-2"></p><p>è¿™ä¸ªè¿‡ç¨‹å¯ä»¥ä½¿ç”¨ dig å‘½ä»¤æŸ¥çœ‹</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">dig www.zhih.me +trace</span><br></pre></td></tr></table></figure><p>è¿™æ ·ï¼Œç”µè„‘å°±æ‹¿åˆ°åŸŸåå¯¹åº”çš„ IP åœ°å€äº†</p><h2 id="HTTP"><a href="#HTTP" class="headerlink" title="HTTP"></a>HTTP</h2><p>å…³äºæ˜¯ä»€ä¹ˆï¼Œåœ¨ç»´åŸºç™¾ç§‘å·²ç»å†™çš„å¾ˆè¯¦ç»†äº†ï¼Œè‡ªå·±çœ‹çœ‹å§</p><p><a href="https://en.wikipedia.org/wiki/Hypertext_Transfer_Protocol" target="_blank" rel="noopener">https://en.wikipedia.org/wiki/Hypertext_Transfer_Protocol</a></p><p>å‰é¢æˆ‘ä»¬å·²ç»æ‰¾åˆ°äº† IPï¼Œé‚£ä¹ˆç°åœ¨æˆ‘ä»¬å°±è¦å‘é€è¯·æ±‚å’Œæ¥æ”¶å“åº”äº†</p><h3 id="è¯·æ±‚æ–¹æ³•"><a href="#è¯·æ±‚æ–¹æ³•" class="headerlink" title="è¯·æ±‚æ–¹æ³•"></a>è¯·æ±‚æ–¹æ³•</h3><table><thead><tr><th>æ–¹æ³•</th><th>æè¿°</th></tr></thead><tbody><tr><td>GET</td><td>è¯·æ±‚æŒ‡å®šçš„é¡µé¢ä¿¡æ¯ï¼Œå¹¶è¿”å›å®ä½“ä¸»ä½“</td></tr><tr><td>HEAD</td><td>ç±»ä¼¼äºgetè¯·æ±‚ï¼Œåªä¸è¿‡è¿”å›çš„å“åº”ä¸­æ²¡æœ‰å…·ä½“çš„å†…å®¹ï¼Œç”¨äºè·å–æŠ¥å¤´</td></tr><tr><td>POST</td><td>å‘æŒ‡å®šèµ„æºæäº¤æ•°æ®è¿›è¡Œå¤„ç†è¯·æ±‚ï¼ˆä¾‹å¦‚æäº¤è¡¨å•æˆ–è€…ä¸Šä¼ æ–‡ä»¶ï¼‰ã€‚æ•°æ®è¢«åŒ…å«åœ¨è¯·æ±‚ä½“ä¸­ã€‚POSTè¯·æ±‚å¯èƒ½ä¼šå¯¼è‡´æ–°çš„èµ„æºçš„å»ºç«‹å’Œ/æˆ–å·²æœ‰èµ„æºçš„ä¿®æ”¹</td></tr><tr><td>PUT</td><td>ä»å®¢æˆ·ç«¯å‘æœåŠ¡å™¨ä¼ é€çš„æ•°æ®å–ä»£æŒ‡å®šçš„æ–‡æ¡£çš„å†…å®¹</td></tr><tr><td>DELETE</td><td>è¯·æ±‚æœåŠ¡å™¨åˆ é™¤æŒ‡å®šçš„é¡µé¢</td></tr><tr><td>CONNECT</td><td>HTTP/1.1åè®®ä¸­é¢„ç•™ç»™èƒ½å¤Ÿå°†è¿æ¥æ”¹ä¸ºç®¡é“æ–¹å¼çš„ä»£ç†æœåŠ¡å™¨</td></tr><tr><td>OPTIONS</td><td>å…è®¸å®¢æˆ·ç«¯æŸ¥çœ‹æœåŠ¡å™¨çš„æ€§èƒ½ã€‚</td></tr><tr><td>TRACE</td><td>å›æ˜¾æœåŠ¡å™¨æ”¶åˆ°çš„è¯·æ±‚ï¼Œä¸»è¦ç”¨äºæµ‹è¯•æˆ–è¯Šæ–­</td></tr></tbody></table><h3 id="HTTP-çŠ¶æ€ç "><a href="#HTTP-çŠ¶æ€ç " class="headerlink" title="HTTP çŠ¶æ€ç "></a>HTTP çŠ¶æ€ç </h3><blockquote><p>HTTPçŠ¶æ€ç ï¼ˆHTTP Status Codeï¼‰æ˜¯ç”¨ä»¥è¡¨ç¤ºç½‘é¡µæœåŠ¡å™¨HTTPå“åº”çŠ¶æ€çš„3ä½æ•°å­—ä»£ç ã€‚å®ƒç”± RFC 2616 è§„èŒƒå®šä¹‰çš„ï¼Œå¹¶å¾—åˆ°RFC 2518ã€RFC 2817ã€RFC 2295ã€RFC 2774ã€RFC 4918ç­‰è§„èŒƒæ‰©å±•ã€‚</p></blockquote><p>åº”è¯¥æ¯ä¸ªç½‘æ°‘éƒ½ä¸é™Œç”Ÿï¼Œæˆ–å¤šæˆ–å°‘é‡åˆ°è¿‡ 404 not fount</p><p>çŠ¶æ€ç æœ‰ç›¸å½“å¤šï¼Œåœ¨è¿™é‡Œæˆ‘å°±åˆ—å‡ºä»–ä»¬çš„åˆ†ç±»</p><table><thead><tr><th>ç±»å‹</th><th>ç±»åˆ«</th><th>æè¿°</th></tr></thead><tbody><tr><td>1xx</td><td>ä¿¡æ¯</td><td>è¯·æ±‚å·²è¢«æ¥å—ï¼Œéœ€è¦ç»§ç»­å¤„ç†</td></tr><tr><td>2xx</td><td>æˆåŠŸ</td><td>æ“ä½œè¢«æˆåŠŸæ¥æ”¶å¹¶å¤„ç†</td></tr><tr><td>3xx</td><td>é‡å®šå‘</td><td>éœ€è¦å®¢æˆ·ç«¯é‡‡å–è¿›ä¸€æ­¥çš„æ“ä½œæ‰èƒ½å®Œæˆè¯·æ±‚</td></tr><tr><td>4xx</td><td>å®¢æˆ·ç«¯é”™è¯¯</td><td>è¯·æ±‚çš„å‚æ•°é”™è¯¯æˆ–æ— æ³•å®Œæˆè¯·æ±‚</td></tr><tr><td>5xx</td><td>æœåŠ¡å™¨é”™è¯¯</td><td>æœåŠ¡å™¨åœ¨å¤„ç†è¯·æ±‚çš„è¿‡ç¨‹ä¸­æœ‰é”™è¯¯æˆ–è€…å¼‚å¸¸</td></tr></tbody></table><h3 id="HTTP-æ¶ˆæ¯ç»“æ„"><a href="#HTTP-æ¶ˆæ¯ç»“æ„" class="headerlink" title="HTTP æ¶ˆæ¯ç»“æ„"></a>HTTP æ¶ˆæ¯ç»“æ„</h3><p>åœ¨ shell ä¸­ä½¿ç”¨ <code>curl -v</code> å‘½ä»¤å°±å¯ä»¥çœ‹åˆ°è¯·æ±‚å’Œå“åº”çš„æ¶ˆæ¯äº†</p><p>ä»¥æœ€å¸¸ç”¨çš„ get è¯·æ±‚ä¸ºä¾‹ï¼š</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">curl -v https://mov.zhih.me/weapp/list/1/2</span><br></pre></td></tr></table></figure><p><img src="https://pic.zhih.me/blog/posts/how-the-web-works/res_req.jpg" alt="res_req.jpg"></p><h3 id="HTTP-è¯·æ±‚"><a href="#HTTP-è¯·æ±‚" class="headerlink" title="HTTP è¯·æ±‚"></a>HTTP è¯·æ±‚</h3><p>è¯·æ±‚æŠ¥æ–‡çš„ä¸€èˆ¬åŒ…æ‹¬ä»¥ä¸‹æ ¼å¼ï¼šè¯·æ±‚è¡Œã€è¯·æ±‚å¤´éƒ¨ã€ç©ºè¡Œå’Œè¯·æ±‚æ•°æ®</p><figure class="highlight hsp"><table><tr><td class="code"><pre><span class="line">GET /weapp/list/<span class="number">1</span>/<span class="number">2</span> HTTP/<span class="number">2</span></span><br><span class="line"><span class="comment">//è¯·æ±‚è¡Œ: è¯·æ±‚æ–¹æ³• è¯·æ±‚URI HTTPåè®®/åè®®ç‰ˆæœ¬</span></span><br><span class="line">Host: mov.zhih.me</span><br><span class="line"><span class="comment">//æœåŠ¡ç«¯çš„ä¸»æœºå</span></span><br><span class="line">user-agent:Mozilla/<span class="number">5.0</span> (Macintosh<span class="comment">; Intel Mac OS X 10_13_5) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/66.0.3359.139 Safari/537.36</span></span><br><span class="line"><span class="comment">//æµè§ˆå™¨ UA</span></span><br><span class="line">accept:text/html,application/xhtml+xml,application/xml<span class="comment">;q=0.9,image/webp,image/apng,*/*;q=0.8</span></span><br><span class="line"><span class="comment">//å®¢æˆ·ç«¯èƒ½æ¥æ”¶çš„mine</span></span><br><span class="line">accept-encoding: gzip, deflate, br</span><br><span class="line"><span class="comment">//æ˜¯å¦æ”¯æŒæµå‹ç¼©</span></span><br><span class="line"><span class="meta"># ç©ºè¡Œ</span></span><br><span class="line"><span class="meta"># è¯·æ±‚æ•°æ®</span></span><br></pre></td></tr></table></figure><p>è¯·æ±‚å¤´éƒ¨å°±æ˜¯è¯·æ±‚è¡Œå’Œç©ºè¡Œä¹‹é—´çš„é”®å€¼å¯¹</p><h3 id="HTTP-å“åº”"><a href="#HTTP-å“åº”" class="headerlink" title="HTTP å“åº”"></a>HTTP å“åº”</h3><p>å“åº”æŠ¥æ–‡ä¹Ÿç”±å››ä¸ªéƒ¨åˆ†ç»„æˆï¼Œåˆ†åˆ«æ˜¯ï¼šçŠ¶æ€è¡Œã€æ¶ˆæ¯æŠ¥å¤´ã€ç©ºè¡Œå’Œå“åº”æ­£æ–‡</p><figure class="highlight axapta"><table><tr><td class="code"><pre><span class="line">HTTP/<span class="number">2</span> <span class="number">200</span></span><br><span class="line"><span class="comment">//çŠ¶æ€è¡Œï¼šHTTPåè®®ç‰ˆæœ¬å·ï¼Œ çŠ¶æ€ç ï¼Œ çŠ¶æ€æ¶ˆæ¯</span></span><br><span class="line"><span class="keyword">server</span>: nginx/<span class="number">1.14</span><span class="number">.0</span></span><br><span class="line"><span class="comment">//web æœåŠ¡å™¨è½¯ä»¶ååŠç‰ˆæœ¬</span></span><br><span class="line"><span class="keyword">date</span>: Thu, <span class="number">17</span> May <span class="number">2018</span> <span class="number">14</span>:<span class="number">46</span>:<span class="number">50</span> GMT</span><br><span class="line"><span class="comment">//å‘é€æ—¶é—´</span></span><br><span class="line">content-type: application/json; charset=utf<span class="number">-8</span></span><br><span class="line"><span class="comment">//æœåŠ¡å™¨å‘é€ä¿¡æ¯çš„ç±»å‹</span></span><br><span class="line">content-length: <span class="number">589</span></span><br><span class="line"><span class="comment">//ä¸»ä½“å†…å®¹é•¿åº¦</span></span><br><span class="line"><span class="meta"># ç©ºè¡Œ </span></span><br><span class="line">&#123;<span class="string">"code"</span>:<span class="number">200</span>,<span class="string">"data"</span>:[&#123;<span class="string">"rank"</span>:<span class="number">1</span>,<span class="string">"movid"</span>:<span class="number">1292052</span>,<span class="string">"rating"</span>:<span class="number">9.6</span>,<span class="string">"title"</span>:<span class="string">"è‚–ç”³å…‹çš„æ•‘èµ"</span>,<span class="string">"genres"</span>:[<span class="string">"çŠ¯ç½ª"</span>,<span class="string">"å‰§æƒ…"</span>],<span class="string">"year"</span>:<span class="number">1994</span>,<span class="string">"directors"</span>:[<span class="string">"å¼—å…°å…‹Â·å¾·æ‹‰é‚¦ç‰¹"</span>],<span class="string">"casts"</span>:[<span class="string">"è’‚å§†Â·ç½—å®¾æ–¯"</span>,<span class="string">"æ‘©æ ¹Â·å¼—é‡Œæ›¼"</span>,<span class="string">"é²å‹ƒÂ·å†ˆé¡¿"</span>],<span class="string">"image"</span>:<span class="string">"https://img3.doubanio.com/view/photo/s_ratio_poster/public/p480747492.jpg"</span>&#125;,&#123;<span class="string">"rank"</span>:<span class="number">2</span>,<span class="string">"movid"</span>:<span class="number">1291546</span>,<span class="string">"rating"</span>:<span class="number">9.5</span>,<span class="string">"title"</span>:<span class="string">"éœ¸ç‹åˆ«å§¬"</span>,<span class="string">"genres"</span>:[<span class="string">"å‰§æƒ…"</span>,<span class="string">"çˆ±æƒ…"</span>,<span class="string">"åŒæ€§"</span>],<span class="string">"year"</span>:<span class="number">1993</span>,<span class="string">"directors"</span>:[<span class="string">"é™ˆå‡¯æ­Œ"</span>],<span class="string">"casts"</span>:[<span class="string">"å¼ å›½è£"</span>,<span class="string">"å¼ ä¸°æ¯…"</span>,<span class="string">"å·©ä¿"</span>],<span class="string">"image"</span>:<span class="string">"https://img3.doubanio.com/view/photo/s_ratio_poster/public/p1910813120.jpg"</span>&#125;]&#125;% </span><br><span class="line"><span class="comment">//å“åº”æ­£æ–‡</span></span><br></pre></td></tr></table></figure><h2 id="æœåŠ¡å™¨"><a href="#æœåŠ¡å™¨" class="headerlink" title="æœåŠ¡å™¨"></a>æœåŠ¡å™¨</h2><p>å‰é¢è¯´äº†æ•°æ®æ€ä¹ˆå‘é€åˆ°æœåŠ¡å™¨ï¼Œç°åœ¨è¯´è¯´æœåŠ¡å™¨å¦‚ä½•å¤„ç†æ”¶åˆ°çš„æ•°æ®</p><p>å½“ç„¶ï¼Œè¿™éƒ¨åˆ†çš„æƒ…å†µç›¸å½“å¤æ‚ï¼Œä¸åŒåœºæ™¯æœ‰ä¸åŒçš„æ–¹æ¡ˆï¼Œæˆ‘è¿™é‡Œåªç®€å•çš„ä¸¾äºŒä¸‰çš„ä¾‹å­</p><h3 id="é™æ€ç«™ç‚¹"><a href="#é™æ€ç«™ç‚¹" class="headerlink" title="é™æ€ç«™ç‚¹"></a>é™æ€ç«™ç‚¹</h3><p>æˆ‘çš„åšå®¢ zhih.me å°±æ˜¯ä¸ªé™æ€ç«™ç‚¹ï¼Œé€šè¿‡æ¨¡æ¿å¼•æ“æŠŠæ•°æ®æ¸²æŸ“æˆé™æ€ HTML æ–‡ä»¶ï¼Œè¿™äº›æ–‡ä»¶å°±å­˜åœ¨æœåŠ¡å™¨ä¸Šç­‰å¾…ä¸‹è½½ï¼Œæµè§ˆå™¨è·å–é¡µé¢å°±æ˜¯ä¸ªæ–‡ä»¶ä¸‹è½½çš„è¿‡ç¨‹ã€‚</p><ol><li>æµè§ˆå™¨å‘é€ HTTP è¯·æ±‚ï¼Œè¯·æ±‚é‡ŒåŒ…å«äº†æ–‡ä»¶çš„è·¯å¾„ã€ä¸»æœºåç­‰ä¿¡æ¯</li><li>æˆ‘çš„æœåŠ¡å™¨ç›‘å¬äº† 80 å’Œ 443 ç«¯å£ï¼Œå‘ç°æœ‰æ•°æ®ä¼ æ¥ï¼Œå°†è¯·æ±‚æŠ›ç»™è™šæ‹Ÿä¸»æœº</li><li>è™šæ‹Ÿä¸»æœºå‘ç°è¯·æ±‚çš„è·¯å¾„æ˜¯ â€˜/â€˜ï¼Œå°±æŠŠç½‘ç«™æ ¹ç›®å½•ä¸‹çš„ <code>index.html</code> è¿”å›ç»™è¯·æ±‚è€…</li></ol><h3 id="åŠ¨æ€ç«™ç‚¹"><a href="#åŠ¨æ€ç«™ç‚¹" class="headerlink" title="åŠ¨æ€ç«™ç‚¹"></a>åŠ¨æ€ç«™ç‚¹</h3><p>è¿™é‡Œè¯´çš„åŠ¨æ€ç«™ç‚¹ï¼ŒæŒ‡é¡µé¢æ˜¯ç”±åç«¯å¤„ç†æ•°æ®åˆæˆçš„</p><p>å¸¸è§çš„ä¾‹å­å°±æ˜¯ WordPressï¼ŒWP åº”è¯¥æ˜¯ç°åœ¨è¢«ä½¿ç”¨å¾—æœ€å¤šçš„ CMS äº†ï¼Œå®ƒçš„å¤„ç†è¿‡ç¨‹åº”è¯¥æ˜¯è¿™æ ·çš„</p><ol><li>æµè§ˆå™¨å‘é€ HTTP è¯·æ±‚ï¼Œè¯·æ±‚é‡ŒåŒ…å«äº†æ–‡ä»¶çš„è·¯å¾„ã€ä¸»æœºåç­‰ä¿¡æ¯</li><li>æˆ‘çš„æœåŠ¡å™¨ç›‘å¬äº† 80 å’Œ 443 ç«¯å£ï¼Œå‘ç°æœ‰æ•°æ®ä¼ æ¥ï¼Œå‘ç°æœ‰æ•°æ®ä¼ æ¥ï¼Œå°†è¯·æ±‚æŠ›ç»™è™šæ‹Ÿä¸»æœº</li><li>è™šæ‹Ÿä¸»æœºå‘ç°è¯·æ±‚çš„è·¯å¾„æ˜¯ â€˜/â€˜ï¼Œè€Œ â€˜/â€˜ è¿™ä¸ªè·¯å¾„å·²ç»æŒ‡å®šäº† PHP å¤„ç†ï¼Œäºæ˜¯æŠŠè¯·æ±‚æŠ›ç»™äº† <code>index.php</code> å¤„ç†</li><li>WP è§£æè¯·æ±‚é‡Œçš„æ•°æ®ï¼Œçœ‹çœ‹æœ‰ä»€ä¹ˆå‚æ•°ï¼Œä½ è®¿é—®çš„æ˜¯é¦–é¡µï¼Œä¹Ÿæ²¡å¸¦ä»€ä¹ˆå‚æ•°ï¼Œäºæ˜¯ WP å°±ä»æ•°æ®åº“é‡ŒæŠŠé¦–é¡µçš„æ–‡ç« è°ƒå‡ºæ¥ï¼Œç„¶ååœ¨ PHP é‡Œéå†åˆæˆ HTML æ–‡ä»¶ï¼Œå¹¶äº¤ç»™è™šæ‹Ÿä¸»æœº</li><li>è™šæ‹Ÿä¸»æœºæŠŠ HTML é¡µé¢è¿”å›ç»™è¯·æ±‚è€…</li></ol><h3 id="å‰ååˆ†ç¦»ç«™ç‚¹"><a href="#å‰ååˆ†ç¦»ç«™ç‚¹" class="headerlink" title="å‰ååˆ†ç¦»ç«™ç‚¹"></a>å‰ååˆ†ç¦»ç«™ç‚¹</h3><p>å‰ååˆ†ç¦»æ˜¯ç°åœ¨å’Œæœªæ¥çš„è¶‹åŠ¿ï¼Œå¤§å¤šæ•° WebApp éƒ½æ˜¯è¿™ç§æ¶æ„ï¼Œç®€å•è¯´å°±æ˜¯ä½¿ç”¨ AJAX è·å–æ•°æ®åœ¨å®¢æˆ·ç«¯è¿›è¡Œæ¸²æŸ“ã€‚</p><ol><li>è·å–é™æ€èµ„æºï¼ˆé™æ€ç«™ç‚¹çš„æ•´ä¸ªè¿‡ç¨‹ï¼‰ï¼ŒJS è·‘èµ·æ¥åå¼€å§‹è¯·æ±‚æ•°æ®</li><li>åç«¯ç¨‹åºè·å–è¯·æ±‚ï¼Œè§£æè¯·æ±‚æ•°æ®ï¼Œä»æ•°æ®åº“é‡Œæå–æ•°æ®ï¼Œè¿”å›æ•°æ®</li><li>å‰ç«¯ç¨‹åºå¾—åˆ°æ•°æ®ï¼Œéå†æ•°æ®ï¼Œæ¸²æŸ“é¡µé¢</li></ol><h2 id="æµè§ˆå™¨"><a href="#æµè§ˆå™¨" class="headerlink" title="æµè§ˆå™¨"></a>æµè§ˆå™¨</h2><p>å‰é¢æˆ‘ä»¬å°±æ˜¯ä»æµè§ˆå™¨å¼€å§‹çš„ï¼Œç°åœ¨åˆå›åˆ°äº†æµè§ˆå™¨ï¼Œæµè§ˆå™¨æ˜¯ä¸ªå¸¸ç”¨ä¸”çœ‹ä¼¼ç®€å•çš„è½¯ä»¶ï¼Œä½†æ˜¯è®²çœŸï¼ŒåŸç†çœŸçš„æŒºå¤æ‚çš„ï¼Œæˆ‘è¿™é‡Œåªèƒ½è¯´è¯´è§£æå’Œæ¸²æŸ“ç›¸å…³çš„ä¸€ç‚¹ç‚¹çš®æ¯›çŸ¥è¯†ï¼Œå¦‚æœ‰é”™è¯¯æ¬¢è¿æ–§æ­£ã€‚</p><p>æ‰“å¼€æµè§ˆå™¨å¼€å‘è€…å·¥å…·ï¼Œè®¿é—®ä¸€ä¸ªç½‘é¡µï¼Œæˆ‘ä»¬å°†çœ‹åˆ°ä»¥ä¸‹ä¿¡æ¯</p><p><img src="https://pic.zhih.me/blog/posts/how-the-web-works/chrome.jpg" alt="chrome"></p><p>åŸºæœ¬è¿‡ç¨‹æ˜¯è¿™æ ·çš„ï¼š</p><figure class="highlight clean"><table><tr><td class="code"><pre><span class="line">åŠ è½½ HTML -&gt; è§£æ HTML -&gt; æ„å»º DOM æ ‘ -&gt; æ„å»º CSSOM æ ‘ -&gt; æ„å»ºæ¸²æŸ“æ ‘ -&gt; å¸ƒå±€ã€ç»˜åˆ¶</span><br></pre></td></tr></table></figure><p><strong>ä½†æ˜¯</strong>ï¼Œç°ä»£æµè§ˆå™¨ä¸ºäº†æ›´å¿«çš„æ˜¾ç¤ºé¡µé¢ï¼Œå¾ˆå¤šä»»åŠ¡éƒ½æ˜¯åŒæ—¶è¿›è¡Œçš„ï¼Œä¼šä¸€è¾¹è§£æ HTMLï¼Œä¸€è¾¹ä¸‹è½½å¤–éƒ¨èµ„æºï¼Œè¿˜ä¸€è¾¹è¿›è¡Œæ¸²æŸ“ã€‚</p><h3 id="è§£æ-HTML-å¹¶æ„å»º-DOM-æ ‘"><a href="#è§£æ-HTML-å¹¶æ„å»º-DOM-æ ‘" class="headerlink" title="è§£æ HTML å¹¶æ„å»º DOM æ ‘"></a>è§£æ HTML å¹¶æ„å»º DOM æ ‘</h3><p>æµè§ˆå™¨è‡ªä¸Šè€Œä¸‹çš„è§£æ HTML æ–‡æ¡£ï¼Œå¹¶åœ¨è§£æçš„åŒæ—¶æ„å»º DOMï¼ˆæ–‡æ¡£å¯¹è±¡æ¨¡å‹ï¼‰ æ ‘ï¼ŒDOM æ ‘é‡Œæœ‰å„ä¸ªæ ‡ç­¾çš„å±æ€§å’Œå®ƒä»¬ä¹‹é—´çš„å…³ç³»</p><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">true<span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">"viewport"</span> <span class="attr">content</span>=<span class="string">"width=device-width,initial-scale=1"</span>&gt;</span></span><br><span class="line">true<span class="tag">&lt;<span class="name">link</span> <span class="attr">href</span>=<span class="string">"style.css"</span> <span class="attr">rel</span>=<span class="string">"stylesheet"</span>&gt;</span></span><br><span class="line">true<span class="tag">&lt;<span class="name">title</span>&gt;</span>Critical Path<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">true<span class="tag">&lt;<span class="name">p</span>&gt;</span>Hello <span class="tag">&lt;<span class="name">span</span>&gt;</span>web performance<span class="tag">&lt;/<span class="name">span</span>&gt;</span> students!<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">true<span class="tag">&lt;<span class="name">div</span>&gt;</span><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">"awesome-photo.jpg"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><p>è§£é‡Šå™¨æ·±åº¦éå† HTML æ–‡æ¡£ï¼ŒæŠŠ <code>&lt;html&gt;</code> <code>&lt;head&gt;</code> <code>&lt;body&gt;</code> è¿™äº›æ ‡ç­¾æŒ‰ç…§ W3C æ ‡å‡†ï¼Œè½¬æ¢æˆ â€œå®šä¹‰å®ƒå±æ€§å’Œè§„åˆ™çš„å¯¹è±¡â€™â€ï¼Œç„¶åå°†è¿™äº› â€œå¯¹è±¡â€ é“¾æ¥åœ¨æ ‘å½¢ç»“æ„é‡Œï¼Œè¿™å°±æ˜¯ DOM æ ‘</p><p><img src="https://pic.zhih.me/blog/posts/how-the-web-works/dom-tree.png" alt="dom-tree"></p><p>åœ¨ä»¥ä¸Š HTML ç»“æ„ä¾‹å­ä¸­ï¼Œ<code>&lt;p&gt;</code> å’Œ <code>&lt;div&gt;</code> æ˜¯å…„å¼ŸèŠ‚ç‚¹ï¼Œåœ¨ DOM æ ‘çš„æ„å»ºè¿‡ç¨‹ä¸­ï¼Œå½“å‰èŠ‚ç‚¹æ‰€æœ‰çš„å­èŠ‚ç‚¹å…¨éƒ½æ„å»ºå®Œæˆåæ‰ä¼šæ„å»ºä¸‹ä¸€å…„å¼ŸèŠ‚ç‚¹</p><h3 id="æ„å»º-CSSOM-æ ‘"><a href="#æ„å»º-CSSOM-æ ‘" class="headerlink" title="æ„å»º CSSOM æ ‘"></a>æ„å»º CSSOM æ ‘</h3><p>åœ¨ä¸Šé¢çš„ HTML ä¸­ï¼Œ<code>&lt;head&gt;</code> é‡Œæœ‰ä¸ªå¤–éƒ¨æ ·å¼è¡¨ <code>style.css</code>ï¼ŒHTML è§£æåˆ°è¿™é‡Œæ—¶ä¼šå‘æœåŠ¡å™¨è¯·æ±‚èµ„æºï¼Œå¾—åˆ°è¿™æ ·çš„èµ„æºï¼š</p><figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-tag">body</span> &#123; </span><br><span class="line">true<span class="attribute">font-size</span>: <span class="number">16px</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-tag">p</span> &#123; </span><br><span class="line">true<span class="attribute">font-weight</span>: bold </span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-tag">span</span> &#123; </span><br><span class="line">true<span class="attribute">color</span>: red </span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-tag">p</span> <span class="selector-tag">span</span> &#123; </span><br><span class="line">true<span class="attribute">display</span>: none </span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-tag">img</span> &#123; </span><br><span class="line">true<span class="attribute">float</span>: right </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å’Œå¤„ç† HTML ç±»ä¼¼ï¼Œæµè§ˆå™¨å¤„ç† CSS æ„å»ºäº† CSSOM</p><p><img src="https://pic.zhih.me/blog/posts/how-the-web-works/cssom-tree.png" alt="cssom-tree"></p><h3 id="æ„å»ºæ¸²æŸ“æ ‘"><a href="#æ„å»ºæ¸²æŸ“æ ‘" class="headerlink" title="æ„å»ºæ¸²æŸ“æ ‘"></a>æ„å»ºæ¸²æŸ“æ ‘</h3><p>å‰é¢å·²ç»æ„å»ºäº† DOM æ ‘å’Œ CSSOM æ ‘ï¼Œç°åœ¨æµè§ˆå™¨å°±æŠŠå®ƒä»¬åˆå¹¶æˆä¸€ä¸ªæ¸²æŸ“æ ‘</p><p><img src="https://pic.zhih.me/blog/posts/how-the-web-works/render-tree-construction.png" alt="render-tree-construction"></p><p>åœ¨æ¸²æŸ“æ ‘çš„æ„å»ºè¿‡ç¨‹ä¸­ï¼Œæµè§ˆå™¨éå† DOM æ ‘ï¼Œç„¶åå¯¹åº” CSSOM æ ‘ç»™æ¯ä¸ªèŠ‚ç‚¹è®¾ç½®è®¡ç®—æ ·å¼ï¼ˆæœ€ç»ˆæ ·å¼ï¼‰ï¼Œè®¾ç½®äº† <code>display: none</code> çš„èŠ‚ç‚¹ï¼Œå°†ä¼šåœ¨æ¸²æŸ“æ ‘ä¸­ç§»é™¤</p><p>è¿™æ ·ï¼Œæ¸²æŸ“æ ‘å°±åŒ…å«äº†é¡µé¢ä¸Šæ‰€æœ‰å¯è§çš„å†…å®¹å’Œå®ƒä»¬çš„è®¡ç®—æ ·å¼</p><h3 id="å¸ƒå±€ã€ç»˜åˆ¶"><a href="#å¸ƒå±€ã€ç»˜åˆ¶" class="headerlink" title="å¸ƒå±€ã€ç»˜åˆ¶"></a>å¸ƒå±€ã€ç»˜åˆ¶</h3><p>æ¸²æŸ“æ ‘åªåŒ…å«äº†å†…å®¹å’Œæ ·å¼ï¼Œè¦æ”¾åˆ°æµè§ˆå™¨çª—å£ä¸­ï¼Œè¿˜éœ€è¦è®¡ç®—å®ƒä»¬åœ¨çª—å£é‡Œçš„ç¡®åˆ‡çš„ä½ç½®å’Œå¤§å°ï¼Œè¿™ä¸ªè¿‡ç¨‹å«åšå¸ƒå±€ï¼Œä¹Ÿç§°ä¸ºâ€œè‡ªåŠ¨é‡æ’â€</p><p>æµè§ˆå™¨ä»æ¸²æŸ“æ ‘çš„æ ¹èŠ‚ç‚¹å¼€å§‹éå†ï¼Œæˆ‘ä»¬å¯ä»¥æƒ³è±¡ä¸ºæœ‰å¤–å‘é‡Œçš„è¿‡ç¨‹ï¼Œå…ˆç¡®å®šå¤–å±‚çš„ä½ç½®å¤§å°ï¼Œåœ¨å‘é‡Œå±‚è®¡ç®—</p><blockquote><p>å¸ƒå±€æµç¨‹çš„è¾“å‡ºæ˜¯ä¸€ä¸ªâ€œç›’æ¨¡å‹â€ï¼Œå®ƒä¼šç²¾ç¡®åœ°æ•è·æ¯ä¸ªå…ƒç´ åœ¨è§†å£å†…çš„ç¡®åˆ‡ä½ç½®å’Œå°ºå¯¸ï¼šæ‰€æœ‰ç›¸å¯¹æµ‹é‡å€¼éƒ½è½¬æ¢ä¸ºå±å¹•ä¸Šçš„ç»å¯¹åƒç´ </p></blockquote><p>å¸ƒå±€å®Œæˆåï¼Œæµè§ˆå™¨ä¼šç«‹å³å‘å‡ºâ€œPaint Setupâ€å’Œâ€œPaintâ€äº‹ä»¶ï¼Œå°†æ¸²æŸ“æ ‘ä¸­çš„æ¯ä¸ªèŠ‚ç‚¹è½¬æ¢æˆå±å¹•ä¸Šçš„å®é™…åƒç´ ï¼Œè¿™ä¸€æ­¥é€šå¸¸ç§°ä¸ºâ€œç»˜åˆ¶â€æˆ–â€œæ …æ ¼åŒ–â€</p><h3 id="é‡æ’å’Œé‡ç»˜"><a href="#é‡æ’å’Œé‡ç»˜" class="headerlink" title="é‡æ’å’Œé‡ç»˜"></a>é‡æ’å’Œé‡ç»˜</h3><p>å½“ DOM æˆ– CSSOM è¢«ä¿®æ”¹æ—¶ï¼Œä¼šå‘ç”Ÿé‡æ’ï¼ˆReflowï¼‰ï¼Œä¹Ÿå°±æ˜¯æŠŠä¸Šé¢çš„æ­¥éª¤é‡æ–°æ¥ä¸€éï¼Œè¿™æ ·æ‰èƒ½ç¡®å®šå“ªäº›åƒç´ éœ€è¦åœ¨å±å¹•ä¸Šè¿›è¡Œé‡æ–°æ¸²æŸ“ï¼Œè¿™ä¸ªè¿‡ç¨‹ä¹Ÿè¢«å«åšå›æµ</p><p>å¦‚æœæ”¹å˜çš„å±æ€§ä¸å…ƒç´ çš„ä½ç½®å¤§å°æ— å…³ï¼Œæ¯”å¦‚èƒŒæ™¯é¢œè‰²ï¼Œé‚£ä¹ˆæµè§ˆå™¨åªä¼šé‡æ–°ç»˜åˆ¶é‚£ä¸ªå…ƒç´ ï¼Œè¿™ä¸ªè¿‡ç¨‹å«é‡ç»˜ï¼ˆRepaintï¼‰</p><blockquote><p>é‡æ’å¿…ç„¶ä¼šå¼•èµ·é‡ç»˜ï¼Œé‡ç»˜åˆ™ä¸ä¸€å®šä¼šé‡æ’</p></blockquote><h3 id="CSSã€JS-é˜»å¡"><a href="#CSSã€JS-é˜»å¡" class="headerlink" title="CSSã€JS é˜»å¡"></a>CSSã€JS é˜»å¡</h3><p>é»˜è®¤æƒ…å†µä¸‹ï¼ŒCSS æ˜¯é˜»å¡æ¸²æŸ“çš„èµ„æºï¼Œæµè§ˆå™¨éœ€è¦ç­‰ DOM å’Œ CSSDOM éƒ½å‡†å¤‡å¥½ä¹‹åæ‰ä¼šæ¸²æŸ“ï¼Œæ³¨æ„ï¼Œè¿™é‡Œè¯´çš„æ˜¯é˜»å¡æ¸²æŸ“ï¼Œè€Œä¸æ˜¯é˜»å¡ DOM çš„æ„å»ºï¼Œäº‹å®ä¸Š DOM å’Œ CSSDOM çš„æ„å»ºæ˜¯å¯ä»¥åŒæ—¶è¿›è¡Œçš„</p><p>æ„å»º CSSOM ä¼šé˜»å¡å®ƒåé¢ JavaScript è¯­å¥çš„æ‰§è¡Œï¼Œè€Œ JavaScript è¯­å¥çš„æ‰§è¡Œåˆä¼šé˜»æ­¢ CSSOM çš„æ„å»ºï¼ŒåŸå› å¾ˆç®€å•ï¼Œå› ä¸º JavaScript æ‰§è¡Œæ—¶å¯èƒ½ä¼šæ”¹å˜ CSSOMï¼ŒåŒæ—¶è¿›è¡Œä¼šå¯¹æ€§èƒ½äº§ç”Ÿå½±å“</p><p>é™¤éå°† JavaScript æ˜¾å¼å£°æ˜ä¸ºå¼‚æ­¥ï¼Œå¦åˆ™å®ƒä¼šé˜»æ­¢æ„å»º DOMï¼Œå› ä¸ºé»˜è®¤æƒ…å†µä¸‹ï¼Œæµè§ˆå™¨é‡åˆ° <code>&lt;script&gt;</code> æ ‡ç­¾æ—¶ä¼šç›´æ¥æ‰§è¡Œ</p><p>æ‰€ä»¥ï¼Œæˆ‘ä»¬éœ€è¦å°½é‡æŠŠ CSS æ”¾åœ¨ç½‘é¡µå¤´éƒ¨ï¼Œé¿å…å¤ªæ™šæ‰æ„å»º CSSOMï¼Œå½±å“æ¸²æŸ“ï¼›å°½é‡æŠŠ JavaScript æ”¾åœ¨ç½‘é¡µåº•éƒ¨ï¼Œå¹¶ä¸”è®¾ç½® asyncã€defer å±æ€§ï¼Œé¿å…é˜»å¡ DOM çš„æ„å»ºã€‚defer æ˜¯â€œæ¸²æŸ“å®Œå†æ‰§è¡Œâ€ï¼Œasync æ˜¯â€œä¸‹è½½å®Œå°±æ‰§è¡Œâ€ï¼Œdefer å¦‚æœæœ‰å¤šä¸ªè„šæœ¬ï¼Œä¼šæŒ‰ç…§åœ¨é¡µé¢ä¸­å‡ºç°çš„é¡ºåºåŠ è½½ï¼Œå¤šä¸ªasync è„šæœ¬ä¸èƒ½ä¿è¯åŠ è½½é¡ºåºã€‚</p><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><p><a href="https://developers.google.com/web/fundamentals/performance/critical-rendering-path/" target="_blank" rel="noopener">https://developers.google.com/web/fundamentals/performance/critical-rendering-path/</a></p><p><a href="https://astaxie.gitbooks.io/build-web-application-with-golang/content/zh/03.1.html" target="_blank" rel="noopener">https://astaxie.gitbooks.io/build-web-application-with-golang/content/zh/03.1.html</a></p><p><a href="https://github.com/alex/what-happens-when" target="_blank" rel="noopener">https://github.com/alex/what-happens-when</a></p><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>å…¶å®å°±æ˜¯ä¸ªæµè§ˆå™¨å·¥ä½œè¿‡ç¨‹çš„æ‹†æï¼Œç„¶åæ¶‰åŠåˆ°ç›¸å½“å¤šçš„çŸ¥è¯†ç‚¹ï¼Œå¹¶ä¸”è¿™äº›éƒ½æ˜¯æ WEB çš„å¿…çŸ¥çš„ï¼Œå†™å®Œè¿™ä¹ˆå¤šä¹Ÿç®—æ˜¯æ¶ˆåŒ–äº†ï¼Œä¸‹ä¸€æ­¥å¯èƒ½å†™å†™ WEB æ€§èƒ½ä¼˜åŒ–ç›¸å…³çš„å§ï¼Œä¹Ÿæ˜¯ä¸€ä¸ªå¾ˆå€¼å¾—å†™çš„ç‚¹</p><p>çŸ¥è¯†å°±æ˜¯åŠ›é‡ â€“ åŸ¹æ ¹</p><blockquote><p>æœ¬æ–‡ç« å‘è¡¨äºåº•å™ªåšå®¢ <a href="https://zhih.me">https://zhih.me</a> , è½¬è½½è¯·æ³¨æ˜</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> WEB </category>
          
      </categories>
      
      
        <tags>
            
            <tag> web </tag>
            
            <tag> webä¼˜åŒ– </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>åšäº†ä¸ªç”µå½±æ’è¡Œåˆ—è¡¨å°ç¨‹åº</title>
      <link href="/my-weapp-topmov/"/>
      <url>/my-weapp-topmov/</url>
      
        <content type="html"><![CDATA[<h2 id="å¼•è¨€"><a href="#å¼•è¨€" class="headerlink" title="å¼•è¨€"></a>å¼•è¨€</h2><p>å°ç¨‹åºå«ï¼šTOP ç”µå½±çœ‹ä¸å®Œ</p><p><img src="https://pic.zhih.me/blog/posts/my-weapp-topmov/screenshot.jpg" alt="æˆªå›¾"></p><p>æœ€è¿‘æŠŠè¿™ä¸ªå°ç¨‹åºç»™åŸºæœ¬å®Œæˆäº†ï¼Œè¿™ä¸ªâ€˜å®Œæˆâ€™ï¼Œæ˜¯æŒ‡æœ€åˆæˆ‘è®¾æƒ³çš„åŠŸèƒ½éƒ½å®ç°äº†ã€‚å…¶å®åŠå¹´å‰å°±å¼€å§‹ç€æ‰‹äº†ï¼Œä¸è¿‡æ–­æ–­ç»­ç»­çš„ï¼Œåæ¥è¿˜å›å®¶å­¦è½¦ã€è¿‡å¹´ç­‰ç­‰ï¼Œä¸€ç›´æ²¡æœ‰æŠŠå®ƒå®Œæˆã€‚æœ€è¿‘åˆæŠŠå®ƒæ¡èµ·æ¥ï¼Œä¸»è¦æ˜¯æŠŠåç«¯ç»™å®Œæˆäº†ã€‚</p><p>æˆ‘çˆ±æ‹¿ä¸¤ä¸ªä¸œè¥¿æ¥åšç»ƒæ‰‹çš„é¡¹ç›®ğŸ¤ªğŸ¤ªï¼Œä¸€æ˜¯å¤©æ°”ï¼ŒäºŒæ˜¯ç”µå½±åˆ—è¡¨ã€‚ä¸»è¦åŸå› è¿˜æ˜¯å› ä¸ºæœ‰å…è´¹çš„ APIï¼Œç„¶åæ˜¯åŠŸèƒ½æ˜ç¡®ã€‚</p><h2 id="è®¾è®¡"><a href="#è®¾è®¡" class="headerlink" title="è®¾è®¡"></a>è®¾è®¡</h2><h3 id="åŠŸèƒ½ï¼š"><a href="#åŠŸèƒ½ï¼š" class="headerlink" title="åŠŸèƒ½ï¼š"></a>åŠŸèƒ½ï¼š</h3><ul><li>æœç´¢<ul><li>å…ˆåˆæ­¥å»ºç«‹ top250 çš„åˆ—è¡¨ï¼Œç„¶åæœç´¢</li><li>æœç´¢å†…å®¹åŒ…æ‹¬ç‰‡åã€ç±»å‹ã€æ—¶é—´ã€ä¸»æ¼”ã€è¯„åˆ†ã€æ’å</li></ul></li><li>å·²çœ‹<ul><li>æ ‡è®°çœ‹è¿‡çš„ç”µå½±ï¼Œçœ‹è¿‡å°±çœ‹è¿‡äº†ï¼Œæ²¡æœ‰æ’¤é”€é€‰é¡¹ğŸ˜</li></ul></li><li>æ”¶è—<ul><li>ç‚¹å‡»æ”¶è—ï¼ŒåŠ å…¥æ”¶è—åˆ—è¡¨</li></ul></li><li>è¯„è®º<ul><li>å‘è¡¨è¯„è®º</li></ul></li></ul><h3 id="å‰ç«¯"><a href="#å‰ç«¯" class="headerlink" title="å‰ç«¯"></a>å‰ç«¯</h3><ul><li>å°ç¨‹åºæœ¬èº«å°±æ˜¯ MVVM æ¶æ„çš„</li><li>ä¸åç«¯é…åˆç™»å½•ï¼šwafer2-client-sdk</li><li>è§†å›¾<ul><li>è±†ç“£ top250 åˆ—è¡¨<ul><li>æŒ‰æ’åæ’åˆ—åˆ—è¡¨ï¼Œæ˜¾ç¤ºåŸºæœ¬ä¿¡æ¯</li><li>ä¸Šæ‹‰åŠ è½½ 25 æ¡æ•°æ®ï¼Œé˜²æ­¢æ•°æ®è¿‡å¤šé€ æˆåŠ è½½ç¼“æ…¢</li></ul></li><li>æœç´¢<ul><li>æœç´¢ç»“æœæŒ‰æ’åæ’åˆ—ï¼Œè§†å›¾åŒé¦–é¡µ</li></ul></li><li>ç”µå½±è¯¦æƒ…<ul><li>æ˜¾ç¤ºç”µå½±è¯¦ç»†ä¿¡æ¯ï¼Œæ€»çœ‹è¿‡æ•°ã€æ”¶è—æ•°ã€è¯„è®ºæ•°</li><li>ç”¨æˆ·å¯è¿›è¡Œè¯„è®º</li></ul></li><li>ä¸ªäººä¸­å¿ƒ<ul><li>å¤´åƒã€å§“åã€ç­‰çº§ã€çœ‹è¿‡æ•°ã€æ”¶è—æ•°ã€è¯„è®º</li><li>ç­‰çº§æ•°æ®ç»¼åˆçœ‹è¿‡ç”µå½±æ•°æ®å’Œè¯„è®ºå¾—å‡º</li></ul></li><li>çœ‹è¿‡ã€æ”¶è—åˆ—è¡¨<ul><li>åŒé¦–é¡µè§†å›¾</li></ul></li></ul></li></ul><p>å‰ç«¯ç›®å½•ç»“æ„</p><p><img src="https://pic.zhih.me/blog/posts/my-weapp-topmov/app.jpg" alt="å‰ç«¯ç›®å½•ç»“æ„"></p><h3 id="åç«¯"><a href="#åç«¯" class="headerlink" title="åç«¯"></a>åç«¯</h3><ul><li>é‡‡ç”¨ MVC æ¶æ„</li><li>é‡‡ç”¨ nodejsï¼Œä½¿ç”¨ wafer-node-sdk</li><li>Web æ¡†æ¶ï¼šKoa2</li><li>è¯·æ±‚ä½“è§£æï¼škoa-better-body</li><li>æ•°æ®åº“ï¼ˆç”µå½±æ•°æ®æ¥è‡ªè±†ç“£ï¼‰ï¼š<ul><li>toplistï¼štop250 éƒ¨åˆ†æ•°æ®<ul><li>ç”µå½± idã€å½±åã€æ’åã€è¯„åˆ†ã€ç±»å‹ã€æ—¶é—´ã€å¯¼æ¼”ã€ä¸»æ¼”ã€å°é¢</li></ul></li><li>userï¼šç”¨æˆ·ä¿¡æ¯<ul><li>openidã€sessionã€å·²çœ‹ã€æ”¶è—</li></ul></li><li>movï¼šç”µå½±è¯¦æƒ…<ul><li>ç”µå½± idã€è¯¦ç»†æè¿°ã€åœ°åŒºã€åŸåã€åˆåã€å·²çœ‹æ•°ã€æ”¶è—æ•°ã€è¯„è®ºæ•°</li></ul></li><li>commentï¼šè¯„è®º<ul><li>ç”µå½± idã€openidã€è¯„è®ºå†…å®¹ã€è¯„è®ºæ—¶é—´ã€ç‰‡å</li></ul></li></ul></li></ul><p>åç«¯ç›®å½•ç»“æ„</p><p><img src="https://pic.zhih.me/blog/posts/my-weapp-topmov/server.jpg" alt="åç«¯ç›®å½•ç»“æ„"></p><h3 id="æŠ€æœ¯æ ˆ"><a href="#æŠ€æœ¯æ ˆ" class="headerlink" title="æŠ€æœ¯æ ˆ"></a>æŠ€æœ¯æ ˆ</h3><p>HTML<br>CSS<br>JavaScript<br>Node.js<br>MySQL<br>Nginx</p><h2 id="åŠ¨æ‰‹åš"><a href="#åŠ¨æ‰‹åš" class="headerlink" title="åŠ¨æ‰‹åš"></a>åŠ¨æ‰‹åš</h2><h3 id="æœ¬åœ°éƒ¨ç½²"><a href="#æœ¬åœ°éƒ¨ç½²" class="headerlink" title="æœ¬åœ°éƒ¨ç½²"></a>æœ¬åœ°éƒ¨ç½²</h3><p>æœ¬åœ°æ­ä¸€ä¸ª https æœåŠ¡å™¨ï¼Œå› ä¸ºå°ç¨‹åºåªæ”¯æŒ httpsï¼Œåœ¨å¾®ä¿¡å…¬ä¼—å¹³å°è®¾ç½®åŸŸåç­‰åŸºç¡€è®¾ç½®ã€‚</p><p>æ³¨æ„ï¼Œè¦æƒ³æ‰«ç è°ƒè¯•ã€é¢„è§ˆï¼Œéœ€è¦åœ¨è·¯ç”±å™¨è®¾ç½® hostsï¼ŒæŠŠåŸŸåæŒ‡å‘ç”µè„‘çš„ IPã€‚</p><h3 id="æ•²ä»£ç "><a href="#æ•²ä»£ç " class="headerlink" title="æ•²ä»£ç "></a>æ•²ä»£ç </h3><p>å…¶å®å°±æ˜¯æ­£å¸¸çš„ web ç¼–ç¨‹ï¼Œå°ç¨‹åºå°±æ˜¯ä¸€ä¸ªå’Œ vue å¾ˆåƒçš„æ¡†æ¶ï¼Œæ•°æ®æ˜¯åŒå‘ç»‘å®šçš„ã€‚å› ä¸ºæ¥è§¦è¿‡ vue æ‰€ä»¥ä¸Šæ‰‹å¾ˆç®€å•ã€‚æƒ³æƒ³ä¹‹å‰ä»èŠ‚ç‚¹é©±åŠ¨è·³å‡ºï¼Œåˆæ¬¡æ¥è§¦æ•°æ®é©±åŠ¨ï¼Œè®©æˆ‘æ„Ÿè§‰å¾ˆæ–°å¥‡ä¹Ÿå¾ˆçˆ½ã€‚</p><p>é¦–å…ˆæ˜¯ï¼Œå¾®ä¿¡å¼€å‘è€…å·¥å…·ï¼Œä¹‹å‰ç¬¬ä¸€æ¬¡ç”¨çš„æ—¶å€™ï¼ŒçœŸä»–å¦ˆéš¾ç”¨ï¼Œç°åœ¨æ›´æ–°è¶Šæ¥è¶Šå¥½äº†ï¼Œä¸è¿‡ç¼–è¾‘å™¨è¿˜æ˜¯åŒæ ·åƒåœ¾ï¼Œæ•²ä»£ç è¿˜å¾—ç”¨ VS code æˆ–å…¶ä»–ç†Ÿæ‚‰çš„ç¼–è¾‘å™¨ï¼Œæˆ‘ç”¨çš„æ˜¯ sublime å› ä¸ºå„ç§æ’ä»¶å•¥çš„æˆ‘éƒ½è£…å¥½äº†ï¼Œå¿«æ·é”®ä»€ä¹ˆçš„éƒ½è°ƒçš„å¾ˆèˆ’æœã€‚å¼€å‘è€…å·¥å…·å°±æ‹¿æ¥åšè°ƒè¯•å§ã€‚</p><p>é¡ºä¾¿æä¸€ä¸‹ï¼Œå› ä¸ºå¼€å‘è€…å·¥å…·é‡Œç”¨çš„æ˜¯ chrome åšè°ƒè¯•å·¥å…·ï¼Œå¦‚æœåç«¯ä½¿ç”¨çš„æ˜¯ nodejsï¼Œå¯ä»¥ä½¿ç”¨ node â€“inspectï¼Œé…åˆè°ƒè¯•ã€‚</p><p>ç„¶åï¼Œè®²çœŸï¼Œå¼€å‘çœŸçš„æ²¡ä»€ä¹ˆå¯è¯´çš„ï¼Œå®˜æ–¹çš„å¼€å‘æ–‡æ¡£å¾ˆè¯¦ç»†ï¼ŒAPI éƒ½å¾ˆä¸°å¯Œï¼Œåšä¸€ä¸ªç”µå½±åˆ—è¡¨æ²¡ä»€ä¹ˆéš¾åº¦ã€‚</p><p>åç«¯æ–¹é¢ç®€å•è¯´ä¸€ä¸‹ï¼Œå› ä¸ºè±†ç“£çš„ API æœ‰è¯·æ±‚æ•°é™åˆ¶ï¼Œæ‰€ä»¥æˆ‘å†’æ˜§çš„ä½¿ç”¨äº†è‡ªå·±çš„ VPS åšä¸­è½¬ï¼Œåšæ•°æ®ç¼“å­˜ã€‚</p><p>å¦å¤–ï¼Œå®ç°ç™»å½•åŠŸèƒ½å’Œç™»å½•æ€å‚¨å­˜ï¼Œä½¿ç”¨çš„æ˜¯ wafer-node-sdkï¼Œè¿™ä¸ªéœ€è¦ä»”ç»†çœ‹å®˜æ–¹çš„è¯´æ˜ã€‚</p><h2 id="å‘å¸ƒ"><a href="#å‘å¸ƒ" class="headerlink" title="å‘å¸ƒ"></a>å‘å¸ƒ</h2><ol><li>å¼€å‘è€…å·¥å…·ç‚¹å‡»ä¸Šä¼ </li><li>å¾®ä¿¡å…¬ä¼—å¹³å°æäº¤å®¡æ ¸</li><li>ç­‰ä¸ªä¸€ä¸¤å¤©å°±èƒ½å®¡æ ¸å®Œæˆ</li></ol><p>æ³¨æ„ï¼Œæœ‰äº›åŠŸèƒ½åœ¨ä¸ªäººè®¤çœŸçš„å°ç¨‹åºæ˜¯ä¸èƒ½è¢«å®¡æ ¸é€šè¿‡çš„ï¼Œæ¯”å¦‚æˆ‘è¿™é‡Œè¾¹çš„è¯„è®ºï¼Œæˆ‘æ˜¯é€šè¿‡å…ˆå…³é—­è¯„è®ºåŠŸèƒ½ï¼Œé€šè¿‡å®¡æ ¸åå†è¿œç¨‹æ‰“å¼€çš„ğŸ˜ï¼Œæœºæ™ºå¦‚æˆ‘ã€‚</p><h2 id="ç»“è¯­"><a href="#ç»“è¯­" class="headerlink" title="ç»“è¯­"></a>ç»“è¯­</h2><p>æœ¬æ¥è¿˜æ‰“ç®—å†™ç‚¹ä»€ä¹ˆçš„ï¼Œåæ¥å‘ç°ï¼Œæ²¡å•¥å¯å†™ï¼Œç»ˆç©¶æ˜¯è‚šå­é‡Œå¢¨æ°´ä¸å¤Ÿï¼ŒæŠ€æœ¯ç§¯ç´¯è¿˜ä¸è¡Œï¼Œå¾—åŠ æ²¹å•Šã€‚</p><blockquote><p>æœ¬æ–‡ç« å‘è¡¨äºåº•å™ªåšå®¢ <a href="https://zhih.me">https://zhih.me</a> , è½¬è½½è¯·æ³¨æ˜</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> WEB </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å°ç¨‹åº </tag>
            
            <tag> å…¨æ ˆ </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Nginxé…ç½®HTTPSä»¥åŠä½¿ç”¨HTTP2æœåŠ¡å™¨æ¨é€</title>
      <link href="/nginx-http2-https/"/>
      <url>/nginx-http2-https/</url>
      
        <content type="html"><![CDATA[<h2 id="å¼•è¨€"><a href="#å¼•è¨€" class="headerlink" title="å¼•è¨€"></a>å¼•è¨€</h2><p>æˆ‘çš„å°åšå®¢åœ¨SSL Labs çš„ <a href="https://www.ssllabs.com/ssltest/index.html" target="_blank" rel="noopener">SSL Server Test</a> ä¸­å¾—åˆ°äº† A+ çš„å¥½æˆç»©</p><p><img src="https://pic.zhih.me/blog/posts/nginx-http2-https/cover.jpg" alt="SSL Server Test"></p><p>è™½ç„¶æ²¡æ­å»ºè¿‡ä»€ä¹ˆå¤§ç«™ï¼Œä½†æ˜¯è¿™å‡ å¹´ä¹Ÿç§¯ç´¯äº†ä¸å°‘ç»éªŒï¼Œä»Šå¤©å°±è¯´è¯´åœ¨ Nginx ä¸Šé…ç½® HTTPSã€HTTP/2ï¼Œå¹¶å¼€å¯æœåŠ¡å™¨æ¨é€ã€‚</p><p>å¾ˆå¤šäººè¯´åšäº§å“è¦è¿½æ±‚ç”¨æˆ·ä½“éªŒï¼Œä½œä¸ºä¸€ä¸ªç”¨æˆ·ï¼Œæˆ‘è®¤ä¸ºä¸€ä¸ªç½‘ç«™æœ€é‡è¦çš„å°±æ˜¯æ‰“å¼€çš„é€Ÿåº¦ã€‚æ‰€ä»¥åœ¨è‡ªå·±æ­ç½‘ç«™çš„æ—¶å€™ï¼Œä¸€ç›´ç—´å¿ƒäºæé«˜ç½‘ç«™çš„é€Ÿåº¦ã€‚</p><p>ä»¥æˆ‘è¿™ä¸ªåšå®¢ä¸ºä¾‹ï¼Œè‡ªå·±ç§»æ¤å¹¶æ”¹å†™äº†ä¸»é¢˜ï¼Œèµ„æºéƒ½è¿›è¡Œäº†å‹ç¼©ï¼Œå…¬å…±é™æ€èµ„æºéƒ½ç”¨äº†å…¬å…± CDNï¼Œå› ä¸º VPS çš„å¸¦å®½åªæœ‰å¯æ€œçš„ 1Mï¼Œæ‰€ä»¥å›¾ç‰‡èµ„æºéƒ½è¿›è¡Œäº†å‹ç¼©å¹¶å­˜åˆ°äº†è…¾è®¯äº‘ COSï¼Œä½¿ç”¨ CDN è¿›è¡ŒåŠ é€Ÿã€‚è¿™æ ·çš„ä¸€å †åŠ æˆä¹‹åï¼Œå³ä½¿ VPS æ¯ç§’åªèƒ½è·‘ 128kb çš„èµ„æºï¼Œä¹Ÿèƒ½å¿«é€Ÿçš„æ‰“å¼€ç½‘ç«™ã€‚</p><h2 id="ä¼˜åŒ–ä»€ä¹ˆ"><a href="#ä¼˜åŒ–ä»€ä¹ˆ" class="headerlink" title="ä¼˜åŒ–ä»€ä¹ˆ"></a>ä¼˜åŒ–ä»€ä¹ˆ</h2><p>web æ€§èƒ½ä¼˜åŒ–çš„é—¨è·¯å¾ˆå¤šï¼Œæœ‰ç©ºæˆ‘å†å¦å¼€ä¸€ç¯‡æˆ‘å¯¹ä¼˜åŒ–çš„è§è§£è¯´è¯´ï¼Œä½†æ˜¯ä¸€èˆ¬å¯¹äºæˆ‘åšå®¢è¿™ç§é™æ€ç«™æ¥è¯´ï¼ŒçœŸæ­£å½±å“é€Ÿåº¦çš„æ˜¯ï¼Œå¸¦å®½ã€å»¶è¿Ÿã€è¯·æ±‚æ•°ã€èµ„æºå¤§å°ã€‚å¸¦å®½å¤§ã€å»¶è¿Ÿä½çš„ vps è´µï¼Œä¸ºå‡å°‘æœåŠ¡å™¨ç›¸å…³çš„å¼€é”€ï¼Œåªèƒ½é å‹ç¼©èµ„æºå’Œå‡å°‘è¯·æ±‚äº†ã€‚</p><p>ç½‘é€Ÿæ…¢çš„æ—¶å€™ä¸‹è½½å¤§æ–‡ä»¶ç‰¹åˆ«æ“è›‹ï¼Œè¿™å¤§å®¶éƒ½çŸ¥é“ï¼Œé‚£æ‰“å¼€ç½‘é¡µäº¦æ˜¯å¦‚æ­¤ï¼Œä½†é€Ÿåº¦ä¸ä»…å–å†³äºå®¢æˆ·ç«¯çš„ç½‘é€Ÿï¼Œè¿˜æœ‰æœåŠ¡ç«¯çš„ã€‚æ—¢ç„¶æä¸æ¥ç½‘é€Ÿå¿«çš„æœåŠ¡å™¨ï¼Œé‚£åªèƒ½æŠŠæ–‡ä»¶å‡å°å’¯ï¼ŒæŠŠä»€ä¹ˆ JSã€CSSã€å›¾ç‰‡éƒ½ç»™å‹ç¼©å’¯ï¼Œè¿™ä¸‹æ€»å¯ä»¥äº†å§ã€‚</p><p><strong>ä½†æ˜¯ï¼Œå‹ç¼©å°±è¶³å¤Ÿäº†å—ï¼Ÿ</strong></p><p>ä¸å¤Ÿï¼Œå› ä¸ºæµè§ˆå™¨æœ‰ä¸ªå¹¶å‘è¿æ¥æ•°é™åˆ¶ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œæµè§ˆå™¨å¯¹æ¯ä¸ªåŸŸåçš„å¹¶å‘è¯·æ±‚æ˜¯æœ‰é™çš„ï¼ŒåŒä¸€æ—¶é—´åªèƒ½åšå‡ ä¸ªè¯·æ±‚ï¼Œç„¶åå†ç­‰ä¸‹ä¸€è½®è¯·æ±‚ã€‚å…·ä½“åˆ°å®é™…ä½“éªŒå°±æ˜¯ï¼Œå½“ä½ çš„ä¸€ä¸ªç½‘é¡µå†…éœ€è¦åŠ è½½çš„èµ„æºæ•°é‡è¾ƒå¤šçš„æ—¶å€™ï¼Œæµè§ˆå™¨åˆ†å‡ æ¬¡æ‰èƒ½æŠŠèµ„æºä¸‹è½½ä¸‹æ¥ï¼Œè¿™å°±å½±å“åˆ°ç½‘é¡µåŠ è½½é€Ÿåº¦äº†ã€‚</p><p><strong>æ‰€ä»¥ï¼Œè¯¥æ€ä¹ˆåŠï¼Ÿ</strong></p><p>å‡å°‘è¯·æ±‚æ•°å‘—ï¼Œå¾ˆå¤šæ—¶å€™éƒ½è¿™æ ·è¯´ï¼Œä½†æ˜¯ä¸€èˆ¬æ¥è¯´ï¼Œå‡å°‘è¯·æ±‚æ•°æ„å‘³ç€å¯¹å„ç§èµ„æºæœ€å†…è”å¤„ç†ï¼Œè€Œç¼ºç‚¹å¾ˆæ˜æ˜¾ï¼Œå†…è” CSS/JS ä¸å¥½ç»´æŠ¤ã€å†…è”å›¾ç‰‡ä¸ä¼šæœ‰æµè§ˆå™¨ç¼“å­˜ã€å¢å¤§å•ä¸ªç½‘é¡µçš„ä½“ç§¯ï¼Œå½“ç„¶è¿™äº›ä¹Ÿä¸æ˜¯ç»å¯¹ï¼Œè‡³å°‘ä»¥æˆ‘è¿™ä¸ªé™æ€åšå®¢æ¥è¯´ï¼Œéƒ½æ˜¯å¼Šç«¯ã€‚</p><p><strong>è‰¹ï¼Œä¸€ä¸å°å¿ƒéƒ½åç¦»é‡ç‚¹äº†</strong></p><p>å¥½å§ï¼Œå¼€å§‹è¯´è¯´ä¸»é¢˜å§ã€‚</p><h2 id="HTTP2-0"><a href="#HTTP2-0" class="headerlink" title="HTTP2.0"></a>HTTP2.0</h2><p>å…³äºæ˜¯ä»€ä¹ˆï¼Œå¹²ä»€ä¹ˆçš„ï¼Œæ€ä¹ˆæ¥çš„ï¼Œè¿™äº›é—®é¢˜ï¼Œè‡ªå·±å»çœ‹<a href="https://zh.wikipedia.org/wiki/HTTP/2" target="_blank" rel="noopener">ç»´åŸºç™¾ç§‘</a>å»ï¼Œè¿˜æœ‰è¿™ä¸€ç¯‡è°·æ­Œé«˜æ€§èƒ½ web å·¥ç¨‹å¸ˆå†™çš„æ–‡ç« ï¼š<a href="https://hpbn.co/http2" target="_blank" rel="noopener">https://hpbn.co/http2</a></p><p>æˆ‘è¿™é‡Œå°±ç®€å•è¯´ä¸€ä¸‹</p><p>ä¸€å¥è¯è¯´å°±æ˜¯ï¼Œ<strong>è§£å†³äº†ä¸Šé¢é—ç•™ä¸‹æ¥é—®é¢˜</strong></p><p>å¯¹äºæˆ‘ä»¬æ¥è¯´ï¼Œæå‡ä½“éªŒçš„æ˜¯å®ƒçš„è¿™ 3 ä¸ªç‰¹æ€§</p><ul><li><p>å¤´å‹ç¼©</p><ul><li>å‹ç¼©è¯·æ±‚å¤´å¤§å°ï¼Œå‡å°‘è¯·æ±‚æ—¶é—´</li></ul></li><li><p>è¯·æ±‚å’Œå“åº”å¤ç”¨</p><ul><li>å¹¶è¡Œäº¤é”™å¤šä¸ªè¯·æ±‚ï¼Œä¸ä¼šé˜»å¡ä»»ä½•è¯·æ±‚</li><li>å¹¶è¡Œä¼ è¾“å¤šä¸ªå“åº”ï¼Œè€Œä¸ä¼šå¯¹ä»»ä½•ä¸€ä¸ªè¿›è¡Œé˜»å¡</li><li>ä½¿ç”¨å•ä¸ªè¿æ¥å¹¶è¡Œä¼ é€å¤šä¸ªè¯·æ±‚å’Œå“åº”</li><li>æ¶ˆé™¤ä¸å¿…è¦çš„å»¶è¿Ÿå¹¶æé«˜å¯ç”¨å¸¦å®½çš„åˆ©ç”¨ç‡</li></ul></li></ul><p><img src="https://pic.zhih.me/blog/posts/nginx-http2-https/multiplexing.jpg" alt="è¯·æ±‚å’Œå“åº”å¤ç”¨"></p><ul><li>æœåŠ¡å™¨æ¨é€<ul><li>é™¤äº†å¯¹åŸå§‹è¯·æ±‚çš„å“åº”ä¹‹å¤–ï¼ŒæœåŠ¡å™¨è¿˜å¯ä»¥ å‘å®¢æˆ·ç«¯æ¨é€é¢å¤–çš„èµ„æº</li></ul></li></ul><p><img src="https://pic.zhih.me/blog/posts/nginx-http2-https/server-push.jpg" alt="æœåŠ¡å™¨æ¨é€"></p><p><em>ä»¥ä¸Šå›¾ç‰‡æ¥è‡ª<a href="https://hpbn.co/http2" target="_blank" rel="noopener">https://hpbn.co/http2</a></em></p><p>å¦‚æœæŠŠæµè§ˆå™¨å’ŒæœåŠ¡å™¨é€šä¿¡æ¯”ä½œä½ å’Œæœ‹å‹èŠå¤©ï¼Œé‚£ä¹ˆåœ¨è¿™ä¸ªåœºæ™¯ä¸‹ï¼Œä¼šæ˜¯è¿™æ ·çš„</p><ul><li><p>HTTP1.1ï¼ˆç›®å‰ä¸»æµåè®®ï¼‰</p><ul><li>ä½ å‘ä¸€å¥æ¶ˆæ¯ç»™æœ‹å‹ï¼Œéœ€è¦ç­‰æœ‹å‹å›å¤ä½ äº†æ‰èƒ½å‘ç¬¬äºŒå¥</li><li>ä½ ä¸ä¸»åŠ¨é—®å€™æœ‹å‹ï¼Œæœ‹å‹ä¸ä¼šç†ä½ </li></ul></li><li><p>HTTP2.0</p><ul><li>ä½ å¯ä»¥ä¸€æ¬¡å‘å¤šæ¡æ¶ˆæ¯äº†ï¼Œæœ‹å‹ä¹Ÿä¼šä¸€æ¬¡æ€§å›å¤ä½ </li><li>ä½ çš„æœ‹å‹ä¼šä¸»åŠ¨é—®å€™ä½ </li></ul></li></ul><p>æ˜¯ä¸æ˜¯ç¾æ»‹æ»‹</p><h2 id="é…ç½®-HTTPS"><a href="#é…ç½®-HTTPS" class="headerlink" title="é…ç½® HTTPS"></a>é…ç½® HTTPS</h2><p>æˆ‘çš„æ–°æ–‡ç« ï¼Œæ›´è¯¦ç»†çš„ HTTPS é…ç½®ï¼Œå¯ä»¥åˆ°è¿™é‡ŒæŸ¥çœ‹</p><p><a href="https://zhih.me/make-your-website-support-tls1-3/">https://zhih.me/make-your-website-support-tls1-3/</a></p><p>æœ¬æ¥è¿™ç¯‡æ–‡ç« å°±æ˜¯è¦å†™å†™ï¼Œå¦‚ä½•é…ç½® HTTPS çš„ï¼Œæƒ³ä¸åˆ°æ‰¯å‡ºè¿™ä¹ˆå¤š</p><p>å…³äºä¸ºä»€ä¹ˆè¦é…ç½® HTTPSï¼Œé—®ä½ è‡ªå·±å§</p><h3 id="ç”³è¯·-SSL-è¯ä¹¦"><a href="#ç”³è¯·-SSL-è¯ä¹¦" class="headerlink" title="ç”³è¯· SSL è¯ä¹¦"></a>ç”³è¯· SSL è¯ä¹¦</h3><p>éšç€ HTTPS çš„æ™®åŠï¼Œå‡ºç°äº†å¾ˆå¤šçš„å…è´¹è¯ä¹¦ï¼Œæ¯”å¦‚ Letâ€™s Encryptï¼Œä½†æˆ‘æ‰“ç®—ä¹‹åå†å†™ä¸€ç¯‡æ–‡ç« è¯¦ç»†å†™å†™ã€‚</p><p>æˆ–è€…æ›´æ–¹ä¾¿çš„æ˜¯åˆ°é˜¿é‡Œäº‘ã€è…¾è®¯äº‘çš„åå°ç”³è¯·å…è´¹çš„è¯ä¹¦ï¼Œä¹Ÿå¾ˆç®€å•ã€‚</p><h3 id="å®‰è£…-Nginx"><a href="#å®‰è£…-Nginx" class="headerlink" title="å®‰è£… Nginx"></a>å®‰è£… Nginx</h3><p>ç‰ˆæœ¬è£…æœ€æ–°çš„å°±å¥½ï¼Œå¦‚æœæœåŠ¡å™¨è‡ªå¸¦çš„æºä¸å¤Ÿæ–°ï¼Œå¯ä»¥ç”¨ Nginx çš„å®˜æ–¹æºï¼Œå…·ä½“ä½¿ç”¨æ–¹å¼åœ¨ä»–ä»¬çš„å®˜ç½‘å·²ç»ç»™å‡ºï¼Œä¸åœ¨è¯¦ç»†è¯´æ˜ã€‚</p><p><a href="http://nginx.org/en/linux_packages.html" target="_blank" rel="noopener">http://nginx.org/en/linux_packages.html</a></p><h3 id="å®‰è£…-OpenSSL"><a href="#å®‰è£…-OpenSSL" class="headerlink" title="å®‰è£… OpenSSL"></a>å®‰è£… OpenSSL</h3><p>å¼€å¯ HTTPS éœ€è¦ OpenSSL ç‰ˆæœ¬ &gt;= 1.0.1ï¼Œæˆ‘ç”¨çš„ Debian9 è‡ªå¸¦ 1.1.0</p><p>ä½ å¯ä»¥ä½¿ç”¨ <code>openssl version</code> è¿™ä¸ªå‘½ä»¤æŸ¥çœ‹ï¼Œä¸å¤Ÿæ–°çš„è‡ªè¡Œå‡çº§</p><h3 id="Nginx-é…ç½®"><a href="#Nginx-é…ç½®" class="headerlink" title="Nginx é…ç½®"></a>Nginx é…ç½®</h3><h4 id="HTTP-301-è·³è½¬-HTTPS"><a href="#HTTP-301-è·³è½¬-HTTPS" class="headerlink" title="HTTP 301 è·³è½¬ HTTPS"></a>HTTP 301 è·³è½¬ HTTPS</h4><p>å¤§å¤šæµè§ˆå™¨é»˜è®¤è®¿é—® HTTPï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦è®©å®ƒè·³è½¬åˆ° HTTPS ä¸Š</p><p>ä»¥æˆ‘çš„åšå®¢ä¸ºä¾‹</p><figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line"><span class="section">server</span> &#123;</span><br><span class="line">    <span class="attribute">listen</span>      <span class="number">80</span>;</span><br><span class="line">    <span class="attribute">server_name</span> zhih.me www.zhih.me;</span><br><span class="line">    <span class="attribute">return</span> <span class="number">301</span> https://zhih.me<span class="variable">$request_uri</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="HTTP2-å’Œ-HTTPS"><a href="#HTTP2-å’Œ-HTTPS" class="headerlink" title="HTTP2 å’Œ HTTPS"></a>HTTP2 å’Œ HTTPS</h3><p>ç›®å‰æ‰€æœ‰æ”¯æŒ HTTP/2 çš„æµè§ˆå™¨éƒ½æ˜¯åŸºäº TLS 1.2 åè®®ä¹‹ä¸Šæ„å»º HTTP/2 çš„ï¼Œæ‰€ä»¥è¦ä½¿ç”¨ HTTP/2 å¿…é¡»å¼€å¯ HTTPS</p><p>ä»¥ä¸‹æ˜¯æˆ‘åšå®¢æœåŠ¡å™¨ HTTPS éƒ¨åˆ†çš„å®Œæ•´é…ç½®ï¼Œgzip å‹ç¼©ç­‰å…¶ä»–è®¾ç½®æˆ‘æ”¾åˆ°äº† nginx.conf é‡Œ</p><p>æˆ‘çš„é…ç½®å¯èƒ½ä¼šæ›´æ–°ï¼Œå¯ä»¥å» <a href="https://zhih.me/make-your-website-support-tls1-3/">ç¼–è¯‘Nginxæ”¯æŒTLS1.3</a> é‚£ç¯‡å¸–å­é‡Œçœ‹ï¼Œä¸€åˆ‡ä»¥é‚£é‡Œçš„ä¸ºæœ€æ–°</p><figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line"><span class="section">server</span> &#123;</span><br><span class="line">    <span class="attribute">listen</span> <span class="number">443</span> ssl http2;</span><br><span class="line">    <span class="attribute">server_name</span> zhih.me www.zhih.me;</span><br><span class="line"></span><br><span class="line">    <span class="attribute">if</span> (<span class="variable">$host</span> != zhih.me) &#123;</span><br><span class="line">        <span class="attribute">return</span> <span class="number">301</span> https://zhih.me<span class="variable">$request_uri</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="attribute">root</span>  /ç«™ç‚¹ç›®å½•;</span><br><span class="line"></span><br><span class="line">    <span class="attribute">ssl_certificate</span>       /ssl/zhih.me.crt;</span><br><span class="line">    <span class="attribute">ssl_certificate_key</span>   /ssl/zhih.me.key;</span><br><span class="line"></span><br><span class="line">    <span class="attribute">ssl_protocols</span> TLSv1.<span class="number">2</span>;</span><br><span class="line">    <span class="attribute">ssl_ciphers</span> <span class="string">'ECDHE-ECDSA-AES256-GCM-SHA384:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-CHACHA20-POLY1305:ECDHE-RSA-CHACHA20-POLY1305:ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-GCM-SHA256:ECDHE-ECDSA-AES256-SHA384:ECDHE-RSA-AES256-SHA384:ECDHE-ECDSA-AES128-SHA256:ECDHE-RSA-AES128-SHA256'</span>;</span><br><span class="line">    <span class="attribute">ssl_prefer_server_ciphers</span> <span class="literal">on</span>;</span><br><span class="line"></span><br><span class="line">    <span class="attribute">ssl_session_cache</span> shared:SSL:<span class="number">50m</span>;</span><br><span class="line">    <span class="attribute">ssl_session_timeout</span> <span class="number">1d</span>;</span><br><span class="line">    <span class="attribute">ssl_session_tickets</span> <span class="literal">on</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="attribute">ssl_stapling</span> <span class="literal">on</span>;</span><br><span class="line">    <span class="attribute">ssl_stapling_verify</span> <span class="literal">on</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="attribute">resolver</span> <span class="number">119.29.29.29</span> <span class="number">8.8.8.8</span> valid=<span class="number">300s</span>;</span><br><span class="line">    <span class="attribute">resolver_timeout</span> <span class="number">10s</span>;</span><br><span class="line"></span><br><span class="line">    <span class="attribute">add_header</span> Strict-Transport-Security <span class="string">"max-age=31536000; includeSubDomains; preload"</span>;</span><br><span class="line"></span><br><span class="line">    <span class="attribute">location</span> / &#123;</span><br><span class="line">        <span class="attribute">index</span>  index.html;</span><br><span class="line">        <span class="attribute">http2_push</span> /css/allinone.min.css;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="è¯¦ç»†è¯´æ˜"><a href="#è¯¦ç»†è¯´æ˜" class="headerlink" title="è¯¦ç»†è¯´æ˜"></a>è¯¦ç»†è¯´æ˜</h3><h4 id="å¼€å¯-HTTP2"><a href="#å¼€å¯-HTTP2" class="headerlink" title="å¼€å¯ HTTP2"></a>å¼€å¯ HTTP2</h4><figure class="highlight lsl"><table><tr><td class="code"><pre><span class="line"><span class="section">listen</span> <span class="number">443</span> ssl http2;</span><br></pre></td></tr></table></figure><p>ç›‘å¬ 443 ç«¯å£ï¼ŒHTTPS åè®®èµ°è¿™ä¸ªç«¯å£ï¼ŒHTTP èµ°çš„æ˜¯ 80</p><p>åªéœ€è¦åœ¨ SSL åé¢åŠ ä¸Šå°±èƒ½å¼€å¯ HTTP2</p><blockquote><p>æ³¨æ„ï¼šæˆ‘è¿™é…ç½®é‡Œè¾¹çš„ 301 è·³è½¬æ˜¯ä» <a href="http://www.zhih.me" target="_blank" rel="noopener">www.zhih.me</a> è·³è½¬åˆ° zhih.meï¼Œå¦‚æœä½ ä¸éœ€è¦ï¼Œå¯ä»¥ä¸åƒè¿™æ ·è®¾ç½®</p></blockquote><h4 id="å¼€å¯æœåŠ¡å™¨æ¨é€"><a href="#å¼€å¯æœåŠ¡å™¨æ¨é€" class="headerlink" title="å¼€å¯æœåŠ¡å™¨æ¨é€"></a>å¼€å¯æœåŠ¡å™¨æ¨é€</h4><figure class="highlight glsl"><table><tr><td class="code"><pre><span class="line"><span class="keyword">location</span> / &#123;</span><br><span class="line">        <span class="keyword">index</span>  <span class="keyword">index</span>.html;</span><br><span class="line">        http2_push /css/allinone.<span class="built_in">min</span>.css;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p>æˆ‘è¿™é‡ŒæŠŠ <code>/css</code> ç›®å½•ä¸‹çš„ <code>allinone.min.css</code> æ–‡ä»¶æ·»åŠ äº†æœåŠ¡å™¨æ¨é€</p><p>ä¹‹ååœ¨æµè§ˆå™¨å¼€å‘è€…æ§åˆ¶å°é‡Œçš„æ•ˆæœå°±æ˜¯è¿™æ ·çš„</p><p><img src="https://pic.zhih.me/blog/posts/nginx-http2-https/push.jpg" alt="æœåŠ¡å™¨æ¨é€"></p><h4 id="å…¶ä»–é…ç½®"><a href="#å…¶ä»–é…ç½®" class="headerlink" title="å…¶ä»–é…ç½®"></a>å…¶ä»–é…ç½®</h4><p><code>ssl_certificate</code> æ˜¯å…¬é’¥ï¼Œ<code>ssl_certificate_key</code> æ˜¯ç§é’¥ï¼Œåé¢å†™æ–‡ä»¶è·¯å¾„</p><p><code>ssl_protocols</code> åŠ å¯†åè®®ï¼ŒNginx é»˜è®¤æ˜¯ SSLv3 TLSv1 TLSv1.1 TLSv1.2ï¼Œä½†æ˜¯ SSLv3 ç›®å‰è¿˜å­˜åœ¨æ¼æ´ï¼Œä¸å»ºè®®ä½¿ç”¨ï¼Œè€Œæˆ‘åšçš„æ¯”è¾ƒæ¿€è¿›ï¼Œåªä¿ç•™äº† TLSv1.2ï¼Œå› ä¸ºæˆ‘ç›¸ä¿¡ï¼Œèƒ½è®¿é—®è¿™ä¸ªåšå®¢çš„äººï¼Œç”¨çš„æµè§ˆå™¨éƒ½ä¸ä¼šå¾ˆä½çº§ã€‚</p><p><code>ssl_ciphers</code> åŠ å¯†ç®—æ³•ï¼Œå› ä¸ºä¸åŒæµè§ˆå™¨ä¼˜å…ˆä½¿ç”¨çš„ç®—æ³•ä¸åŒï¼Œæˆ‘ä»¬å¯ä»¥åœ¨æœåŠ¡ç«¯è®¾ç½®ä¼˜å…ˆçº§å’Œç¦æ­¢ä½¿ç”¨çš„ç®—æ³•ï¼Œå¹¶ç»“åˆ <code>ssl_prefer_server_ciphers on</code> æ¥è®©æµè§ˆå™¨ä¼˜å…ˆé€‰æ‹©æˆ‘ä»¬è®¾ç½®å¥½çš„ã€‚</p><p><code>ssl_session_cache</code> SSL ä¼šè¯ç¼“å­˜</p><p><code>ssl_session_timeout</code> SSL ä¼šè¯ç¼“å­˜è¿‡æœŸæ—¶é—´</p><p><code>add_header Strict-Transport-Security max-age=15768000</code> å¼€å¯ HSTSï¼Œåé¢æ˜¯ç¼“å­˜æ—¶é—´</p><h4 id="é‡å¯-Nginx"><a href="#é‡å¯-Nginx" class="headerlink" title="é‡å¯ Nginx"></a>é‡å¯ Nginx</h4><p>ä¿å­˜é…ç½®ï¼Œé‡å¯ Nginx ç”Ÿæ•ˆ</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">nginx -s reload</span><br></pre></td></tr></table></figure><h4 id="æŸ¥çœ‹æ•ˆæœ"><a href="#æŸ¥çœ‹æ•ˆæœ" class="headerlink" title="æŸ¥çœ‹æ•ˆæœ"></a>æŸ¥çœ‹æ•ˆæœ</h4><p>HTTPS ç”Ÿæ•ˆç»“æœæŸ¥çœ‹å¾ˆç®€å•ï¼Œç›´æ¥æ‰“å¼€ä½ çš„ç½‘ç«™ï¼Œçœ‹åˆ°æµè§ˆå™¨å‰é¢æœ‰ä¸ªé”å¤´å°±è¡Œäº†</p><p>æˆ‘ä»¬ä¸»è¦çœ‹ HTTP2 æ˜¯å¦ç”Ÿæ•ˆï¼Œä½¿ç”¨ curl å‘½ä»¤ï¼Œcurl éœ€è¦æ”¯æŒ HTTPS HTTP2</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">curl --http2 -I https://zhih.me</span><br></pre></td></tr></table></figure><p><img src="https://pic.zhih.me/blog/posts/nginx-http2-https/end.jpg" alt="æ•ˆæœ"></p><p>æ•™ç¨‹å†™åˆ°è¿™é‡Œå°±å‘Šä¸€æ®µè½äº†ï¼Œä½ å¯èƒ½å°±è¦é—®äº†ï¼ŒHTTP/2 åŠ é€Ÿäº†ä½ çš„åšå®¢äº†å—ï¼Ÿ</p><p>ä¸€å®šç¨‹åº¦ä¸Šæ˜¯çš„ï¼Œä½†ç”±äºæˆ‘ç”¨äº† CDNï¼Œåœ¨è‡ªå·±æœåŠ¡å™¨ä¸Šè¯·æ±‚çš„èµ„æºå¹¶ä¸ä¼šå¾ˆæ˜æ˜¾ï¼Œåšå®¢ä¸Šåªæœ‰ä¸€ä¸ªè‡ªå®šä¹‰æ ·å¼è¡¨å’ŒåŸºç¡€çš„é™æ€ç½‘é¡µéœ€è¦ä»æˆ‘è‡ªå·±æœåŠ¡å™¨ä¸Šè·å–ï¼Œå…¶ä»–çš„å„ç§ç±»åº“æˆ‘éƒ½ä½¿ç”¨äº† CDNï¼Œæ–‡ç« é‡Œçš„å›¾ç‰‡æ”¾åˆ°äº†è…¾è®¯äº‘ COS æ­é… CDN ä½¿ç”¨</p><p>æ¯æ¬¡æœ‰äººè®¿é—®æ—¶ï¼Œè¯·æ±‚äº†é™æ€é¡µé¢ï¼ŒHTTP2 çš„æœåŠ¡å™¨æ¨é€ä¼šæŠŠè‡ªå®šä¹‰æ ·å¼è¡¨æ¨é€è¿‡å»ï¼Œå°±å‡å°‘äº†ä¸€æ¬¡è¯·æ±‚ï¼Œç”¨çš„ CDN ä¹Ÿå¯ç”¨äº† HTTP2ï¼Œæ‰€ä»¥å¯ä»¥åœ¨æˆ‘è¿™ 1Mbps å°æ°´ç®¡ä¸Šå®ç° 0.9s æ‰“å¼€ 13 ä¸ªè¯·æ±‚ã€è¿‘ 500kb å¤§å°çš„é¡µé¢</p><p><img src="https://pic.zhih.me/blog/posts/nginx-http2-https/blogspeed.jpg" alt="åšå®¢é€Ÿåº¦æµ‹è¯•"></p><h2 id="å…¶ä»–å·¥å…·"><a href="#å…¶ä»–å·¥å…·" class="headerlink" title="å…¶ä»–å·¥å…·"></a>å…¶ä»–å·¥å…·</h2><p>Moz æ¨èçš„ HTTPS é…ç½®ï¼ˆè‡ªåŠ¨é…ç½®ï¼‰ï¼š<a href="https://mozilla.github.io/server-side-tls/ssl-config-generator/" target="_blank" rel="noopener">https://mozilla.github.io/server-side-tls/ssl-config-generator/</a></p><p>SSL Server Testï¼š<a href="https://www.ssllabs.com/ssltest/index.html" target="_blank" rel="noopener">https://www.ssllabs.com/ssltest/index.html</a></p><p>ä¸æœè·‘ä¸ªåˆ†</p><h2 id="ç»“è¯­"><a href="#ç»“è¯­" class="headerlink" title="ç»“è¯­"></a>ç»“è¯­</h2><p>æŠ€æœ¯çš„å‡çº§è¿­ä»£æ½œç§»é»˜åŒ–çš„å½±å“ç€å¤§å®¶çš„ç”Ÿæ´»ï¼Œä» 1960 å¹´ Ted Nelson æ„æ€ HTTP åè®®ï¼Œåˆ° 1996 å¹´ HTTP/1.0 è¢«æ­£å¼ä½œä¸ºæ ‡å‡†ï¼Œå†åˆ° 1997 å¹´å…¬å¸ƒå¹¶ä¸€ç›´æ²¿ç”¨è‡³ä»Šçš„ HTTP/1.1ï¼Œå¯ä»¥è¯´å®ƒæ˜¯äººç±»äº’è”ç½‘çš„åŸºçŸ³ï¼Œ2015 å¹´å‘å¸ƒäº† HTTP2ï¼Œå®ƒä¸ºç½‘é¡µæ€§èƒ½è€Œç”Ÿï¼Œä»–ä»¥æ›´å¿«ï¼Œæ›´å¼ºï¼Œæ›´å®‰å…¨çš„ç‰¹æ€§ï¼Œé€æ¸è¢«çš„è¢«å„å¤§å…¬å¸ä½¿ç”¨ï¼Œç›¸ä¿¡å…¨é¢æ™®åŠ HTTPS/HTTP2 ä¸ä¼šæœ‰å¤ªé•¿çš„æ—¶é—´ã€‚</p><blockquote><p>æœ¬æ–‡ç« å‘è¡¨äºåº•å™ªåšå®¢ <a href="https://zhih.me">https://zhih.me</a> , è½¬è½½è¯·æ³¨æ˜</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> æ•™ç¨‹ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> nginx </tag>
            
            <tag> https </tag>
            
            <tag> webä¼˜åŒ– </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>ä½¿ç”¨Pyenv ç®¡ç†PYçš„ç‰ˆæœ¬</title>
      <link href="/pyenv-usage/"/>
      <url>/pyenv-usage/</url>
      
        <content type="html"><![CDATA[<h2 id="å¼•è¨€"><a href="#å¼•è¨€" class="headerlink" title="å¼•è¨€"></a>å¼•è¨€</h2><p>å‰å‡ å¤©ä½¿ç”¨ pip å®‰è£…è…¾è®¯äº‘ COS çš„å‘½ä»¤è¡Œå·¥å…· <a href="https://github.com/tencentyun/coscmd" target="_blank" rel="noopener">coscmd</a> çš„æ—¶å€™ï¼ŒMacOS è‡ªå¸¦çš„ Python å’Œ pip è®©æˆ‘è§‰å¾—ä¸çˆ½ã€‚</p><p>é¡ºä¾¿è£…ä¸€ä¸‹é€¼ï¼Œä¸Šé¢æåˆ°çš„ <a href="https://github.com/tencentyun/coscmd" target="_blank" rel="noopener">coscmd</a> æˆ‘æäº¤äº†å‡ è¡Œä»£ç ï¼Œå¾—åˆ°äº† merge ï¼ŒğŸ˜ğŸ˜<strong>æˆ‘ç‰¹ä¹ˆä¹Ÿæ˜¯ç»™è…¾è®¯æäº¤è¿‡ä»£ç çš„äºº</strong>ğŸ˜ğŸ˜ã€‚</p><p>é¦–å…ˆæ˜¯ pip ï¼Œæˆ‘ç›´æ¥ç”¨ <code>easy_install</code> å®‰è£…çš„ï¼Œåœ¨ä½¿ç”¨å®ƒå®‰è£… coscmd æ—¶å€™ï¼Œéœ€è¦ä½¿ç”¨ sudo ï¼Œç„¶åå„ç§ç»„ä»¶å¾ˆéš¾æƒ³æˆ‘é¢„æƒ³çš„é‚£æ ·é¡ºåˆ©è£…ä¸Šï¼Œæ€»æ˜¯éœ€è¦åŠ  sudoï¼Œåº”è¯¥æ˜¯ç›®å½•æƒé™çš„åŸå› ã€‚å½“ç„¶ï¼Œè¿™å¯èƒ½æ˜¯æˆ‘çš„é”…ï¼Œä½†æ˜¯å¯¹äºæˆ‘æ¥è¯´ï¼Œä½¿ç”¨ç³»ç»Ÿè‡ªå¸¦çš„ç¯å¢ƒæ˜¯ä¸å¥½çš„ï¼Œå¤©çŸ¥é“å“ªå¤©å‡ºé”™äº†ä¼šå½±å“åˆ°ä»€ä¹ˆï¼Œæˆ‘æ›´å€¾å‘äºåŒ…ç®¡ç†å™¨çš„é‚£ç§å®‰è£…æ–¹å¼ï¼Œå‡ºé—®é¢˜å°±å¸è½½ä»æ¥ã€‚</p><p>ç„¶åæ˜¯è‡ªå¸¦çš„ Python ï¼Œå½“ç„¶æˆ‘å¹¶ä¸æ˜¯åš PY å¼€å‘çš„ï¼Œä½†æ˜¯æ¥è§¦ä¸€ä¸‹æ€»å¥½ï¼Œæ¯•ç«Ÿä½¿ç”¨è¿‡å¤ªå¤šçš„å·¥å…·éƒ½æ˜¯ç”¨ PY ç¼–çš„ï¼Œåœ¨ä¹‹å‰ä½¿ç”¨çš„æ—¶å€™ä¹Ÿé‡åˆ°ä¸€äº›å…³äºç‰ˆæœ¬çš„é—®é¢˜ï¼Œæˆ‘ä¹‹å‰è¿˜è§‰å¾—è‡ªå¸¦äº† Python å°±ç¾æ»‹æ»‹ã€‚ç„¶åæƒ³ç”¨ homebrew ç›´æ¥è‡ªå·±è£…ç®—äº†ï¼Œä½†æ˜¯æœ‰å‘ç°ï¼Œè¿™æ ·ä¹Ÿä¸çµæ´»å•Šï¼Œæœ‰äº›æ—¶å€™è¦ py2.7ã€æœ‰çš„è¦ py3 ï¼Œé‚£ä¹ˆé—®é¢˜æ¥äº†ï¼Œpy æœ‰æ²¡æœ‰å’Œ nvm ä¸€æ ·çš„ç‰ˆæœ¬ç®¡ç†å·¥å…·ï¼Ÿ</p><p><strong>åºŸè¯ï¼Œå¿…é¡»æœ‰çš„å•Šï¼</strong></p><p>è¿™å°±æ˜¯ <a href="https://github.com/pyenv/pyenv" target="_blank" rel="noopener">Pyenv</a> äº†ã€‚</p><blockquote><p>pyenv lets you easily switch between multiple versions of Python. Itâ€™s simple, unobtrusive, and follows the UNIX tradition of single-purpose tools that do one thing well.</p></blockquote><p>ä¸Šé¢å¼•ç”¨ä»–ä»¬ github ä¸Šçš„è¯ï¼Œç¿»è¯‘è¿‡æ¥å°±æ˜¯ï¼šè£…ï¼Œå°±å¯¹äº†ã€‚</p><h2 id="å®‰è£…"><a href="#å®‰è£…" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h2><p>è¿˜æ˜¯ä½¿ç”¨ homebrew å®‰è£…ï¼Œå…³äº homebrew ï¼Œå»æˆ‘ <a href="https://zhih.me/make-macos-better/">ä¸Šä¸€ç¯‡æ–‡ç« </a> çœ‹çœ‹ã€‚</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">brew install pyenv</span><br></pre></td></tr></table></figure><p>å®‰è£…å¥½ä¹‹åï¼Œæˆ‘ä»¬è¿˜éœ€è¦åœ¨æ‰“å¼€ shell çš„æ—¶å€™è‡ªåŠ¨æ‰§è¡Œ pyenv çš„åˆå§‹åŒ–</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">echo</span> <span class="string">'eval "$(pyenv init -)"'</span> &gt;&gt; ~/.zshrc</span><br></pre></td></tr></table></figure><p>é‡å¯ä½ çš„ shell å°±ç”Ÿæ•ˆäº†</p><h2 id="ä½¿ç”¨"><a href="#ä½¿ç”¨" class="headerlink" title="ä½¿ç”¨"></a>ä½¿ç”¨</h2><p>æˆ‘è¿™é‡Œåªè¯´è¯´åŸºæœ¬çš„ä½¿ç”¨æ–¹æ³•ï¼Œæ¯•ç«Ÿæˆ‘åªç®—æ˜¯ä¸ªæ¨èäººï¼Œå…·ä½“çš„é«˜çº§ç”¨æ³•ï¼Œæ‰¾ä»–ä»¬çš„ Wiki çœ‹å»</p><h3 id="å®‰è£…å¤šä¸ª-Python-ç‰ˆæœ¬"><a href="#å®‰è£…å¤šä¸ª-Python-ç‰ˆæœ¬" class="headerlink" title="å®‰è£…å¤šä¸ª Python ç‰ˆæœ¬"></a>å®‰è£…å¤šä¸ª Python ç‰ˆæœ¬</h3><p>é¦–å…ˆæ˜¯æ‰¾åˆ°éœ€è¦è£…çš„ Python ç‰ˆæœ¬å·</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">pyenv install --list</span><br></pre></td></tr></table></figure><p>åˆ—å‡ºä¸€å †å„ç§çš„ç‰ˆæœ¬ Python ï¼Œè¦è£…å“ªä¸ªå°±è®°ä½ç‰ˆæœ¬å·</p><p>æ¯”å¦‚è¯´æˆ‘è¿™é‡Œè¦è£…ä¸ª 2.7.14 å’Œ 3.6.5</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">pyenv install 2.7.14</span><br><span class="line">pyenv install 3.6.5</span><br></pre></td></tr></table></figure><p>è¿™æ ·å°±è£…ä¸Šäº†ï¼Œä½ å°±è¦é—®äº†ï¼Œè¿™ä¸å°±å’Œæˆ‘ç”¨ homebrew å®‰è£…ä¸€æ ·å˜›ï¼Œç”šè‡³å®ƒå®‰è£…éƒ½è°ƒç”¨äº† homebrew ï¼Ÿ</p><p>é‚£ä¸‹é¢å°±æ˜¯ pyenv çœŸæ­£èµ·ä½œç”¨çš„æ—¶å€™äº†</p><h3 id="ç‰ˆæœ¬ç®¡ç†"><a href="#ç‰ˆæœ¬ç®¡ç†" class="headerlink" title="ç‰ˆæœ¬ç®¡ç†"></a>ç‰ˆæœ¬ç®¡ç†</h3><p>å®é™…ä½¿ç”¨ä¸­ï¼Œæˆ‘ä»¬å¯èƒ½ä¸åŒçš„é¡¹ç›®éœ€è¦ä¸åŒçš„ç‰ˆæœ¬ï¼Œpyenv å¯ä»¥ç»™å…¨å±€åˆ‡æ¢ç‰ˆæœ¬ï¼Œä¹Ÿå¯ä»¥åœ¨ç»™ä¸åŒçš„ç›®å½•è®¾ç½®ä¸åŒçš„ç‰ˆæœ¬</p><h4 id="å…¨å±€"><a href="#å…¨å±€" class="headerlink" title="å…¨å±€"></a>å…¨å±€</h4><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">pyenv global 3.6.5</span><br><span class="line">pyenv <span class="built_in">rehash</span></span><br></pre></td></tr></table></figure><p>è¿™ä¸‹ï¼Œä½¿ç”¨ <code>python -V</code> å°±èƒ½çœ‹åˆ°è‡ªå·±ç‰ˆæœ¬å˜æˆäº† 3.6.5</p><h4 id="å½“å‰ç›®å½•"><a href="#å½“å‰ç›®å½•" class="headerlink" title="å½“å‰ç›®å½•"></a>å½“å‰ç›®å½•</h4><p>è¦ç»™é¡¹ç›®å•ç‹¬è®¾ç½® Python ç‰ˆæœ¬ï¼Œéœ€è¦ cd è¿›å…¥ç›®å½•</p><p>ä¾‹å¦‚æˆ‘è¦ç»™å½“å‰ç›®å½•è®¾ç½®ä¸º miniconda3-4.3.30</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">pyenv <span class="built_in">local</span> miniconda3-4.3.30</span><br><span class="line">pyenv <span class="built_in">rehash</span></span><br></pre></td></tr></table></figure><p>è¿™æ ·å°±å¯ä»¥äº†</p><h4 id="æŸ¥çœ‹ç¯å¢ƒè®¾ç½®"><a href="#æŸ¥çœ‹ç¯å¢ƒè®¾ç½®" class="headerlink" title="æŸ¥çœ‹ç¯å¢ƒè®¾ç½®"></a>æŸ¥çœ‹ç¯å¢ƒè®¾ç½®</h4><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">pyenv versions</span><br></pre></td></tr></table></figure><p>è¿™ä¸ªå‘½ä»¤å¯ä»¥çœ‹è‡ªå·±è£…äº†å“ªå‡ ä¸ªç‰ˆæœ¬ï¼Œå¹¶ä¸”å“ªä¸ªç›®å½•ç»™äº†å“ªä¸ªç‰ˆæœ¬ï¼Œå†™çš„æ¸…æ¸…æ¥šæ¥š</p><h2 id="ç»“è¯­"><a href="#ç»“è¯­" class="headerlink" title="ç»“è¯­"></a>ç»“è¯­</h2><p>äººç”Ÿè‹¦çŸ­ï¼Œæˆ‘é€‰ Python</p><blockquote><p>æœ¬æ–‡ç« å‘è¡¨äºåº•å™ªåšå®¢ <a href="https://zhih.me">https://zhih.me</a> , è½¬è½½è¯·æ³¨æ˜</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> æ•™ç¨‹ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> MacOS </tag>
            
            <tag> Python </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>MacOSè¿™æ ·æ›´å¥½ç”¨</title>
      <link href="/make-macos-better/"/>
      <url>/make-macos-better/</url>
      
        <content type="html"><![CDATA[<h2 id="å¼•è¨€"><a href="#å¼•è¨€" class="headerlink" title="å¼•è¨€"></a>å¼•è¨€</h2><p>æˆ‘ä¹‹æ‰€ä»¥é€‰æ‹©ä½¿ç”¨ MacOSï¼Œæ˜¯å› ä¸ºå®ƒæ˜¯ç®€æ´é«˜æ•ˆçš„ç±» Unix ç³»ç»Ÿï¼Œå¯¹å„ç§å¼€å‘ç¯å¢ƒå‹å¥½ï¼Œå¹¶ä¸”è¿‘å¹´æ¥éšç€å›½å†… Mac çš„æ™®åŠï¼Œå„ç§åº”ç”¨è½¯ä»¶ä¹Ÿåœ¨ MacOS ä¸Šé€‚é…äº†ï¼Œè½¯ä»¶ä¸°å¯Œåº¦æ–¹é¢å®Œå…¨ä¸ç”¨æ‹…å¿ƒï¼Œå¹¶ä¸” MacOS ä¸‹çš„è½¯ä»¶æ›´åŠ çš„çº¯å‡€ç®€æ´ï¼Œä¸ä¼šåƒ Windows ä¸‹é‚£æ ·å‡ºç° â€œå…¨å®¶æ¡¶â€ æ•ˆåº”ã€‚</p><p>ä¿—è¯è¯´å¾—å¥½ï¼šå·¥æ¬²å–„å…¶äº‹ï¼Œå¿…å…ˆåˆ©å…¶å™¨</p><p>é‚£ä¹ˆï¼Œåˆšè£…ä¸Šä¸€ä¸ªæ–°çš„ç³»ç»Ÿï¼Œåº”è¯¥æ€æ ·å»è®¾ç½®ï¼Œè®©å®ƒæ›´å¥½ç”¨å‘¢ï¼Ÿ</p><h2 id="1-ç³»ç»Ÿè®¾ç½®"><a href="#1-ç³»ç»Ÿè®¾ç½®" class="headerlink" title="1. ç³»ç»Ÿè®¾ç½®"></a>1. ç³»ç»Ÿè®¾ç½®</h2><h3 id="dockæ ï¼ˆç¨‹åºåï¼‰"><a href="#dockæ ï¼ˆç¨‹åºåï¼‰" class="headerlink" title="dockæ ï¼ˆç¨‹åºåï¼‰"></a>dockæ ï¼ˆç¨‹åºåï¼‰</h3><p>ç³»ç»Ÿé»˜è®¤çš„ dock æ æ˜¯åœ¨åº•éƒ¨çš„ï¼Œåœ¨æ‰“å¼€åº”ç”¨æ—¶ä¼šå‡å°‘ä¿¡æ¯æµå¯è§†é¢ç§¯ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥è®¾ç½®</p><ul><li>æŠŠå®ƒæ”¾åˆ°å±å¹•å·¦è¾¹</li><li>è°ƒå°å›¾æ ‡</li><li>è®¾ç½®é¼ æ ‡æ”¾åœ¨å›¾æ ‡ä¸Šæ—¶å˜å¤§</li></ul><p>è¿™æ ·å°±å¯ä»¥çœå‡ºæ›´å¤šçš„ç©ºé—´ï¼Œå¹¶ä¸”æŒ‰ç…§ä»å·¦åˆ°å³çš„é˜…è¯»ä¹ æƒ¯ï¼Œæ”¾åœ¨å³è¾¹æ¯”è¾ƒåˆé€‚ã€‚</p><p><img src="https://pic.zhih.me/blog/posts/make-macos-better/ç¨‹åºå.jpg" alt="ç¨‹åºå"></p><h3 id="finderï¼ˆè®¿è¾¾ï¼‰"><a href="#finderï¼ˆè®¿è¾¾ï¼‰" class="headerlink" title="finderï¼ˆè®¿è¾¾ï¼‰"></a>finderï¼ˆè®¿è¾¾ï¼‰</h3><p>finder ä½œä¸ºä¸€ä¸ªæ–‡ä»¶èµ„æºç®¡ç†ä¸­å¿ƒï¼Œä¸€äº›å°è®¾ç½®å¯ä»¥è®©ä½ ç”¨çš„å¾—å¿ƒåº”æ‰‹</p><ul><li>æ–‡ä»¶å¤¹<ul><li>åœ¨ç”¨æˆ·ç›®å½•é‡Œæ–°å»º <code>home</code>ã€<code>code</code> ç›®å½•</li></ul></li><li>å·¥å…·æ <ul><li>å»æ‰ <code>æ’åˆ—</code>ï¼Œå› ä¸ºå¯ä»¥åœ¨æ–‡ä»¶å¤¹é‡Œå³é”®è®¾ç½®æ’åˆ—</li><li>æ·»åŠ  <code>åˆ é™¤</code>ã€<code>æ–°å»ºæ–‡ä»¶å¤¹</code></li></ul></li><li>æ˜¾ç¤º<ul><li>æ˜¾ç¤ºè·¯å¾„æ </li><li>æ˜¾ç¤ºçŠ¶æ€æ </li></ul></li><li>ä¾§è¾¹æ <ul><li>æ·»åŠ  <code>home</code> ç›®å½•</li><li>æ·»åŠ  <code>code</code> ç›®å½•</li></ul></li></ul><p><img src="https://pic.zhih.me/blog/posts/make-macos-better/è®¿è¾¾.jpg" alt="è®¿è¾¾.png"></p><h2 id="2-Xcode"><a href="#2-Xcode" class="headerlink" title="2. Xcode"></a>2. Xcode</h2><p>Xcode æ˜¯ MacOS ä¸‹é‡è¦çš„ IDEï¼Œä½ è¦æ˜¯å¼€å‘è‹¹æœç³»çš„åŸç”Ÿ Appï¼Œéœ€è¦å®ƒï¼Œè€Œæˆ‘ä»¬æ›´å¤šæ˜¯éœ€è¦ä»–çš„å‘½ä»¤è¡Œå·¥å…·</p><p>é¦–å…ˆï¼Œåœ¨<a href="https://itunes.apple.com/cn/app/xcode/id497799835?mt=12" target="_blank" rel="noopener">App Store</a>å®‰è£…Xcodeã€‚</p><p>Xcode æä¾›äº†ç¼–è¯‘è½¯ä»¶å¿…å¤‡çš„ <code>Xcode Command Line Tools</code>ï¼Œå®ƒåŒ…å«äº† GCC ç¼–è¯‘å™¨ï¼Œåœ¨è£…å®Œ Xcode ä¹‹åæˆ‘ä»¬éœ€è¦æ‰§è¡Œä¸€ä¸‹å‘½ä»¤å®‰è£…å®ƒ</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">xcode-select --install</span><br></pre></td></tr></table></figure><p>ä»–ä¼šæç¤ºå®‰è£…ï¼ŒæŒ‰ç…§è¯´æ˜æ“ä½œå°±å¯ä»¥äº†ã€‚</p><h2 id="3-Homebrew"><a href="#3-Homebrew" class="headerlink" title="3. Homebrew"></a>3. Homebrew</h2><p>ç”¨è¿‡ Linux çš„éƒ½çŸ¥é“åŒ…ç®¡ç†å™¨ï¼ŒDebian ç³»ç”¨çš„ dpkgã€çº¢å¸½ç³»ç”¨çš„ rpmï¼Œè€Œ MacOS ä¸‹æœ€å—è¿½æ§çš„å°±æ˜¯ <a href="https://brew.sh/" target="_blank" rel="noopener">Homebrew</a> äº†ï¼Œå®ƒå¯ä»¥è®©æˆ‘ä»¬å®‰è£…å’Œæ›´æ–°åº”ç”¨ç¨‹åºæˆ–åº“ï¼Œæ˜¯ä¸ªå¤§æ€å™¨ã€‚</p><h3 id="å®‰è£…"><a href="#å®‰è£…" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h3><p>å®‰è£… Homebrew éœ€è¦å‰é¢æåˆ°çš„ <code>Xcode Command Line Tools</code>ï¼Œä¹‹å Homebrew æ‰€æ‰§è¡Œçš„ç¼–è¯‘åŒ…çš„ä»»åŠ¡å…¨éƒ½ä¾é å®ƒã€‚</p><p>åœ¨ç»ˆç«¯è¾“å…¥å‘½ä»¤ä»¥ä¸‹å›è½¦å°±èƒ½è¿›è¡Œå®‰è£…äº†</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">/usr/bin/ruby -e <span class="string">"<span class="variable">$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/master/install)</span>"</span></span><br></pre></td></tr></table></figure><p>åœ¨å®‰è£…å®Œæˆåæ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼Œè¯Šæ–­ä¸€ä¸‹æœ‰æ²¡æœ‰ä»€ä¹ˆé”™è¯¯ï¼Œæˆ–è€… Homebrew éœ€è¦ä½ åšä»€ä¹ˆæ ·çš„è®¾ç½®</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">brew doctor</span><br></pre></td></tr></table></figure><p>brew å°±æ˜¯ Homebrew çš„åŒ…ç®¡ç†å‘½ä»¤äº†ï¼Œç”¨æ³•ç±»ä¼¼ debian çš„ apt-get</p><h3 id="æ¢æº"><a href="#æ¢æº" class="headerlink" title="æ¢æº"></a>æ¢æº</h3><p>Homebrew é»˜è®¤çš„æºæœåŠ¡å™¨åœ¨å›½å¤–ï¼Œè¿™æ ·æˆ‘ä»¬åœ¨å›½å†…ä½¿ç”¨çš„æ—¶å€™é€Ÿåº¦å¯èƒ½æ¯”è¾ƒæ…¢ï¼Œé˜¿é‡Œäº‘æä¾›äº†é•œåƒæºï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤æ›¿æ¢</p><p>æ³¨æ„ï¼Œä»¥ä¸‹å‘½ä»¤ä¸ºZshç»ˆç«¯çš„é…ç½®ï¼Œæ‰€ä»¥è¦æ‰§è¡Œ <code>brew install zsh</code> å®‰è£…zshã€‚</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># æ›¿æ¢brew.git:</span></span><br><span class="line"><span class="built_in">cd</span> <span class="string">"<span class="variable">$(brew --repo)</span>"</span></span><br><span class="line">git remote <span class="built_in">set</span>-url origin https://mirrors.aliyun.com/homebrew/brew.git</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ›¿æ¢homebrew-core.git:</span></span><br><span class="line"><span class="built_in">cd</span> <span class="string">"<span class="variable">$(brew --repo)</span>/Library/Taps/homebrew/homebrew-core"</span></span><br><span class="line">git remote <span class="built_in">set</span>-url origin https://mirrors.aliyun.com/homebrew/homebrew-core.git</span><br><span class="line"></span><br><span class="line"><span class="comment"># åº”ç”¨ç”Ÿæ•ˆ</span></span><br><span class="line">brew update</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ›¿æ¢homebrew-bottles:</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">'export HOMEBREW_BOTTLE_DOMAIN=https://mirrors.aliyun.com/homebrew/homebrew-bottles'</span> &gt;&gt; ~/.zshrc</span><br><span class="line"><span class="built_in">source</span> ~/.zshrc</span><br></pre></td></tr></table></figure><h3 id="ç”¨æ³•"><a href="#ç”¨æ³•" class="headerlink" title="ç”¨æ³•"></a>ç”¨æ³•</h3><p>homebrew çš„ç”¨æ³•å’Œå…¶å®ƒåŒ…ç®¡ç†å™¨ä¸€æ ·ï¼Œå¦‚æœä½ ä½¿ç”¨è¿‡ï¼Œé‚£ä¹ˆè¿™æ­¥ä½ å¯ä»¥ä¸çœ‹</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># å®‰è£…è½¯ä»¶åŒ…</span></span><br><span class="line">brew insatll åŒ…å</span><br><span class="line"></span><br><span class="line"><span class="comment"># æœç´¢</span></span><br><span class="line">brew search åŒ…å</span><br><span class="line"></span><br><span class="line"><span class="comment"># å¸è½½</span></span><br><span class="line">brew uninstall åŒ…å</span><br><span class="line"></span><br><span class="line"><span class="comment"># æŸ¥çœ‹å·²å®‰è£…åˆ—è¡¨</span></span><br><span class="line">brew list</span><br><span class="line"></span><br><span class="line"><span class="comment"># è·å–æ–°åˆ—è¡¨</span></span><br><span class="line">brew update</span><br><span class="line"></span><br><span class="line"><span class="comment"># å‡çº§è½¯ä»¶åŒ…</span></span><br><span class="line">brew upgrade</span><br></pre></td></tr></table></figure><h2 id="4-å¿«é€ŸæŸ¥çœ‹"><a href="#4-å¿«é€ŸæŸ¥çœ‹" class="headerlink" title="4. å¿«é€ŸæŸ¥çœ‹"></a>4. å¿«é€ŸæŸ¥çœ‹</h2><p>QuickLook æ˜¯ MacOS ä¸­ç›¸å½“é«˜æ•ˆçš„åŠŸèƒ½ï¼ŒæŒ‰ä¸€ä¸‹ç©ºæ ¼é”®å°±å¯ä»¥é¢„è§ˆæ–‡ä»¶ï¼Œä¸æ¯”æ‰“å¼€æ–‡ä»¶æµè§ˆï¼Œå¾ˆæ–¹ä¾¿å¿«æ·ï¼Œå®ƒè‡ªå¸¦çš„åŠŸèƒ½å¯èƒ½æ²¡æœ‰å¾ˆå…¨ï¼Œæœ‰äº›æ–‡ä»¶æ— æ³•é¢„è§ˆï¼Œé‚£ä¹ˆå°±éœ€è¦ç»™å®ƒè£…ä¸Šæ’ä»¶ã€‚</p><p>è¿™é‡Œæ˜¯ä¸€äº›å¸¸ç”¨çš„æ’ä»¶ï¼š <a href="https://github.com/sindresorhus/quick-look-plugins#manually" target="_blank" rel="noopener">https://github.com/sindresorhus/quick-look-plugins#manually</a></p><p>å¯ä»¥ç›´æ¥ä½¿ç”¨ homebrew è¿›è¡Œå®‰è£…</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">brew cask install qlcolorcode qlstephen qlmarkdown quicklook-json qlimagesize webpquicklook suspicious-package quicklookase qlvideo</span><br></pre></td></tr></table></figure><h2 id="5-ç»ˆç«¯"><a href="#5-ç»ˆç«¯" class="headerlink" title="5. ç»ˆç«¯"></a>5. ç»ˆç«¯</h2><p>ç»ˆç«¯ç»å¯¹æ˜¯ MacOS ç§’æ€ Windows çš„ç¬¬ä¸€å¤§æ€å™¨äº†ï¼Œå½“ç„¶ï¼Œæœ‰å¾ˆå¤šäººä¼šæ¨èä½¿ç”¨ iTerm2 ä¹‹ç±»çš„ç¬¬ä¸‰æ–¹ç»ˆç«¯ï¼Œå°±æˆ‘ä¸ªäººè€Œè¨€ï¼Œç³»ç»Ÿè‡ªå¸¦çš„å°±è¶³å¤Ÿï¼Œä¸ç”¨å†å»è£…é‚£äº›åŠŸèƒ½ä¸°å¯Œçš„ç»ˆç«¯ï¼Œé€‚åˆè‡ªå·±çš„æ‰æ˜¯ç¬¬ä¸€ç”Ÿäº§åŠ›ï¼Œå­¦ä¹ æ€ä¹ˆå»ç”¨çš„æ—¶é—´ï¼Œå¯ä»¥å†™ä¸€ä¸ª <a href="https://zhih.me/onmp-installation/">onmp</a> äº†ã€‚</p><h3 id="å­—ä½“"><a href="#å­—ä½“" class="headerlink" title="å­—ä½“"></a>å­—ä½“</h3><p>ç»ˆç«¯çš„åå¥½è®¾ç½®ä½ éšä¾¿è®¾ç½®ï¼Œæ€ä¹ˆé€‚åˆæ€ä¹ˆæ¥ï¼Œæˆ‘åœ¨è¿™é‡Œåªæ¨èä¸€ä¸ªå¿…é¡»è®¾ç½®çš„é¡¹ï¼Œ<a href="https://github.com/tonsky/FiraCode" target="_blank" rel="noopener">FiraCodeå­—ä½“</a>ï¼Œä½ å¯ä»¥å»ä»–ä»¬çš„ github é¡µçœ‹çœ‹ï¼Œç›¸ä¿¡ä½ ä¸€å®šä¼šçˆ±ä¸Šå®ƒã€‚</p><h3 id="Zsh"><a href="#Zsh" class="headerlink" title="Zsh"></a>Zsh</h3><p>æˆ‘ä»¬åœ¨ä¸Šé¢å·²ç»æåˆ°è¿‡ zshï¼Œå®ƒæ˜¯ä¸ªä»¤äººæ„Ÿåˆ°æƒŠè‰³çš„ shellï¼Œå…³äºå®ƒï¼Œè‡ªè¡Œæœç´¢çœ‹çœ‹å§ã€‚</p><p>ä½¿ç”¨ homebrew å®‰è£…</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">brew install zsh</span><br></pre></td></tr></table></figure><p>ä¸å‡ºæ„å¤–ï¼Œç°åœ¨å°±å®‰è£…ä¸Šäº†</p><p>å‰é¢finderè®¾ç½®é‡Œæ–°å»º <code>home</code> ç›®å½•çš„ç›®çš„æ˜¯é˜²æ­¢æ¯æ¬¡è¿›ç»ˆç«¯è¿›è¡Œæ–‡ä»¶ä¸‹è½½ï¼Œæˆ–è€…è¿›è¡Œå…¶ä»–æ“ä½œæ—¶ï¼ŒæŠŠç”¨æˆ·ç›®å½•æå¾—ä¸€å›¢ç³Ÿ</p><p>æ‰€ä»¥ç°åœ¨è¿˜è¦è®¾ç½®æ‰“å¼€ç»ˆç«¯è‡ªåŠ¨è¿›å…¥ <code>home</code> ç›®å½•</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">vi ~/.zshrc</span><br></pre></td></tr></table></figure><p>åœ¨æœ€åæ·»åŠ  <code>cd ~/home</code></p><h3 id="Oh-My-Zsh"><a href="#Oh-My-Zsh" class="headerlink" title="Oh My Zsh"></a>Oh My Zsh</h3><p><a href="http://ohmyz.sh" target="_blank" rel="noopener">Oh My Zsh</a> æ˜¯ zsh çš„ä¸€ä¸ªæ‰©å±•å·¥å…·é›†ï¼Œæä¾›äº†ä¸°å¯Œçš„æ‰©å±•åŠŸèƒ½ï¼Œæ²¡æœ‰ä»–ï¼Œzsh å°†ä¸å†å®Œæ•´</p><h4 id="å®‰è£…-1"><a href="#å®‰è£…-1" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h4><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sh -c <span class="string">"<span class="variable">$(curl -fsSL https://raw.github.com/robbyrussell/oh-my-zsh/master/tools/install.sh)</span>"</span></span><br></pre></td></tr></table></figure><h4 id="æ’ä»¶"><a href="#æ’ä»¶" class="headerlink" title="æ’ä»¶"></a>æ’ä»¶</h4><p>Oh My Zsh æœ‰ä¸°å¯Œçš„æ’ä»¶ï¼Œä½ å¯ä»¥åœ¨ <code>~/.zshrc</code> é‡Œçš„ <code>plugins</code> å­—æ®µæ·»åŠ æ’ä»¶</p><p>è¿™é‡Œæˆ‘ç»™å‡ ä¸ªæ¨èçš„æ’ä»¶ï¼Œåœ¨ <a href="https://github.com/zsh-users" target="_blank" rel="noopener">https://github.com/zsh-users</a> è¿™é‡Œèƒ½æ‰¾åˆ°åé¢ 3 ä¸ªå®‰è£…æ–¹æ³•ï¼Œå‰é¢çš„ä¸ç”¨å…¶ä»–å®‰è£…æ–¹å¼</p><figure class="highlight vim"><table><tr><td class="code"><pre><span class="line">plugins=(git autojump colored-man-pages colorize pip <span class="keyword">python</span> osx brew zsh-autosuggestions zsh-<span class="keyword">syntax</span>-highlighting <span class="keyword">history</span>-substring-<span class="built_in">search</span>)</span><br></pre></td></tr></table></figure><h2 id="6-Git"><a href="#6-Git" class="headerlink" title="6. Git"></a>6. Git</h2><p>æˆ‘ä¸æ˜¯é’ˆå¯¹è°ï¼Œæˆ‘åªæƒ³è¯´ï¼Œä¸ç”¨ git çš„ç¨‹åºå‘˜éƒ½æ˜¯è¾£é¸¡</p><h3 id="å®‰è£…-2"><a href="#å®‰è£…-2" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">brew install git</span><br></pre></td></tr></table></figure><p>å®‰è£…æˆåŠŸåå¯ä»¥ä½¿ç”¨ <code>git --version</code> çœ‹åˆ°gitç‰ˆæœ¬å·</p><h3 id="è¿æ¥-GitHub"><a href="#è¿æ¥-GitHub" class="headerlink" title="è¿æ¥ GitHub"></a>è¿æ¥ GitHub</h3><p><a href="https://help.github.com/articles/set-up-git/" target="_blank" rel="noopener">GitHubå®˜æ–¹è®¾ç½®æ•™ç¨‹</a></p><p>æˆ‘è¿™é‡Œå°±æŠŠå®ƒçš„ç®€åŒ–ä¸€ä¸‹</p><p>github å¯ä»¥é€šè¿‡ https å’Œ ssh è¿æ¥ï¼Œæˆ‘è¿™é‡Œæ¨èä½¿ç”¨ https è¿æ¥ï¼ŒåŸå› æ˜¯è®¾ç½®ç®€å•ã€ä¸æ˜“è¢«é˜²ç«å¢™æŒ¡</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">git config --global user.name <span class="string">"githubç”¨æˆ·å"</span></span><br><span class="line">git config --global user.email <span class="string">"githubæ³¨å†Œé‚®ç®±"</span></span><br></pre></td></tr></table></figure><p>è¿™äº›é…ç½®ä¿¡æ¯ä¼šå­˜åˆ° <code>~/.gitconfig</code> é‡Œ</p><p>åªæ˜¯è¿™æ ·è®¾ç½®ï¼Œæ¯æ¬¡ä½¿ç”¨éƒ½ä¼šæç¤ºè¾“å…¥å¯†ç ï¼Œæ‰€ä»¥è¦å‘Šè¯‰ Git ä½¿ç”¨ osxkeychain helper å…¨å±€ credential.helper é…ç½®</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">git config --global credential.helper osxkeychain</span><br></pre></td></tr></table></figure><p>ä¸‹ä¸€æ¬¡å…‹éš†éœ€è¦å¯†ç çš„ HTTPS URL æ—¶ï¼Œç³»ç»Ÿä¼šæç¤ºæ‚¨è¾“å…¥ç”¨æˆ·åå’Œå¯†ç ï¼Œå¹¶æˆäºˆè®¿é—® OSX é’¥åŒ™ä¸²çš„æƒé™ã€‚å®Œæˆæ­¤æ“ä½œåï¼Œç”¨æˆ·åå’Œå¯†ç å°†å­˜å‚¨åœ¨æ‚¨çš„é’¥åŒ™ä¸²ä¸­ï¼Œå¹¶ä¸”ä¸éœ€è¦å†æ¬¡å°†å®ƒä»¬è¾“å…¥åˆ° Git ä¸­ã€‚</p><p>è‡³æ­¤ï¼Œå¤§åŠŸå‘Šæˆ</p><h2 id="7-ç»“è¯­"><a href="#7-ç»“è¯­" class="headerlink" title="7. ç»“è¯­"></a>7. ç»“è¯­</h2><p>MacOS ä½œä¸ºä¸€ä¸ªå¯¹å¼€å‘è€…å‹å¥½çš„ç³»ç»Ÿï¼Œè¿˜æœ‰å¾ˆå¯¹æŠ€å·§ç­‰ç€å¤§å®¶å‘æ˜ï¼Œå¹¶ä¸”æ¯ä¸ªäººçš„ä¹ æƒ¯éƒ½æ˜¯ä¸åŒçš„ï¼Œè€Œ MacOS ä¹Ÿå®¹çº³äº†å¤§å®¶çš„ä¸åŒï¼Œæä¾›äº†å¤§å®¶ä¸ªæ€§åŒ–è®¾ç½®çš„åŸºç¡€ï¼Œç›¸ä¿¡åœ¨ä½ çš„è°ƒæ•™ä¸‹ï¼Œå®ƒä¼šæˆä¸ºä½ æ‰‹ä¸­çš„å¤§æ€å™¨ã€‚</p><blockquote><p>æœ¬æ–‡ç« å‘è¡¨äºåº•å™ªåšå®¢ <a href="https://zhih.me">https://zhih.me</a> , è½¬è½½è¯·æ³¨æ˜</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> å¿ƒå¾— </category>
          
      </categories>
      
      
        <tags>
            
            <tag> MacOS </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>ä¸€é”®å¼€å¯MacOS HiDPI</title>
      <link href="/one-key-hidpi/"/>
      <url>/one-key-hidpi/</url>
      
        <content type="html"><![CDATA[<h2 id="å¼•è¨€"><a href="#å¼•è¨€" class="headerlink" title="å¼•è¨€"></a>å¼•è¨€</h2><p>ä½œä¸ºä¸€ä¸ªé»‘è‹¹æœç”¨æˆ·ï¼Œè¿½æ±‚é»‘æœçš„ä½“éªŒæ˜¯å½“ç„¶çš„ï¼Œå½“å„ä¸ªç¡¬ä»¶éƒ½é©±åŠ¨å®Œå–„åï¼Œè¦åšçš„å°±æ˜¯ç»†èŠ‚çš„ä¼˜åŒ–äº†ï¼Œæ¯•ç«Ÿè£…ä¸Šæ˜¯æ‹¿æ¥ç”¨çš„ï¼Œå¯ä¸èƒ½å› ä¸ºä½“éªŒå·®è‹¦äº†è‡ªå·±å•ŠğŸ˜‚ã€‚æœºå™¨æ¯•ç«Ÿä¾¿å®œï¼Œä»ç¬¬ä¸€è§†è§‰ä¸Šæœ€é‡è¦çš„å°±æ˜¯å±å¹•äº†ï¼Œå½“ç„¶è‡ªå¸¦çš„å±å¹•ç´ è´¨æ²¡æ³•æ”¹å˜ï¼Œé™¤éæ¢å±äº†ï¼Œç„¶è€Œæ¢å±åˆè¿èƒŒäº†çœé’±çš„åˆè¡·ï¼Œäºæ˜¯åªèƒ½é€šè¿‡ UI ä¸Šçš„æ”¹å˜æ¥æå‡ä½“éªŒäº†ã€‚</p><h2 id="è¯´æ˜"><a href="#è¯´æ˜" class="headerlink" title="è¯´æ˜"></a>è¯´æ˜</h2><p>é¡¹ç›®åœ°å€ï¼š<a href="https://github.com/xzhih/one-key-hidpi" target="_blank" rel="noopener">https://github.com/xzhih/one-key-hidpi</a></p><p>ï£¿ æ­¤è„šæœ¬çš„ç›®çš„æ˜¯ä¸ºä¸­ä½åˆ†è¾¨ç‡çš„å±å¹•å¼€å¯ HiDPI é€‰é¡¹ï¼Œå¹¶ä¸”å…·æœ‰åŸç”Ÿçš„ HiDPI è®¾ç½®ï¼Œä¸éœ€è¦ RDM è½¯ä»¶å³å¯åœ¨ç³»ç»Ÿæ˜¾ç¤ºå™¨è®¾ç½®ä¸­è®¾ç½®</p><p>MacOS çš„ dpi æœºåˆ¶å’Œ win ä¸‹ä¸ä¸€æ ·ï¼Œæ¯”å¦‚ 1080p çš„å±å¹•åœ¨ win ä¸‹æœ‰ 125%ã€150% è¿™æ ·çš„ç¼©æ”¾é€‰é¡¹ï¼Œè€ŒåŒæ ·çš„å±å¹•åœ¨ MacOS ä¸‹ï¼Œç¼©æ”¾é€‰é¡¹é‡Œåªæ˜¯å•çº¯çš„è°ƒèŠ‚åˆ†è¾¨ç‡ï¼Œè¿™å°±ä½¿å¾—åœ¨é»˜è®¤åˆ†è¾¨ç‡ä¸‹å­—ä½“å’Œ UI çœ‹èµ·æ¥å¾ˆå°ï¼Œé™ä½åˆ†è¾¨ç‡åˆæ˜¾å¾—æ¨¡ç³Šã€‚</p><p>åŒæ—¶ï¼Œæ­¤è„šæœ¬ä¹Ÿå¯ä»¥é€šè¿‡æ³¨å…¥ä¿®è¡¥åçš„ EDID ä¿®å¤é—ªå±ï¼Œæˆ–è€…ç¡çœ å”¤é†’åçš„é—ªå±é—®é¢˜ï¼Œå½“ç„¶è¿™ä¸ªä¿®å¤å› äººè€Œå¼‚</p><p>å¼€æœºçš„ç¬¬äºŒé˜¶æ®µ logo æ€»æ˜¯ä¼šç¨å¾®æ”¾å¤§ï¼Œå› ä¸ºåˆ†è¾¨ç‡æ˜¯ä»¿å†’çš„</p><p>è®¾ç½®ï¼š</p><p><img src="https://pic.zhih.me/blog/posts/one-key-hidpi/hidpi-setting.jpg" alt="HiDPIæ•ˆæœ.png"></p><h2 id="ä½¿ç”¨æ–¹æ³•"><a href="#ä½¿ç”¨æ–¹æ³•" class="headerlink" title="ä½¿ç”¨æ–¹æ³•"></a>ä½¿ç”¨æ–¹æ³•</h2><p>åœ¨ç»ˆç«¯è¾“å…¥ä»¥ä¸‹å‘½ä»¤å›è½¦å³å¯</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sh -c <span class="string">"<span class="variable">$(curl -fsSL https://raw.githubusercontent.com/xzhih/one-key-hidpi/master/hidpi-zh.sh)</span>"</span></span><br></pre></td></tr></table></figure><p><img src="https://pic.zhih.me/blog/posts/one-key-hidpi/run.jpg" alt="è¿è¡Œ"></p><h2 id="æ¢å¤"><a href="#æ¢å¤" class="headerlink" title="æ¢å¤"></a>æ¢å¤</h2><p>å¦‚æœä½¿ç”¨æ­¤è„šæœ¬åï¼Œå¼€æœºæ— æ³•è¿›å…¥ç³»ç»Ÿï¼Œè¯·åˆ°æ¢å¤æ¨¡å¼ä¸­æˆ–ä½¿ç”¨ clover çš„ <code>-x</code> å®‰å…¨æ¨¡å¼è¿›å…¥ç³»ç»Ÿ ï¼Œä½¿ç”¨ç»ˆç«¯åˆ é™¤ /System/Library/Displays/Contents/Resources/Overrides ä¸‹åˆ é™¤æ˜¾ç¤ºå™¨ VendorID å¯¹åº”çš„æ–‡ä»¶å¤¹ï¼Œå¹¶æŠŠ backup æ–‡ä»¶å¤¹ä¸­çš„å¤‡ä»½å¤åˆ¶å‡ºæ¥ã€‚</p><p>å…·ä½“å‘½ä»¤å¦‚ä¸‹ï¼š</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">cd</span> /Volumes/ä½ çš„ç³»ç»Ÿç›˜/System/Library/Displays/Contents/Resources/Overrides</span><br><span class="line">VendorID=$(ioreg -l | grep <span class="string">"DisplayVendorID"</span> | awk <span class="string">'&#123;print $8&#125;'</span>)</span><br><span class="line">Vid=$(<span class="built_in">echo</span> <span class="string">"obase=16;<span class="variable">$VendorID</span>"</span> | bc | tr <span class="string">'A-Z'</span> <span class="string">'a-z'</span>)</span><br><span class="line">rm -rf ./DisplayVendorID-<span class="variable">$Vid</span></span><br><span class="line">cp -r ./backup/* ./</span><br></pre></td></tr></table></figure><blockquote><p>æœ¬æ–‡ç« å‘è¡¨äºåº•å™ªåšå®¢ <a href="https://zhih.me">https://zhih.me</a> , è½¬è½½è¯·æ³¨æ˜</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> æ•™ç¨‹ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> MacOS </tag>
            
            <tag> shell </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>é»‘è‹¹æœå®‰è£…æ•™ç¨‹</title>
      <link href="/hackintosh-install-guide/"/>
      <url>/hackintosh-install-guide/</url>
      
        <content type="html"><![CDATA[<h2 id="å¼•è¨€"><a href="#å¼•è¨€" class="headerlink" title="å¼•è¨€"></a>å¼•è¨€</h2><p>åœ¨ç‡ƒ7000 çš„ç¾¤é‡Œå‘ç°è¿˜æœ‰å¾ˆå¤šå°ä¼™ä¼´è¿›ç¾¤ï¼ŒæŒºéœ‡æƒŠçš„ï¼Œæ¯•ç«Ÿè¿™æœ¬å­è¿™ä¹ˆä¹…äº†è¿˜èƒ½ä¿æŒä¸€å®šçš„çƒ­åº¦ï¼Œä½†æ˜¯ç¾¤é‡Œçš„æ•™ç¨‹æ¯”è¾ƒè€æ—§ï¼Œå¾ˆå¤šå†…å®¹å·²ç»ä¸é€‚åˆç°åœ¨çš„æ–°ç³»ç»Ÿï¼Œäºæ˜¯å°±æœ‰äº†è¿™ä¸ªæ•™ç¨‹ã€‚</p><p>é»‘æœå®‰è£…çš„æ•™ç¨‹å¤§åŒå°å¼‚ï¼Œå°±æ˜¯å„ä¸ªæœºå‹çš„é…ç½®ä¸ä¸€æ ·ï¼Œä»è€Œå¯¼è‡´EFIä¸ä¸€æ ·ï¼Œç†è®ºä¸Šè®²ï¼Œé…ç½®å’Œç‡ƒ7000ç›¸åŒæˆ–ç›¸è¿‘çš„æœºå™¨éƒ½èƒ½æŒ‰ç…§è¿™ä¸ªæ•™ç¨‹å®‰è£…å¥½ã€‚</p><blockquote><p>å…¶ä»–æœºå‹çš„å°ä¼™ä¼´å¯ä»¥åˆ°æˆ‘çš„é»‘è‹¹æœåˆé›†é‡Œæ‰¾æ‰¾ï¼Œå¯èƒ½ä¼šæœ‰åˆé€‚ä½ çš„ EFI<br><a href="https://zhih.me/hackintosh/">https://zhih.me/hackintosh/</a></p></blockquote><h2 id="è§†é¢‘ç‰ˆ"><a href="#è§†é¢‘ç‰ˆ" class="headerlink" title="è§†é¢‘ç‰ˆ"></a>è§†é¢‘ç‰ˆ</h2><p>Bç«™ï¼š<a href="https://www.bilibili.com/video/av21503652" target="_blank" rel="noopener">https://www.bilibili.com/video/av21503652</a></p><p>YouTubeï¼š<a href="https://youtu.be/IZCF3E_oQB8" target="_blank" rel="noopener">https://youtu.be/IZCF3E_oQB8</a></p><h2 id="1-å‡†å¤‡"><a href="#1-å‡†å¤‡" class="headerlink" title="1. å‡†å¤‡"></a>1. å‡†å¤‡</h2><p>è‡³å°‘ 8G å®¹é‡çš„Uç›˜</p><p>åˆ†åŒºç²¾çµ <a href="http://www.diskgenius.cn" target="_blank" rel="noopener">http://www.diskgenius.cn</a></p><p>é»‘æœå°å…µçš„ <a href="https://zhih.me/hackintosh/#/OS-images">MacOS é•œåƒ</a></p><p>é•œåƒå†™å…¥å·¥å…·ï¼š<a href="https://www.balena.io/etcher/" target="_blank" rel="noopener">Etcher</a></p><p><del>transmac é“¾æ¥: <a href="https://pan.baidu.com/s/15QmZZLtRU1ZwMi7uCYKC-g" target="_blank" rel="noopener">https://pan.baidu.com/s/15QmZZLtRU1ZwMi7uCYKC-g</a> å¯†ç : 8dpe</del></p><h2 id="2-åˆ†é…ç¡¬ç›˜ESPåˆ†åŒº"><a href="#2-åˆ†é…ç¡¬ç›˜ESPåˆ†åŒº" class="headerlink" title="2. åˆ†é…ç¡¬ç›˜ESPåˆ†åŒº"></a>2. åˆ†é…ç¡¬ç›˜ESPåˆ†åŒº</h2><p>ç¡¬ç›˜åˆ†åŒºè¡¨ç±»å‹å¿…é¡»ä¸º GUIDï¼ŒESP åˆ†åŒºå¿…é¡»å¤§äº 200Mï¼Œæˆ‘å»ºè®®ç»™ä¸ª 220M</p><p><img src="https://pic.zhih.me/blog/posts/hackintosh-install-guide/ESPåˆ†åŒº.jpg" alt="ESPåˆ†åŒº"></p><p>åˆ†å‡ºä½ æƒ³è¦è£… MacOS çš„åˆ†åŒºï¼Œå¤§å°ä½ è‡ªå·±å®šï¼Œæ ¼å¼éšä¾¿ï¼Œå› ä¸ºå®‰è£…æ—¶è¦æŠ¹ç›˜</p><h2 id="3-å†™å…¥é•œåƒ"><a href="#3-å†™å…¥é•œåƒ" class="headerlink" title="3. å†™å…¥é•œåƒ"></a>3. å†™å…¥é•œåƒ</h2><p>å†™å…¥é•œåƒç°åœ¨å¯ä»¥ä½¿ç”¨æ›´å¥½çš„å·¥å…· <a href="https://www.balena.io/etcher/" target="_blank" rel="noopener">Etcher</a>ï¼Œå½“ç„¶ transmac ä¹Ÿæ˜¯å¯ä»¥ç”¨çš„</p><h3 id="ç¬¬ä¸€ç§æ–¹æ³•-Etcher"><a href="#ç¬¬ä¸€ç§æ–¹æ³•-Etcher" class="headerlink" title="ç¬¬ä¸€ç§æ–¹æ³• Etcher"></a>ç¬¬ä¸€ç§æ–¹æ³• Etcher</h3><ol><li>å®‰è£…åæ‰“å¼€ Etcher</li><li>é€‰æ‹©é•œåƒ</li><li>é€‰æ‹© U ç›˜</li><li>ç­‰å¾…å†™å…¥å®Œæˆ</li></ol><p><strong>è¿™æ ·å°±å¯ä»¥äº†</strong>ï¼Œæ˜¯ä¸æ˜¯å¾ˆç®€å•</p><h3 id="ç¬¬äºŒç§æ–¹æ³•-transmac"><a href="#ç¬¬äºŒç§æ–¹æ³•-transmac" class="headerlink" title="ç¬¬äºŒç§æ–¹æ³• transmac"></a>ç¬¬äºŒç§æ–¹æ³• transmac</h3><p><strong>æ ¼å¼åŒ–</strong></p><p>ä»¥ç®¡ç†å‘˜èº«ä»½è¿è¡Œ transmacï¼Œ<kbd>å³é”®</kbd>ç‚¹å‡»ä½ çš„Uç›˜ï¼Œé€‰æ‹© <code>Format Disk for Mac</code>ï¼Œå…¨é€‰æ‹©ç¡®è®¤ç„¶åç­‰å®ƒæ ¼å¼åŒ–å®Œï¼Œwin10 å¯èƒ½ä¼šæç¤ºè¦æƒ³ä½¿ç”¨Uç›˜å¿…é¡»å¯¹å…¶æ ¼å¼åŒ–ï¼Œç‚¹å–æ¶ˆã€‚</p><p><img src="https://pic.zhih.me/blog/posts/hackintosh-install-guide/æ ¼å¼åŒ–.jpg" alt="æ ¼å¼åŒ–"></p><p><strong>å†™å…¥</strong></p><p>å†æ¬¡<kbd>å³é”®</kbd>ç‚¹å‡» U ç›˜ï¼Œé€‰æ‹© <code>Restore with Disk Image</code>ï¼Œé€‰æ‹©é•œåƒç‚¹å‡» OKï¼Œé™é™ç­‰å¾…å†™å…¥å®Œæˆ</p><p><img src="https://pic.zhih.me/blog/posts/hackintosh-install-guide/å†™å…¥é•œåƒ.jpg" alt="å†™å…¥é•œåƒ"></p><p>å†™å…¥å®Œæˆï¼Œwin å¯èƒ½è¿˜ä¼šæç¤ºä¸€äº›æ ¼å¼åŒ–ä¹‹ç±»çš„ï¼Œä¸ç”¨ç†ä¼š</p><h2 id="4-å…¶ä»–è®¾ç½®"><a href="#4-å…¶ä»–è®¾ç½®" class="headerlink" title="4. å…¶ä»–è®¾ç½®"></a>4. å…¶ä»–è®¾ç½®</h2><h3 id="BIOS-è®¾ç½®"><a href="#BIOS-è®¾ç½®" class="headerlink" title="BIOS è®¾ç½®"></a>BIOS è®¾ç½®</h3><p>é‡å¯è¿›å…¥ BIOSï¼Œè®¾ç½®ç¡¬ç›˜ AHCIã€å…³é—­å®‰å…¨å¯åŠ¨ï¼Œä¿å­˜é€€å‡º</p><p><img src="https://pic.zhih.me/blog/posts/hackintosh-install-guide/BIOSè®¾ç½®1.jpg" alt="BIOSè®¾ç½®"></p><p><img src="https://pic.zhih.me/blog/posts/hackintosh-install-guide/BIOSè®¾ç½®2.jpg" alt="BIOSè®¾ç½®"></p><h3 id="Uç›˜å¯åŠ¨"><a href="#Uç›˜å¯åŠ¨" class="headerlink" title="Uç›˜å¯åŠ¨"></a>Uç›˜å¯åŠ¨</h3><p>å†æ¬¡é‡å¯ï¼Œè¿›å…¥å¯åŠ¨é¡¹é€‰æ‹©ï¼ˆ dell æ˜¯åœ¨æ˜¾ç¤º logo æ—¶æŒ‰ <kbd>F12</kbd>ï¼‰</p><p>é€‰æ‹©ä½ çš„Uç›˜</p><p><img src="https://pic.zhih.me/blog/posts/hackintosh-install-guide/Uç›˜å¯åŠ¨1.jpg" alt="Uç›˜å¯åŠ¨"></p><p>å¦‚æœä½ çš„æ²¡æ˜¾ç¤ºï¼Œå¯ä»¥åœ¨ BIOS é‡Œæ·»åŠ </p><p><img src="https://pic.zhih.me/blog/posts/hackintosh-install-guide/Uç›˜å¯åŠ¨2.jpg" alt="Uç›˜å¯åŠ¨"></p><h2 id="5-å®‰è£…"><a href="#5-å®‰è£…" class="headerlink" title="5. å®‰è£…"></a>5. å®‰è£…</h2><p>åœ¨ clover è®¾ç½®é‡Œé€‰æ‹© config ä¸º <code>config_HD615_620_630_640_650.plist</code></p><p><img src="https://pic.zhih.me/blog/posts/hackintosh-install-guide/cloverå¯åŠ¨è®¾ç½®.jpg" alt="cloverå¯åŠ¨è®¾ç½®"></p><p>è¿”å›é€‰æ‹© MacOS å®‰è£…å¼•å¯¼é¡¹</p><h3 id="æŠ¹ç›˜"><a href="#æŠ¹ç›˜" class="headerlink" title="æŠ¹ç›˜"></a>æŠ¹ç›˜</h3><p>ä»¥ä¸Šä¸å‡ºæ„å¤–ï¼Œå°±èƒ½çœ‹åˆ° MacOS çš„æ¢å¤æ¨¡å¼äº†</p><p>è¿›å…¥ç£ç›˜å·¥å…·</p><p>é€‰æ‹©ä½ è¦å®‰è£…åˆ°çš„åˆ†åŒºï¼Œç‚¹å‡»æŠ¹æ‰ï¼Œé€‰æ‹©æ ¼å¼ä¸º <code>MacOSæ‰©å±•ï¼ˆæ—¥å¿—å¼ï¼‰</code>ï¼ŒæŠ¹æ‰</p><p><img src="https://pic.zhih.me/blog/posts/hackintosh-install-guide/æŠ¹ç›˜.jpg" alt="æŠ¹ç›˜"></p><p>æŠ¹ç›˜å‡ºç°é”™è¯¯çš„ï¼Œä¸€èˆ¬æ˜¯åˆ†åŒºæ‰€åœ¨ç¡¬ç›˜çš„ ESP åˆ†åŒºä¸è¶³ 200M å¯¼è‡´çš„</p><h3 id="å®‰è£…-MacOS"><a href="#å®‰è£…-MacOS" class="headerlink" title="å®‰è£… MacOS"></a>å®‰è£… MacOS</h3><p>é€€å‡ºç£ç›˜å·¥å…·ï¼Œé€‰æ‹©å®‰è£… MacOS</p><p>ä¹‹åå°±èƒ½æ­£å¸¸å®‰è£…äº†ï¼Œå…·ä½“çš„æˆ‘å°±ä¸ä¸Šå›¾äº†ï¼Œæƒ³çœ‹è¿‡ç¨‹å°±å»çœ‹è§†é¢‘ç‰ˆçš„å§</p><p>å®‰è£…ä¼šæœ‰ 3 ä¸ªé˜¶æ®µ</p><ul><li><p>ç¬¬ä¸€é˜¶æ®µï¼Œç¨‹åºæŠŠæ–‡ä»¶å†™å…¥ç¡¬ç›˜ï¼Œç„¶åä¼šè‡ªåŠ¨é‡å¯ï¼Œé€‰æ‹©Uç›˜å¼•å¯¼è¿›å…¥ cloverï¼Œå†æ¬¡è®¾ç½® configï¼Œé€€å‡ºé€‰æ‹©æ–°å‡ºç°çš„å¼•å¯¼é¡¹</p></li><li><p>ç¬¬äºŒé˜¶æ®µï¼Œç¨‹åºç»§ç»­è¿›è¡Œç³»ç»Ÿå®‰è£…ï¼Œå®Œæˆåä¼šè‡ªåŠ¨é‡å¯ï¼ŒåŒæ ·éœ€è¦é€‰æ‹©Uç›˜å¼•å¯¼å’Œ config è®¾ç½®</p></li><li><p>ç¬¬ä¸‰é˜¶æ®µï¼Œç³»ç»Ÿå®‰è£…å®Œæˆï¼Œè¿›è¡Œä¸€äº›è‡ªå®šä¹‰è®¾ç½®ï¼Œè¿›å…¥ç³»ç»Ÿ</p></li></ul><h2 id="6-æ›´æ¢EFIï¼Œå®ç°ç¡¬ç›˜å¼•å¯¼å’Œå…¶ä»–é©±åŠ¨"><a href="#6-æ›´æ¢EFIï¼Œå®ç°ç¡¬ç›˜å¼•å¯¼å’Œå…¶ä»–é©±åŠ¨" class="headerlink" title="6. æ›´æ¢EFIï¼Œå®ç°ç¡¬ç›˜å¼•å¯¼å’Œå…¶ä»–é©±åŠ¨"></a>6. æ›´æ¢EFIï¼Œå®ç°ç¡¬ç›˜å¼•å¯¼å’Œå…¶ä»–é©±åŠ¨</h2><p>å®‰è£…å¥½ç³»ç»Ÿåï¼Œä¸€äº›ç¡¬ä»¶æ˜¯æ²¡æœ‰é©±åŠ¨çš„ï¼Œè¿™æ˜¯å°±éœ€è¦ç”¨æ›¿æ¢ EFI äº†ï¼Œè€Œä¸”ä¹‹å‰çš„ EFI æ˜¯é•œåƒè‡ªå¸¦çš„ï¼Œå¹¶ä¸”åœ¨Uç›˜é‡Œï¼Œç°åœ¨æˆ‘ä»¬è¦ç”¨ç¡¬ç›˜å¼•å¯¼</p><h3 id="å·¥å…·"><a href="#å·¥å…·" class="headerlink" title="å·¥å…·"></a>å·¥å…·</h3><p>ä¸‹è½½ <a href="https://mackie100projects.altervista.org/download-clover-configurator/" target="_blank" rel="noopener">Clover Configurator</a></p><p><img src="https://pic.zhih.me/blog/posts/hackintosh-install-guide/ä¸‹è½½CloverConfigurator.jpg" alt="Clover Configurator"></p><p>ä¸‹è½½ <a href="https://zhih.me/dell-7460-7560-hackintosh">å†°æ°´çš„EFI</a></p><p><img src="https://pic.zhih.me/blog/posts/hackintosh-install-guide/å†°æ°´çš„EFI.jpg" alt="å†°æ°´çš„EFI"></p><h3 id="æ›¿æ¢"><a href="#æ›¿æ¢" class="headerlink" title="æ›¿æ¢"></a>æ›¿æ¢</h3><p>æ‰“å¼€ Clover Configuratorï¼Œç‚¹å‡» <code>Mount EFI</code> ï¼ŒæŒ‚è½½å®‰è£…ç£ç›˜ä¸Š ESP åˆ†åŒº</p><p>æ‰“å¼€åˆ†åŒºï¼ŒæŠŠä½ çš„æœºå‹æ‰€å¯¹åº”çš„ EFI æ–‡ä»¶å¤¹æ‰”åˆ°åˆ†åŒºé‡Œ</p><p><img src="https://pic.zhih.me/blog/posts/hackintosh-install-guide/æ›¿æ¢.jpg" alt="æ›¿æ¢"></p><p>å¯ä»¥æ‹”æ‰Uç›˜é‡å¯äº†</p><h2 id="7-åç»­"><a href="#7-åç»­" class="headerlink" title="7. åç»­"></a>7. åç»­</h2><p>å¯åŠ¨é»˜è®¤è¿› win çš„ï¼Œå¯ä»¥åœ¨ BIOS é‡Œè®¾ç½® clover å¯åŠ¨é¡¹ä¸ºç¬¬ä¸€ä½</p><p>äº®åº¦æ— æ³•è°ƒèŠ‚çš„ï¼Œå¯ä»¥ä½¿ç”¨ kext utility é‡å»ºç¼“å­˜ï¼Œé‡å¯ç”Ÿæ•ˆ</p><p>å­—ä½“å¤ªå°ï¼Ÿå¯ä»¥ä½¿ç”¨æˆ‘çš„ HIDPI è„šæœ¬å¼€å¯ç¼©æ”¾</p><blockquote><p>æœ¬æ–‡ç« å‘è¡¨äºåº•å™ªåšå®¢ <a href="https://zhih.me">https://zhih.me</a> , è½¬è½½è¯·æ³¨æ˜</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> æ•™ç¨‹ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> hackintosh </tag>
            
            <tag> MacOS </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>æˆ‘æ˜¯å¦‚ä½•åœ¨128Må†…å­˜çš„vpsä¸Šå®‰è£…lnmpçš„</title>
      <link href="/lnmp-on-128m-ram-vps/"/>
      <url>/lnmp-on-128m-ram-vps/</url>
      
        <content type="html"><![CDATA[<h2 id="å¼•è¨€"><a href="#å¼•è¨€" class="headerlink" title="å¼•è¨€"></a>å¼•è¨€</h2><p>å°é¢é‚£å¼ å›¾å’Œè¿™ç¯‡æ–‡ç« æ— å…³ğŸ˜‚ï¼Œé‚£æ˜¯ä¹‹å‰åœ¨å­¦æ ¡çš„æ—¶å€™æ‹çš„ï¼Œä¸€å° 64M å¤è‘£å¤§è„‘å£³è£… win meï¼Œç„¶åç©ä¸‰ç»´å¼¹çƒğŸ¤ª 2333</p><p><img src="https://pic.zhih.me/blog/posts/lnmp-on-128m-ram-vps/winme.jpg" alt="ä¸‰ç»´å¼¹çƒ"></p><p>ä½œä¸ºä¸€ä¸ªæ•´å¤©æŠ˜è…¾ VPS çš„åšä¸»ï¼Œæ‰‹é‡Œå°‘ä¸äº†å„ç§ä¾¿å®œçš„ä½é…å°é¸¡ï¼Œä»Šå¤©æˆ‘è¦ç¥­å‡ºæˆ‘é‚£ç»å¸¸è¢« BAN ğŸ˜’çš„ 128M å†…å­˜å°é¸¡ï¼Œä¸ºå¤§å®¶å†™ä¸€ç¯‡å°å†…å­˜ VPS å®‰è£… lnmp çš„æ•™ç¨‹ï¼Œå¹¶ä¸”ï¼Œæˆ‘è¦è®©å®ƒæŠŠ WordPress è·‘èµ·æ¥ã€‚</p><p>å…ˆä¸Šé…ç½®ï¼š<br>CPUï¼šIntel(R) Xeon(R) CPU X5560 @ 2.80GHz å•æ ¸<br>å†…å­˜ï¼š128M<br>ç¡¬ç›˜ï¼š2GB<br>ç³»ç»Ÿï¼šdebian-8.0-x86_64<br>è™šæ‹ŸåŒ–ï¼šopenVZ</p><p>å¯ä»¥è¯´è¿™å°é¸¡æ˜¯ç›¸å½“æé™äº†ï¼Œå½“ç„¶æˆ‘è¿˜æœ‰ä¸€å°ä¼ å®¶å® 64M å†…å­˜çš„ï¼Œä½†æ˜¯åœ¨ä¸Šé¢è£… lnmp é‡åˆ°äº†ä¸€äº›éº»çƒ¦ï¼Œå°±æ”¾å¼ƒäº†ğŸ˜‚</p><h2 id="ä¸€ã€è½¯ä»¶æº"><a href="#ä¸€ã€è½¯ä»¶æº" class="headerlink" title="ä¸€ã€è½¯ä»¶æº"></a>ä¸€ã€è½¯ä»¶æº</h2><p>ç”±äºé…ç½®å¤ªä½ï¼Œlnmp æ‰€éœ€çš„ Nginx MySQL PHP è¦æ˜¯ç”¨ç¼–è¯‘çš„æ–¹å¼å®‰è£…ï¼Œåœ¨è¿‡ç¨‹ä¸­åŸºæœ¬å°±å®•æœºäº†ï¼Œæ‰€ä»¥è¿™é‡Œæ‰ç”¨çš„æ˜¯ apt çš„æ–¹å¼è¿›è¡Œå®‰è£…ã€‚</p><p>åœ¨æ‰§è¡Œä»¥ä¸‹æ“ä½œå‰ï¼Œå»ºè®®å…ˆè¿è¡Œä¸€ä¸‹å‘½ä»¤ï¼Œæ›´æ–°å’Œå®‰è£…ä¸€äº›åŒ…ï¼Œä»¥é˜²å‡ºé”™</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">apt-get update &amp;&amp; apt-get upgrade</span><br><span class="line">apt-get install curl wget</span><br></pre></td></tr></table></figure><h3 id="1-æ·»åŠ è½¯ä»¶æº"><a href="#1-æ·»åŠ è½¯ä»¶æº" class="headerlink" title="1. æ·»åŠ è½¯ä»¶æº"></a>1. æ·»åŠ è½¯ä»¶æº</h3><p>ç³»ç»Ÿæ˜¯ debian8ï¼Œè‡ªå¸¦æºå†…æ²¡æœ‰ PHP7ï¼Œæ‰€ä»¥æ·»åŠ ä¸€ä¸ª <a href="http://www.dotdeb.org" target="_blank" rel="noopener">dotdeb</a> æºï¼Œå®ƒé‡Œé¢æœ‰ debian7ã€debian8 çš„å„ç§è½¯ä»¶åŒ…ï¼ŒåŒæ—¶ä»–ä»¬ä¹Ÿæä¾›ä¸–ç•Œå„åœ°çš„<a href="https://www.dotdeb.org/mirrors/" target="_blank" rel="noopener">é•œåƒ</a>ã€‚</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">vi /etc/apt/sources.list</span><br><span class="line"><span class="comment"># åœ¨ sources.list é‡Œæ·»åŠ ä¸¤è¡Œ (deb å’Œ deb-src)</span></span><br></pre></td></tr></table></figure><p>æˆ‘çš„ vps åœ¨ç¾å¸ï¼Œæ‰€ä»¥æ·»åŠ äº†ä»–ä»¬çš„ç¾å›½é•œåƒ</p><figure class="highlight vim"><table><tr><td class="code"><pre><span class="line"><span class="keyword">deb</span> http://mirrors.asnet.<span class="keyword">am</span>/dotdeb/ jessie <span class="keyword">all</span></span><br><span class="line"><span class="keyword">deb</span>-src http://mirrors.asnet.<span class="keyword">am</span>/dotdeb/ jessie <span class="keyword">all</span></span><br></pre></td></tr></table></figure><p>å¦‚æœä½ ç›´æ¥ä»å®˜ç½‘å¤åˆ¶è¿‡æ¥ï¼Œæˆ–è€…æ˜¯ä½ çš„ç³»ç»Ÿæ˜¯ debian7ï¼Œè®°å¾—ä¿®æ”¹ç½‘å€åé¢çš„ç‰ˆæœ¬åã€‚</p><h3 id="2-å®‰è£…-GnuPG-å¯†åŒ™"><a href="#2-å®‰è£…-GnuPG-å¯†åŒ™" class="headerlink" title="2. å®‰è£… GnuPG å¯†åŒ™"></a>2. å®‰è£… GnuPG å¯†åŒ™</h3><p>GPGä¸»è¦æ˜¯å®ç°å®˜æ–¹å‘å¸ƒçš„åŒ…çš„ç­¾åã€‚</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">wget https://www.dotdeb.org/dotdeb.gpg</span><br><span class="line">sudo apt-key add dotdeb.gpg</span><br></pre></td></tr></table></figure><h3 id="3-æºæ·»åŠ å®Œæ¯•"><a href="#3-æºæ·»åŠ å®Œæ¯•" class="headerlink" title="3. æºæ·»åŠ å®Œæ¯•"></a>3. æºæ·»åŠ å®Œæ¯•</h3><p>è¿è¡Œ <code>apt-get update &amp;&amp; apt-get upgrade</code>ï¼Œç°åœ¨ä½ åº”è¯¥èƒ½ä» dotdeb ä¸Šè·å–è½¯ä»¶äº†ã€‚</p><h2 id="äºŒã€è½¯ä»¶åŒ…"><a href="#äºŒã€è½¯ä»¶åŒ…" class="headerlink" title="äºŒã€è½¯ä»¶åŒ…"></a>äºŒã€è½¯ä»¶åŒ…</h2><h3 id="1-Nginx"><a href="#1-Nginx" class="headerlink" title="1. Nginx"></a>1. Nginx</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">apt-get install nginx -y</span><br></pre></td></tr></table></figure><p>æ‰“å¼€æµè§ˆå™¨ï¼Œè¾“å…¥ä½ çš„ IPï¼Œèƒ½æ˜¾ç¤º <code>Welcome to nginx!</code>ï¼Œå°±è¯´æ˜å®‰è£…æˆåŠŸäº†ã€‚</p><h3 id="2-PHP7"><a href="#2-PHP7" class="headerlink" title="2. PHP7"></a>2. PHP7</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">apt-get install php7.0 php7.0-cgi php7.0-cli php7.0-fpm php7.0-mysql php7.0-odbc php7.0-opcache -y</span><br></pre></td></tr></table></figure><p>ä»¥ä¸Šæˆ‘åªå®‰è£…äº†å‡ ä¸ª moduleï¼Œå¦‚æœ‰éœ€è¦ï¼Œè‡ªå·±å®‰è£…å…¶ä»–çš„ã€‚</p><p>å®‰è£…æˆåŠŸåï¼Œè¿è¡Œ <code>php -v</code> å¯ä»¥çœ‹åˆ° PHP çš„ç‰ˆæœ¬ä¿¡æ¯ã€‚</p><h3 id="3-MySQL"><a href="#3-MySQL" class="headerlink" title="3. MySQL"></a>3. MySQL</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">apt-get install mysql-client mysql-server -y</span><br></pre></td></tr></table></figure><p>è¾“å…¥å‘½ä»¤åï¼Œä¼šè¿›è¡Œå®‰è£…ï¼Œè¿‡ç¨‹ä¸­ä¼šæœ‰è¾“å…¥å¯†ç çš„æç¤ºæ¡†ï¼ŒæŒ‰æç¤ºæ“ä½œå³å¯ã€‚</p><p>è¿è¡Œ <code>mysql -u root -p</code>ï¼Œè¾“å…¥å¯†ç ï¼Œèƒ½è¿›å…¥ MySQL å°±è¯´æ˜è£…ä¸Šäº†ã€‚</p><h2 id="ä¸‰ã€å®‰è£…-WordPress"><a href="#ä¸‰ã€å®‰è£…-WordPress" class="headerlink" title="ä¸‰ã€å®‰è£… WordPress"></a>ä¸‰ã€å®‰è£… WordPress</h2><p>è‡³æ­¤ lnmp å·²ç»å®‰è£…å®Œæ¯•äº†ï¼Œæˆ‘ä»¬å…ˆçœ‹çœ‹ç›¸å…³çš„ç®¡ç†å‘½ä»¤å†å®‰è£… WordPressã€‚</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># å¯åŠ¨|åœæ­¢|é‡å¯</span></span><br><span class="line">/etc/init.d/nginx start|stop|restart</span><br><span class="line">/etc/init.d/php7.0-fpm start|stop|restart</span><br><span class="line">/etc/init.d/mysql start|stop|restart</span><br></pre></td></tr></table></figure><p>å¥½äº†ï¼Œå’±ä»¬å¼€å§‹å®‰è£… WordPress</p><p>è¿™éƒ¨åˆ†æˆ‘å°±ä¸å¤šè¯´äº†ï¼Œé…ç½®æ•™ç¨‹ä¹‹ç±»çš„å¾ˆå¤šï¼ŒWPå®˜ç½‘çš„å®‰è£…æ–‡æ¡£ä¹Ÿç›¸å½“æ¸…æ™°ã€‚</p><p>å…¶å®å°±æ˜¯ä»¥ä¸‹æ­¥éª¤ï¼š</p><ol><li>åˆ›å»º Nginx é…ç½®æ–‡ä»¶</li><li>åœ¨ MySQL é‡Œåˆ›å»ºæ•°æ®åº“</li><li>ä¸‹è½½ã€è§£å‹ WordPress ç¨‹åºåŒ…</li><li>è¿›å…¥ç½‘é¡µå®‰è£…</li></ol><p>è·‘å¾—åŠ¨æ²¡å•¥ï¼Œå°±æ˜¯çœ‹çœ‹è¿™å°é¸¡çš„æ‰¿è½½èƒ½åŠ›ï¼Œæˆ‘è¿™é‡Œä½¿ç”¨ ab å‘½ä»¤å¯¹é¦–é¡µè¿›è¡Œå‹åŠ›æµ‹è¯•ï¼Œå¹¶ä¸”é¦–é¡µä¹Ÿå°±ä¸€ç¯‡æ–‡ç« åˆ—è¡¨ï¼Œæƒ…å†µå¦‚ä¸‹å›¾ï¼š</p><p><img src="https://pic.zhih.me/blog/posts/lnmp-on-128m-ram-vps/å‹åŠ›æµ‹è¯•.jpg" alt="å‹åŠ›æµ‹è¯•"></p><p>åœ¨åš100ä¸ªå¹¶å‘ï¼Œè®¿é—®10000æ¬¡çš„æµ‹è¯•ä¸­ï¼Œåœ¨è¿›è¡Œåˆ°ç¬¬7143ä¸ªè¯·æ±‚çš„æ—¶å€™ï¼Œå°é¸¡çˆ†äº†ï¼Œå®Œå…¨æ— æ³•è®¿é—®ï¼Œè¿‡äº†ä¸€ä¼šæ‰æ¢å¤è¿‡æ¥ï¼Œçœ‹æ¥å¯¹å®ƒçš„è¦æ±‚ä¸èƒ½å¤ªé«˜å•ŠğŸ˜‚ã€‚</p><p>å½“ç„¶ï¼Œä½¿ç”¨WPä¹Ÿè¦ä½¿ç”¨é™æ€åŒ–æ’ä»¶æ‰èƒ½æé«˜æ‰¿è½½èƒ½åŠ›ï¼Œæˆ‘å°±æ‡’å¾—è¯•äº†</p><h2 id="æœ€å"><a href="#æœ€å" class="headerlink" title="æœ€å"></a>æœ€å</h2><p>å…¶å®è¿™ç¯‡æ–‡ç« å°±æ˜¯ç»™å°é¸¡è·‘ä¸ª lnmpï¼Œç»™å®ƒç‚¹å‹åŠ›ï¼Œæˆ‘è¿‡è¿‡æ‰‹ç˜¾ï¼Œä¹Ÿè¯å®ä¸€ä¸‹ 128M çš„å°å†…å­˜vpsæ˜¯æœ‰èƒ½åŠ›æ­å»ºè®¿é—®é‡å°‘çš„ WP åšå®¢çš„ã€‚</p><p>ä½†æ˜¯ï¼Œæ—¢ç„¶å†…å­˜è¿™ä¹ˆå°ï¼Œä½•ä¸ç”¨ hexo é‚£ç§é™æ€åšå®¢å‘¢ã€‚</p><p>è¿™ç¯‡æ–‡ç« ä»…ä½œä¸ºæ–°æ‰‹å®‰è£… lnmp æ•™ç¨‹ï¼Œç…§é¡¾é‚£äº›ä½ä»·ä¹°äº†ä½é…ç½® vps çš„åŒå­¦ï¼Œç¥ä½ ä»¬æŠ˜è…¾æ„‰å¿«ã€‚</p><p>å¦‚æœä½ æƒ³è´­ä¹° vpsï¼Œå¯ä»¥çœ‹çœ‹ <a href="https://m.do.co/c/5ddae9064d7f" target="_blank" rel="noopener">DigitalOcean</a></p><p>è¿™é‡Œæ˜¯æˆ‘çš„ä¼˜æƒ é“¾æ¥ï¼š<a href="https://m.do.co/c/5ddae9064d7f" target="_blank" rel="noopener">https://m.do.co/c/5ddae9064d7f</a>ï¼Œé€šè¿‡è¿™ä¸ªé“¾æ¥æ³¨å†Œï¼Œä½ å¯ä»¥å¾—åˆ°10ç¾å…ƒç”¨æ¥è´­ä¹°vpsã€‚</p><blockquote><p>æœ¬æ–‡ç« å‘è¡¨äºåº•å™ªåšå®¢ <a href="https://zhih.me">https://zhih.me</a> , è½¬è½½è¯·æ³¨æ˜</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> æ•™ç¨‹ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Linux </tag>
            
            <tag> lnmp </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>æˆ´å°”ç‡ƒ7000é»‘è‹¹æœEFI</title>
      <link href="/dell-7460-7560-hackintosh/"/>
      <url>/dell-7460-7560-hackintosh/</url>
      
        <content type="html"><![CDATA[<h2 id="å¼•è¨€"><a href="#å¼•è¨€" class="headerlink" title="å¼•è¨€"></a>å¼•è¨€</h2><p>ç®€å•è¯´ä¸‹æˆ‘çš„ç”µè„‘é…ç½®ï¼š<br>CPU: i5-7200u<br>æ˜¾å¡: HD620 / 940MX<br>RAM: 2x4G DDR4 2400MHz (ä½†æ˜¯è¿™ä¸ªUåªæ”¯æŒ2133MHzï¼Œä¸è¿‡ä¹Ÿæ˜¯å¯ä»¥äº†)<br>ç¡¬ç›˜: SATA3 500g æœºæ¢°ç¡¬ç›˜ / M.2 SATA3 128g SSD<br>å£°å¡: ALC 3246<br>ç½‘å¡: DW 1830ï¼ˆåŸæœ¬æ˜¯ä¸€å¼ ç‰™è†å‚çš„åƒåœ¾å¡ï¼Œå°±æ›´æ¢äº†é»‘æœèƒ½é©±åŠ¨çš„å¡ï¼‰</p><p>åœ¨ä¹°è¿™å°ç”µè„‘ä¹‹å‰å°±å¬è¯´è¿‡ hackintoshï¼Œä¹Ÿå°±æ˜¯é»‘è‹¹æœã€‚ä½†æ˜¯éƒ½æ²¡æœ‰å°è¯•è¿‡ï¼Œå› ä¸ºä¸€èˆ¬çš„ç¬”è®°æœ¬é»‘èµ·æ¥éº»çƒ¦å¤šå¤šï¼Œå¾ˆéš¾åšåˆ°â€œå¯ç”¨â€çŠ¶æ€ï¼Œè€Œè¿™å°ç”µè„‘ä¸ä»…æœ‰ä¸¤ä¸ªå†…å­˜æ’æ§½ã€ä¸€ä¸ª M.2 æ¥å£ï¼ˆä¸æ”¯æŒ nvmeï¼‰ã€ä¸€ä¸ª SATA3 æ¥å£ï¼Œè¿˜æœ‰ä¸€ä¸ªå¯æ›´æ¢çš„ç½‘å¡ï¼Œå¾ˆé€‚åˆç”¨æ¥é»‘ã€‚</p><p>è¿™æ˜¯æˆ‘ç¬¬ä¸€æ¬¡åŠ¨æ‰‹è£…é»‘æœï¼Œæ‰€ä»¥é¦–å…ˆå¤§é‡çš„çœ‹å¸–ï¼Œå„ç§é€›<a href="http://bbs.pcbeta.com/forum.php?gid=86" target="_blank" rel="noopener">è¿œæ™¯è®ºå›</a>ï¼Œåœ¨å„ç§çˆ¬æ¥¼ä¹‹åï¼Œå¿ƒé‡Œç»ˆäºæœ‰ç‚¹åº•äº†ï¼Œç„¶åæ„Ÿè°¢åŒæœºå‹çš„ @è®¾ä¸ºä¸»é¡µï¼Œä»–åº”è¯¥æ˜¯ç¬¬ä¸€ä¸ªåœ¨è¿™å°æœºå­è£…ä¸Šçš„äººï¼Œä»–è´¡çŒ®äº†æœ€åˆç‰ˆçš„ EFIã€‚æˆ‘èŠ±äº†ä¸€ä¸ªä¸‹åˆç»ˆäºè£…ä¸ŠğŸ˜€ï¼Œå…¶å®æ„Ÿè§‰ä¸æ˜¯éš¾è£…ï¼Œæ˜¯å‡ºç°é—®é¢˜çš„æ—¶å€™ä¸çŸ¥é“æ€ä¹ˆè§£å†³ï¼Œè¿˜å¥½æˆ‘æ²¡é‡åˆ°å¤ªå¤šé—®é¢˜ã€‚</p><p>åæ¥å„ç§æ‰¾é©±åŠ¨ï¼Œå­¦ä¹ äº†å¾ˆå¤šä¸œè¥¿ï¼Œå°±è‡ªå·±å°è¯•é…ç½® EFIï¼Œå¾ˆç®€å•çš„å°±é…ç½®å‡ºäº†è¿™ä¸ª EFIã€‚å…¶ä»–æœºå‹ï¼Œé…ç½®ç›¸åŒæˆ–è€…å¤§è‡´ç›¸åŒçš„åŒå­¦å¯ä»¥å°è¯•ä½¿ç”¨è¿™ä¸ª EFIã€‚</p><blockquote><p>å…¶ä»–æœºå‹çš„å°ä¼™ä¼´å¯ä»¥åˆ°æˆ‘çš„é»‘è‹¹æœåˆé›†é‡Œæ‰¾æ‰¾ï¼Œå¯èƒ½ä¼šæœ‰åˆé€‚ä½ çš„ EFI<br><a href="https://zhih.me/hackintosh/">https://zhih.me/hackintosh/</a></p></blockquote><h2 id="è¯´æ˜"><a href="#è¯´æ˜" class="headerlink" title="è¯´æ˜"></a>è¯´æ˜</h2><p>æ­¤åˆé›†é€‚ç”¨äºæˆ´å°”ç‡ƒ 7000 ç³»åˆ—ç¬¬ä¸€ç¬¬äºŒä»£å‹å·ä¸º 7460/7560/7472/7572 çš„ç¬”è®°æœ¬ç”µè„‘<br>EFI å¯ç›´æ¥ç”¨äºå®‰è£…å’Œæ—¥å¸¸ä½¿ç”¨</p><p>é¡¹ç›®åœ°å€ï¼š<a href="https://github.com/xzhih/dell-7460-7560-hackintosh" target="_blank" rel="noopener">https://github.com/xzhih/dell-7460-7560-hackintosh</a></p><p>SSDT hotpatch æ¥è‡ª<a href="https://github.com/RehabMan/OS-X-Clover-Laptop-Config" target="_blank" rel="noopener">RehabMan</a></p><p>æ–‡ä»¶åˆ—è¡¨ï¼š</p><ol><li>EFI (å¿…é¡»)</li><li><a href="https://github.com/xzhih/one-key-hidpi" target="_blank" rel="noopener">HIDPI å·²è½¬ç§»åˆ°å•ç‹¬çš„ä»“åº“</a> (å¯é€‰)</li><li>ç½‘å¡é©±åŠ¨ (å¯é€‰)</li><li>é»‘æœå°å…µçš„ ALCPlugFix (è¯¦ç»†è¯´æ˜<a href="https://github.com/daliansky/ALCPlugFix/blob/master/README.md" target="_blank" rel="noopener">æ¥æºä¼ é€é—¨</a>)</li></ol><h2 id="ä½¿ç”¨æ–¹æ³•"><a href="#ä½¿ç”¨æ–¹æ³•" class="headerlink" title="ä½¿ç”¨æ–¹æ³•"></a>ä½¿ç”¨æ–¹æ³•</h2><h3 id="1-EFI"><a href="#1-EFI" class="headerlink" title="1. EFI"></a>1. EFI</h3><p>å®‰è£…æ—¶ï¼ˆä¸ä¿è¯èƒ½é¡ºåˆ©å®‰è£…ï¼‰ï¼šä½¿ç”¨ transmac å†™å…¥é•œåƒè‡³ U ç›˜åï¼Œæ‹·è´ EFI åˆ° U ç›˜ ESP åˆ†åŒºä¸­ï¼Œé‡å¯æŒ‰ <kbd>F12</kbd> é€‰æ‹© U ç›˜å¯åŠ¨å³å¯å¼€å§‹å®‰è£…</p><p>å…·ä½“å®‰è£…æ•™ç¨‹è¯·çœ‹<a href="https://zhih.me/hackintosh-install-guide/">æˆ‘çš„æ•™ç¨‹</a></p><p>æ—¥å¸¸ä½¿ç”¨ï¼šå®‰è£…å¥½ç³»ç»Ÿåï¼Œä½¿ç”¨ <code>clover configurator</code> æŒ‚è½½ MacOS æ‰€åœ¨ç¡¬ç›˜çš„ ESP åˆ†åŒºï¼ŒæŠŠ EFI æ‹·è´è¿›å»ï¼Œé‡å¯æŒ‰ <kbd>F2</kbd> è¿›å…¥ BIOS è®¾ç½®æ­¤å¼•å¯¼ä¸ºé¦–é€‰ï¼Œä¿å­˜é‡å¯å³å¯</p><h3 id="2-å£°å¡ã€è€³æœº"><a href="#2-å£°å¡ã€è€³æœº" class="headerlink" title="2. å£°å¡ã€è€³æœº"></a>2. å£°å¡ã€è€³æœº</h3><p>å£°å¡é©±åŠ¨éƒ½å·²ç»æœ‰äº†ï¼Œåªéœ€è¦è¿›å…¥ <code>é»‘æœå°å…µçš„ALCPlugFix</code> è¿™ä¸ªæ–‡ä»¶å¤¹ï¼ŒåŒå‡» <code>install...</code> è¿è¡Œå³å¯ï¼Œå¯ä»¥è§£å†³å”¤é†’æ— å£°ã€è€³æœºæ— å£°ã€è€³æœºæ‚éŸ³ç­‰é—®é¢˜</p><h3 id="3-ä¸€é”®å¼€å¯HIDPIå¹¶æ³¨å…¥EDID"><a href="#3-ä¸€é”®å¼€å¯HIDPIå¹¶æ³¨å…¥EDID" class="headerlink" title="3. ä¸€é”®å¼€å¯HIDPIå¹¶æ³¨å…¥EDID"></a>3. ä¸€é”®å¼€å¯HIDPIå¹¶æ³¨å…¥EDID</h3><p>æ­¤ä¸€é”®å‘½ä»¤å¯å¼€å¯æ¥è¿‘åŸç”Ÿçš„ HIDPI è®¾ç½®ï¼Œä¸éœ€è¦RDMè½¯ä»¶å³å¯åœ¨ç³»ç»Ÿæ˜¾ç¤ºå™¨è®¾ç½®ä¸­è®¾ç½®</p><p>ä»“åº“åœ°å€ï¼š<a href="https://github.com/xzhih/one-key-hidpi" target="_blank" rel="noopener">ä¸€é”®å¼€å¯ HIDPI</a></p><p>æ•ˆæœï¼š</p><p><img src="https://pic.zhih.me/blog/posts/one-key-hidpi/hidpi-setting.jpg" alt="è®¾ç½®.png"></p><h3 id="4-ç½‘å¡é©±åŠ¨"><a href="#4-ç½‘å¡é©±åŠ¨" class="headerlink" title="4. ç½‘å¡é©±åŠ¨"></a>4. ç½‘å¡é©±åŠ¨</h3><p>æœºå™¨è‡ªå¸¦çš„æ— çº¿ç½‘å¡æ— æ³•é©±åŠ¨ï¼Œåªèƒ½è´­ä¹°å¯é©±åŠ¨çš„ç½‘å¡æ›´æ¢ï¼Œæ¨èè´­ä¹° <code>dw1560/dw1830</code> è¿™ä¸¤æ¬¾ç½‘å¡ï¼Œéœ€è¦æ³¨æ„çš„æ˜¯ç‡ƒç³»åˆ—æœ‰ä¸ªè¶…ç‡ƒç‰ˆä¹Ÿå°±æ˜¯æ²¡æœ‰ç‹¬æ˜¾çš„ç‰ˆæœ¬ï¼Œå®ƒå› ä¸ºä¸»æ¿ç»“æ„ä¸åŒä¸èƒ½å®‰è£… dw1830ï¼Œå¦å¤– dw1830 æ˜¯ 3 å¤©çº¿ç½‘å¡ï¼Œåœ¨è´­ä¹°æ—¶å¯å‘å•†å®¶ç´¢è¦ä¸€æ ¹ <code>7~15cm</code> çš„å¤©çº¿ï¼Œå®‰è£…æ—¶å°†ç¬¬ä¸‰æ ¹å¤©çº¿æ”¾ç½®åœ¨ HDD ä¸‹çš„å¼€æ§½å¤„é˜²æ­¢é‡‘å±å±è”½ä¿¡å·</p><p>æ–‡ä»¶å¤¹å†…æœ‰ä¸¤ä¸ªç½‘å¡çš„é©±åŠ¨ï¼Œè‡ªè¡Œå°†é‡Œé¢çš„é©±åŠ¨æ‹·è´åˆ° <code>EFI/clover/kext/other</code> ä¸­</p><h3 id="5-è§¦æ‘¸æ¿æ‰‹åŠ¿"><a href="#5-è§¦æ‘¸æ¿æ‰‹åŠ¿" class="headerlink" title="5. è§¦æ‘¸æ¿æ‰‹åŠ¿"></a>5. è§¦æ‘¸æ¿æ‰‹åŠ¿</h3><h4 id="1-å…ˆåœ¨è®¾ç½®-gt-é”®ç›˜-gt-ä¿®é¥°é”®é‡Œè®¾ç½®æ¢å¤åˆ°é»˜è®¤"><a href="#1-å…ˆåœ¨è®¾ç½®-gt-é”®ç›˜-gt-ä¿®é¥°é”®é‡Œè®¾ç½®æ¢å¤åˆ°é»˜è®¤" class="headerlink" title="1. å…ˆåœ¨è®¾ç½®-&gt;é”®ç›˜-&gt;ä¿®é¥°é”®é‡Œè®¾ç½®æ¢å¤åˆ°é»˜è®¤"></a>1. å…ˆåœ¨è®¾ç½®-&gt;é”®ç›˜-&gt;ä¿®é¥°é”®é‡Œè®¾ç½®æ¢å¤åˆ°é»˜è®¤</h4><p>é»˜è®¤ <kbd>win</kbd> å¯¹åº” <kbd>cmd</kbd> é”®ï¼Œ<kbd>alt</kbd> å¯¹åº” <kbd>opt</kbd> é”®ï¼Œæˆ‘ä¹ æƒ¯è¿™æ ·</p><h4 id="2-åœ¨å¿«æ·é”®é‡Œè®¾ç½®ä»¥ä¸‹é”®ä½"><a href="#2-åœ¨å¿«æ·é”®é‡Œè®¾ç½®ä»¥ä¸‹é”®ä½" class="headerlink" title="2. åœ¨å¿«æ·é”®é‡Œè®¾ç½®ä»¥ä¸‹é”®ä½"></a>2. åœ¨å¿«æ·é”®é‡Œè®¾ç½®ä»¥ä¸‹é”®ä½</h4><p><img src="https://pic.zhih.me/blog/posts/dell-7460-7560-hackintosh/è§¦æ§æ¿å¿«æ·é”®.jpg" alt="å¿«æ·é”®.png"></p><h4 id="3-è§¦æ§æ¿é©±åŠ¨-æ‰‹åŠ¿ï¼š"><a href="#3-è§¦æ§æ¿é©±åŠ¨-æ‰‹åŠ¿ï¼š" class="headerlink" title="3. è§¦æ§æ¿é©±åŠ¨+æ‰‹åŠ¿ï¼š"></a>3. è§¦æ§æ¿é©±åŠ¨+æ‰‹åŠ¿ï¼š</h4><figure class="highlight armasm"><table><tr><td class="code"><pre><span class="line">è½»è§¦å’ŒåŒæŒ‡å³é”®åœ¨è®¾ç½® -&gt; è§¦æ§æ¿é‡Œè®¾ç½®</span><br><span class="line">ä¸‰æŒ‡è½»è§¦ï¼šæ‰“å¼€é€šçŸ¥</span><br><span class="line">å››æŒ‡è½»è§¦ï¼šæœ€å°åŒ–åº”ç”¨åˆ° dock æ </span><br><span class="line">ä¸‰æŒ‡å‘ä¸Šè½»æ‰«ï¼šMission Control</span><br><span class="line">ä¸‰æŒ‡å‘ä¸‹è½»æ‰«ï¼šåº”ç”¨ç¨‹åºçª—å£</span><br><span class="line">ä¸‰æŒ‡å‘å·¦è½»æ‰«ï¼šåˆ‡æ¢åˆ°ä¸‹ä¸€ä¸ª <span class="meta">space</span></span><br><span class="line">ä¸‰æŒ‡å‘å³è½»æ‰«ï¼šåˆ‡æ¢åˆ°ä¸Šä¸€ä¸ª <span class="meta">space</span></span><br><span class="line">å››æŒ‡å‘ä¸Šè½»æ‰«ï¼šlaunchpad</span><br><span class="line">å››æŒ‡å‘ä¸‹è½»æ‰«ï¼šæ˜¾ç¤ºæ¡Œé¢</span><br></pre></td></tr></table></figure><blockquote><p>æœ¬æ–‡ç« å‘è¡¨äºåº•å™ªåšå®¢ <a href="https://zhih.me">https://zhih.me</a> , è½¬è½½è¯·æ³¨æ˜</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> æ•™ç¨‹ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> hackintosh </tag>
            
            <tag> MacOS </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Hexoä¸»é¢˜casperä½¿ç”¨æ•™ç¨‹</title>
      <link href="/hexo-casper-usage/"/>
      <url>/hexo-casper-usage/</url>
      
        <content type="html"><![CDATA[<h2 id="ç®€è¿°"><a href="#ç®€è¿°" class="headerlink" title="ç®€è¿°"></a>ç®€è¿°</h2><p>è¿™æ˜¯æœ¬äººç§»æ¤è‡ª <a href="https://github.com/TryGhost/Casper" target="_blank" rel="noopener">Ghostâ€™s Casper theme</a> çš„ä¸€ä¸ª <a href="https://hexo.io" target="_blank" rel="noopener">Hexo</a> ä¸»é¢˜ã€‚</p><p>é¡¹ç›®åœ°å€ <a href="https://github.com/xzhih/hexo-theme-casper" target="_blank" rel="noopener">https://github.com/xzhih/hexo-theme-casper</a></p><p>DEMO <a href="https://xzhih.github.io/hexo-theme-casper/" target="_blank" rel="noopener">https://xzhih.github.io/hexo-theme-casper/</a></p><h2 id="é¡¹ç›®æ¥ç”±"><a href="#é¡¹ç›®æ¥ç”±" class="headerlink" title="é¡¹ç›®æ¥ç”±"></a>é¡¹ç›®æ¥ç”±</h2><p>æœ€è¿‘æäº†ä¸ªåšå®¢ï¼Œç”¨çš„æ˜¯ <a href="https://hexo.io" target="_blank" rel="noopener">Hexo</a> ï¼Œå‘ç°äº†å¾ˆå¤šä¸é”™çš„ä¸»é¢˜ï¼Œåœ¨å¯»æ‰¾ä¸»é¢˜çš„è¿‡ç¨‹ä¸­å‘ç°äº†å¦ä¸€ä¸ªåšå®¢ç¨‹åº <a href="https://ghost.org" target="_blank" rel="noopener">Ghost</a> ã€‚å®ƒçš„æ–°ç‰ˆé»˜è®¤ä¸»é¢˜å¾ˆå’Œæˆ‘çš„èƒƒå£ï¼Œä½†æ˜¯åœ¨githubä¸Šæœç´¢ä¸€é€šåï¼Œå‘ç°åªæœ‰è€ç‰ˆæœ¬çš„è¢«ç§»æ¤åˆ°äº† hexoï¼Œäºæ˜¯æƒ³è‡ªå·±åŠ¨æ‰‹æŠŠå®ƒç§»æ¤è¿‡æ¥ï¼Œçœ‹äº†å®˜æ–¹æ–‡æ¡£åå‘ç°hexoçš„ä¸»é¢˜è¿˜æ˜¯ç›¸å½“å¥½åˆ¶ä½œçš„ï¼Œç”¨äº†å‡ å¤©å¼„å¥½äº†ã€‚å½“ç„¶ï¼ŒåŠŸèƒ½è¿˜ä¸æ˜¯å¾ˆå®Œå–„ã€‚</p><p>ç»è¿‡å‡ æ¬¡çš„ä¿®æ”¹æ›´æ–°ï¼Œç°åœ¨å·²ç»æ¯”è¾ƒå®Œå–„äº†ï¼Œå¤§å¤šåŠŸèƒ½éƒ½æ˜¯ä¸»é¢˜é›†æˆçš„ï¼Œä¸éœ€è¦å†å®‰è£…æ’ä»¶</p><p>ä¸‹é¢æˆ‘å°±è¯´ä¸€ä¸‹ä¸»é¢˜çš„ä½¿ç”¨æ–¹æ³•ã€‚</p><h2 id="ç‰¹æ€§"><a href="#ç‰¹æ€§" class="headerlink" title="ç‰¹æ€§"></a>ç‰¹æ€§</h2><ul><li>æ–‡ç« å°é¢å›¾ï¼ˆåœ¨é¦–é¡µæ–‡ç« æ‘˜è¦ä¸Šæ˜¾ç¤ºï¼‰</li><li>æ–‡ç« ç‰¹è‰²å›¾ï¼ˆåœ¨æ–‡ç« è¯¦ç»†é¡µé¢ä¸Šç½®é¡¶ï¼‰</li><li>è‡ªå®šä¹‰èœå•</li><li>è‡ªå®šä¹‰ favicon, logo, å¤´éƒ¨èƒŒæ™¯, ä½œè€…å¤´åƒ</li><li>ç¤¾äº¤é“¾æ¥ ( ç°åœ¨æ”¯æŒ githubã€å“”å“©å“”å“©ã€YouTubeã€å¾®åšã€æ¨ç‰¹ã€è„¸ä¹¦ )</li><li>å…±ä¸‰ä¸ªæ’ä»¶ï¼ˆæœ€æ–°æ–‡ç« ã€åˆ†ç±»ã€æ ‡ç­¾äº‘ï¼‰</li><li>å†…å®¹ç›®å½•</li><li>ä»£ç é«˜äº®</li><li>å“åº”å¼ç½‘é¡µè®¾è®¡</li><li>æ‡’åŠ è½½</li><li>ä¸»é¢˜é›†æˆæœ¬åœ°æœç´¢</li><li>Valine è¯„è®ºç³»ç»Ÿ</li><li>Baidu é“¾æ¥æäº¤ã€Google Analytics</li><li>Service Worker</li></ul><h2 id="å®‰è£…æ–¹æ³•"><a href="#å®‰è£…æ–¹æ³•" class="headerlink" title="å®‰è£…æ–¹æ³•"></a>å®‰è£…æ–¹æ³•</h2><h3 id="ä¸‹è½½"><a href="#ä¸‹è½½" class="headerlink" title="ä¸‹è½½"></a>ä¸‹è½½</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">git <span class="built_in">clone</span> https://github.com/xzhih/hexo-theme-casper.git themes/hexo-casper</span><br></pre></td></tr></table></figure><h3 id="æ¿€æ´»"><a href="#æ¿€æ´»" class="headerlink" title="æ¿€æ´»"></a>æ¿€æ´»</h3><p>æŠŠhexoé…ç½®æ–‡ä»¶ <code>_config.yml</code> é‡Œçš„ <code>theme</code> å­—æ®µå†…å®¹æ”¹ä¸º <code>hexo-casper</code> ã€‚</p><h3 id="å‡çº§"><a href="#å‡çº§" class="headerlink" title="å‡çº§"></a>å‡çº§</h3><p>å»ºè®®å…ˆå¤‡ä»½ä¸€ä¸‹åœ¨æ‰§è¡Œä¸‹é¢çš„æ“ä½œã€‚</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">cd</span> themes/casper </span><br><span class="line">git pull</span><br></pre></td></tr></table></figure><h3 id="æ·»åŠ ç»Ÿä¸€çš„æ–‡ç« æ¨¡æ¿å‚æ•°"><a href="#æ·»åŠ ç»Ÿä¸€çš„æ–‡ç« æ¨¡æ¿å‚æ•°" class="headerlink" title="æ·»åŠ ç»Ÿä¸€çš„æ–‡ç« æ¨¡æ¿å‚æ•°"></a>æ·»åŠ ç»Ÿä¸€çš„æ–‡ç« æ¨¡æ¿å‚æ•°</h3><p>æŠŠä¸‹é¢çš„å†…å®¹åŠ å…¥åˆ° <code>scaffolds/post.md</code>,</p><figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">cover_img:</span>     <span class="comment"># åœ¨æ–‡ç« æ‘˜è¦ä¸Šæ˜¾ç¤º</span></span><br><span class="line"><span class="attr">feature_img:</span>   <span class="comment"># åœ¨æ–‡ç« è¯¦ç»†é¡µé¢ä¸Šç½®é¡¶</span></span><br><span class="line"><span class="attr">description:</span>   <span class="comment"># æ–‡ç« æè¿°</span></span><br><span class="line"><span class="attr">keywords:</span>      <span class="comment"># å…³é”®å­—</span></span><br></pre></td></tr></table></figure><h3 id="valine-è¯„è®ºç³»ç»Ÿ"><a href="#valine-è¯„è®ºç³»ç»Ÿ" class="headerlink" title="valine è¯„è®ºç³»ç»Ÿ"></a>valine è¯„è®ºç³»ç»Ÿ</h3><p>ä½¿ç”¨æ–¹æ³•è¯·åˆ°ä»–çš„<a href="https://valine.js.org" target="_blank" rel="noopener">å®˜ç½‘</a>æŸ¥çœ‹ï¼Œå¹¶ç»“åˆä¸‹é¢çš„é…ç½®æ–‡ä»¶è¯¦ç»†æ·»åŠ appIDå’ŒappKey</p><p><strong>æ·»åŠ å…³äºé¡µé¢</strong></p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">hexo new page about</span><br></pre></td></tr></table></figure><h2 id="è‡ªå®šä¹‰é…ç½®"><a href="#è‡ªå®šä¹‰é…ç½®" class="headerlink" title="è‡ªå®šä¹‰é…ç½®"></a>è‡ªå®šä¹‰é…ç½®</h2><p>ç¼–è¾‘ <code>themes/hexo-casper/_config.yml</code> è®¾ç½®ä½ æƒ³æ˜¾ç¤ºå‡ºæ¥çš„ç‰¹æ€§</p><figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="comment"># Config</span></span><br><span class="line"><span class="attr">rss:</span>            <span class="comment"># link</span></span><br><span class="line"><span class="attr">favicon:</span> <span class="attr">https://i.loli.net/2017/11/26/5a19c0b50432e.png</span></span><br><span class="line"><span class="attr">blog_logo:</span> </span><br><span class="line"><span class="attr">header_image:</span> <span class="attr">https://i.loli.net/2017/11/26/5a19c56faa29f.jpg</span></span><br><span class="line"><span class="attr">bio:</span> <span class="string">This</span> <span class="string">is</span> <span class="string">a</span> <span class="string">demo</span></span><br><span class="line"><span class="attr">post_toc:</span> <span class="literal">true</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># èœå•</span></span><br><span class="line"><span class="attr">menu:</span></span><br><span class="line"><span class="attr">  About:</span> <span class="string">/about</span></span><br><span class="line"><span class="attr">  Archives:</span> <span class="string">/archives</span></span><br><span class="line">  <span class="comment"># å…¶ä»–çš„å¯ä»¥æŒ‰ç…§ä¸Šé¢çš„æ¨¡æ¿æ·»åŠ </span></span><br><span class="line"></span><br><span class="line"><span class="comment"># ä½œè€…</span></span><br><span class="line"><span class="attr">author_image:</span>   <span class="comment"># é“¾æ¥</span></span><br><span class="line"><span class="attr">author_bio:</span>     <span class="comment"># æè¿°</span></span><br><span class="line"><span class="attr">author_location:</span> <span class="comment"># åœ°å€</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># ç¤¾äº¤é“¾æ¥</span></span><br><span class="line"><span class="attr">social:</span></span><br><span class="line"><span class="attr">  facebook:</span> <span class="attr">https://www.facebook.com</span></span><br><span class="line"><span class="attr">  twitter:</span> <span class="attr">https://www.twitter.com</span></span><br><span class="line"><span class="attr">  twitter:</span> <span class="attr">https://twitter.com</span></span><br><span class="line"><span class="attr">  facebook:</span> <span class="attr">https://facebook</span></span><br><span class="line"><span class="attr">  telegram:</span></span><br><span class="line"><span class="attr">  bilibili:</span></span><br><span class="line"><span class="attr">  youtube:</span></span><br><span class="line">  </span><br><span class="line"><span class="comment"># æ’ä»¶ï¼ˆæ˜¾ç¤ºåœ¨ç½‘ç«™åº•éƒ¨ï¼‰</span></span><br><span class="line"><span class="attr">widgets:</span></span><br><span class="line"><span class="attr">  recent_posts:</span> <span class="literal">true</span></span><br><span class="line"><span class="attr">  category:</span> <span class="literal">true</span></span><br><span class="line"><span class="attr">  tagcloud:</span> <span class="literal">true</span></span><br><span class="line">  <span class="comment"># è¿™æ˜¯ä¸ªç®€æ´çš„ä¸»é¢˜ï¼Œæˆ‘è®¤ä¸º3ä¸ªå°±å¤Ÿäº†</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æ–‡ç« å›¾ç‰‡ç›¸å†Œï¼ˆç‚¹å‡»å›¾ç‰‡å¯ä»¥æ”¾å¤§ï¼‰</span></span><br><span class="line"><span class="comment"># https://github.com/sachinchoolur/lightgallery.js</span></span><br><span class="line"><span class="attr">lightgallery:</span> <span class="literal">true</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æ‡’åŠ è½½</span></span><br><span class="line"><span class="comment"># é¦–é¡µå·²ç»é»˜è®¤å¼€å¯ï¼Œå…¶ä»–é¡µé¢åœ¨æ­¤å¼€å¯</span></span><br><span class="line"><span class="comment"># https://github.com/dinbror/blazy</span></span><br><span class="line"><span class="attr">lazyload:</span> <span class="literal">true</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æœç´¢åŠŸèƒ½</span></span><br><span class="line"><span class="attr">local_search:</span> <span class="literal">true</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Valine è¯„è®ºç³»ç»Ÿ</span></span><br><span class="line"><span class="comment"># https://valine.js.org</span></span><br><span class="line"><span class="attr">comment:</span> <span class="literal">false</span></span><br><span class="line"><span class="attr">valine:</span></span><br><span class="line"><span class="attr">  notify:</span> <span class="literal">false</span> <span class="comment"># mail notifier , https://github.com/xCss/Valine/wiki </span></span><br><span class="line"><span class="attr">  verify:</span> <span class="literal">false</span> <span class="comment"># Verification code</span></span><br><span class="line"><span class="attr">  appId:</span> <span class="comment"># your leancloud application appid</span></span><br><span class="line"><span class="attr">  appKey:</span> <span class="comment"># your leancloud application appkey</span></span><br><span class="line"><span class="attr">  placeholder:</span> <span class="string">Just</span> <span class="string">go</span> <span class="string">go</span> <span class="comment"># comment box placeholder</span></span><br><span class="line"><span class="attr">  avatar:</span> <span class="string">mm</span> <span class="comment"># gravatar style</span></span><br><span class="line"><span class="attr">  pageSize:</span> <span class="number">10</span> <span class="comment"># pagination size</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># PWA </span></span><br><span class="line"><span class="comment"># ä½ éœ€è¦åœ¨ hexo ç›®å½•çš„ source æ–‡ä»¶å¤¹é‡Œåˆ›å»ºä¸€ä¸ª manifest.json æ–‡ä»¶</span></span><br><span class="line"><span class="attr">manifest:</span> <span class="literal">false</span></span><br><span class="line"><span class="attr">service_workers:</span> <span class="literal">false</span></span><br><span class="line"></span><br><span class="line"><span class="attr">navColor:</span> <span class="string">'3c484e'</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Baidu é“¾æ¥æäº¤</span></span><br><span class="line"><span class="attr">baidu:</span> <span class="literal">false</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Google Analytics</span></span><br><span class="line"><span class="attr">googleAnalytics:</span> <span class="literal">false</span></span><br><span class="line"><span class="attr">GA_TRACKING_ID:</span> <span class="string">UA-XXXXXXXXXX-1</span></span><br></pre></td></tr></table></figure><h2 id="æœ¬åœ°æœç´¢åŠŸèƒ½å‚è€ƒ"><a href="#æœ¬åœ°æœç´¢åŠŸèƒ½å‚è€ƒ" class="headerlink" title="æœ¬åœ°æœç´¢åŠŸèƒ½å‚è€ƒ"></a>æœ¬åœ°æœç´¢åŠŸèƒ½å‚è€ƒ</h2><p><a href="https://github.com/wzpan/hexo-generator-search" target="_blank" rel="noopener">https://github.com/wzpan/hexo-generator-search</a><br><a href="https://github.com/SuperKieran/hexo-generator-search-zip" target="_blank" rel="noopener">https://github.com/SuperKieran/hexo-generator-search-zip</a></p><h2 id="æºä¸»é¢˜çš„ç‰ˆæƒå£°æ˜å’Œ-License"><a href="#æºä¸»é¢˜çš„ç‰ˆæƒå£°æ˜å’Œ-License" class="headerlink" title="æºä¸»é¢˜çš„ç‰ˆæƒå£°æ˜å’Œ License"></a>æºä¸»é¢˜çš„ç‰ˆæƒå£°æ˜å’Œ License</h2><p><a href="https://github.com/TryGhost/Casper/blob/master/LICENSE" target="_blank" rel="noopener">https://github.com/TryGhost/Casper/blob/master/LICENSE</a></p><blockquote><p>æœ¬æ–‡ç« å‘è¡¨äºåº•å™ªåšå®¢ <a href="https://zhih.me">https://zhih.me</a> , è½¬è½½è¯·æ³¨æ˜</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> æ•™ç¨‹ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> web </tag>
            
            <tag> hexo </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>å¦‚ä½•åœ¨è·¯ç”±å™¨ä¸Šæ ¼å¼åŒ–Uç›˜ã€ç¡¬ç›˜</title>
      <link href="/format-Upan-partition/"/>
      <url>/format-Upan-partition/</url>
      
        <content type="html"><![CDATA[<h2 id="å¼•è¨€"><a href="#å¼•è¨€" class="headerlink" title="å¼•è¨€"></a>å¼•è¨€</h2><p>æœ¬æ•™ç¨‹é€‚ç”¨äºæ¢…æ—ã€padavanã€LEDEï¼ˆopenwrtï¼‰ç­‰å›ºä»¶</p><p>ä»¥ä¸‹å…·ä½“æ–¹æ³•éƒ½åŸºäº ext4ï¼ŒNTFS ç›¸å…³é”™è¯¯ä¸åšå›ç­”</p><p>ä½¿ç”¨sshè¿æ¥è·¯ç”±å™¨ï¼ŒæŠŠUç›˜æ’åˆ°è·¯ç”±å™¨ä¸Š</p><p>æˆ‘ä»¬éœ€è¦åœ¨å‘½ä»¤è¡Œè¿›è¡Œä»¥ä¸‹4æ­¥æ“ä½œï¼š</p><h2 id="å®‰è£…fdisk"><a href="#å®‰è£…fdisk" class="headerlink" title="å®‰è£…fdisk"></a>å®‰è£…fdisk</h2><p>ä¸€èˆ¬æ¢…æ—ã€Padavan å›ºä»¶éƒ½ä¼šè‡ªå¸¦çš„ï¼Œä¸ç”¨å®‰è£…ï¼Œå¦‚æœæ²¡æœ‰åˆ™æŒ‰ç…§ä¸‹é¢ç»™å‡ºçš„å‘½ä»¤</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">opkg update</span><br><span class="line">opkg install fdisk</span><br><span class="line"><span class="comment"># è¾“å‡ºConfiguring fdisk. å¹¶ä¸”æ²¡æœ‰é”™è¯¯</span></span><br><span class="line"><span class="comment"># fdiskå°±å®‰è£…å¥½äº†</span></span><br></pre></td></tr></table></figure><h2 id="æŸ¥çœ‹ä½ çš„è®¾å¤‡"><a href="#æŸ¥çœ‹ä½ çš„è®¾å¤‡" class="headerlink" title="æŸ¥çœ‹ä½ çš„è®¾å¤‡"></a>æŸ¥çœ‹ä½ çš„è®¾å¤‡</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">fdisk -l </span><br><span class="line"><span class="comment"># è¿™é‡Œå…ˆè¾“å‡ºç³»ç»Ÿåˆ†åŒºä¹‹ç±»çš„ä¸ç”¨ç®¡ï¼Œå¤–ç½®è®¾å¤‡ä¸€èˆ¬åœ¨æœ€å</span></span><br><span class="line">Disk /dev/sda: 30.7 GB, 30752000000 bytes</span><br><span class="line">64 heads, 32 sectors/track, 29327 cylinders</span><br><span class="line">Units = cylinders of 2048 * 512 = 1048576 bytes</span><br><span class="line">Device Boot      Start         End      Blocks  Id System</span><br><span class="line">/dev/sda1               2       29327    30029824  83 Linux</span><br></pre></td></tr></table></figure><p>ä¸Šé¢çš„ä¿¡æ¯æ³¨æ„çœ‹åˆ°å’Œä½ çš„å­˜å‚¨å¤§å°ä¸€æ ·çš„è®¾å¤‡ï¼Œæˆ‘çš„æ˜¯ <code>/dev/sda</code>ï¼Œåœ¨å®ƒé‡Œé¢æœ‰ä¸ª <code>/dev/sda1</code>çš„åˆ†åŒº</p><h2 id="åˆ é™¤åˆ†åŒºã€æ–°å»ºåˆ†åŒº"><a href="#åˆ é™¤åˆ†åŒºã€æ–°å»ºåˆ†åŒº" class="headerlink" title="åˆ é™¤åˆ†åŒºã€æ–°å»ºåˆ†åŒº"></a>åˆ é™¤åˆ†åŒºã€æ–°å»ºåˆ†åŒº</h2><p>å…ˆå¸è½½ U ç›˜ï¼Œå¦‚æœæç¤º <code>No such file or directory</code> æ²¡å…³ç³»ï¼Œè¯´æ˜æœ¬æ¥å°±æ²¡æŒ‚è½½ä¸Š</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># padavanã€æ¢…æ—å¯ä»¥æ‰§è¡Œä»¥ä¸‹è¿™ä¸ªæ¨å‡º usb</span></span><br><span class="line">ejusb</span><br><span class="line"></span><br><span class="line"><span class="comment"># å…¶ä»–å›ºä»¶ï¼Œæˆ–è€…æ¢…æ—ä½¿ç”¨ä»¥ä¸Šå‘½ä»¤æ— æ•ˆï¼Œåˆ™å¯ä»¥ä½¿ç”¨è¿™ä¸ªå‘½ä»¤å¸è½½åˆ†åŒº</span></span><br><span class="line">umount /dev/sda1</span><br></pre></td></tr></table></figure><p>ç„¶ååˆ†åŒº</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">fdisk /dev/sda <span class="comment"># è¿™æ˜¯ä½ çš„è®¾å¤‡åˆ¥æ‰“æˆåˆ†åŒº</span></span><br><span class="line"></span><br><span class="line">Welcome to fdisk (util-linux 2.29.2).</span><br><span class="line">Changes will remain <span class="keyword">in</span> memory only, until you decide to write them.</span><br><span class="line">Be careful before using the write <span class="built_in">command</span>.</span><br><span class="line"></span><br><span class="line">Command (m <span class="keyword">for</span> <span class="built_in">help</span>): d </span><br><span class="line"><span class="comment"># è¾“å…¥då›è½¦ï¼Œæˆ‘åªæœ‰ä¸€ä¸ªåˆ†åŒºï¼Œå®ƒè‡ªåŠ¨é€‰æ‹©äº†ï¼Œå¦‚æœä½ æœ‰å¤šä¸ªåˆ†åŒºï¼Œå¯ä»¥å¤šæ¬¡ä½¿ç”¨d</span></span><br><span class="line">Selected partition 1</span><br><span class="line">Partition 1 has been deleted.</span><br><span class="line"></span><br><span class="line">Command (m <span class="keyword">for</span> <span class="built_in">help</span>): n <span class="comment"># è¾“å…¥nä¼šè½¦ï¼Œåˆ›å»ºåˆ†åŒº</span></span><br><span class="line">Partition <span class="built_in">type</span></span><br><span class="line">p   primary (0 primary, 0 extended, 4 free)</span><br><span class="line">e   extended (container <span class="keyword">for</span> logical partitions)</span><br><span class="line"></span><br><span class="line">Select (default p): p <span class="comment"># é€‰æ‹©p</span></span><br><span class="line">Partition number (1-4, default 1): <span class="comment"># è¾“å…¥ 1 å›è½¦</span></span><br><span class="line">First sector (2048-2065023, default 2048): <span class="comment"># å›è½¦</span></span><br><span class="line">Last sector, +sectors or +size&#123;K,M,G,T,P&#125; (2048-2065023, default 2065023): <span class="comment"># å›è½¦</span></span><br><span class="line">Created a new partition 1 of <span class="built_in">type</span> <span class="string">'Linux'</span> and of size 1007.3 MiB.</span><br><span class="line"></span><br><span class="line">Command (m <span class="keyword">for</span> <span class="built_in">help</span>): w <span class="comment"># è¾“å…¥ w å›è½¦ï¼Œä¿å­˜å¹¶é€€å‡º</span></span><br><span class="line">The partition table has been altered.</span><br><span class="line">Calling ioctl() to re-read partition table.</span><br><span class="line">Syncing disks.</span><br></pre></td></tr></table></figure><p>ç»è¿‡ä»¥ä¸Šçš„æ“ä½œï¼Œä½ å¯ä»¥ç”¨ <code>fdisk -l</code> å‘½ä»¤æŸ¥çœ‹Uç›˜ä¸Šæ˜¯å¦åªæœ‰ä¸€ä¸ª Linux åˆ†åŒº</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">fdisk -l </span><br><span class="line"><span class="comment"># æ‰¾åˆ°ä½ çš„è®¾å¤‡ å¯ä»¥çœ‹åˆ°IDä¸º83å°±å¯¹äº†</span></span><br><span class="line">Disk /dev/sda: 30.7 GB, 30752000000 bytes</span><br><span class="line">64 heads, 32 sectors/track, 29327 cylinders</span><br><span class="line">Units = cylinders of 2048 * 512 = 1048576 bytes</span><br><span class="line">Device Boot      Start         End      Blocks  Id System</span><br><span class="line">/dev/sda1               2       29327    30029824  83 Linux</span><br></pre></td></tr></table></figure><h2 id="æ ¼å¼åŒ–åˆ†åŒº"><a href="#æ ¼å¼åŒ–åˆ†åŒº" class="headerlink" title="æ ¼å¼åŒ–åˆ†åŒº"></a>æ ¼å¼åŒ–åˆ†åŒº</h2><p>åˆ†åŒºå·²ç»æœ‰äº†ï¼Œç°åœ¨å¼€å§‹æ ¼å¼åŒ–</p><p>ç”¨ <code>mkfs.ext4</code> å‘½ä»¤æ ¼å¼åŒ–ï¼Œå¹¶ä¸”è®¾ç½®å·æ ‡ä¸º onmp</p><p><strong>æ³¨æ„</strong>ï¼Œå¦‚æœä¸‹é¢çš„å‘½ä»¤æç¤º <code>/dev/sda1 is mounted</code>ï¼Œåˆ™éœ€è¦å…ˆå¸è½½ U ç›˜ï¼Œå’Œåˆ†åŒºå‰å¸è½½çš„æ–¹æ³•ä¸€æ ·</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">mkfs.ext4 -m 0 -L onmp /dev/sda1 </span><br><span class="line"><span class="comment"># å¦‚æœä½ çš„ç¡¬ç›˜æ¯”è¾ƒå¤§ï¼Œ256Gä»¥ä¸Šçš„è¯ï¼Œæ˜¯ä¸‹é¢è¿™ä¸ªå‘½ä»¤ï¼š</span></span><br><span class="line"><span class="comment"># mkfs.ext4 -m 0 -L ONMP -T largefile /dev/sda1</span></span><br><span class="line"></span><br><span class="line">mke2fs 1.42.8 (20-Jun-2013)</span><br><span class="line">Filesystem label=onmp</span><br><span class="line">OS <span class="built_in">type</span>: Linux</span><br><span class="line">Block size=4096 (<span class="built_in">log</span>=2)</span><br><span class="line">Fragment size=4096 (<span class="built_in">log</span>=2)</span><br><span class="line">Stride=0 blocks, Stripe width=0 blocks</span><br><span class="line">1880480 inodes, 7507456 blocks</span><br><span class="line">0 blocks (0.00%) reserved <span class="keyword">for</span> the super user</span><br><span class="line">First data block=0</span><br><span class="line">Maximum filesystem blocks=0</span><br><span class="line">230 block groups</span><br><span class="line">32768 blocks per group, 32768 fragments per group</span><br><span class="line">8176 inodes per group</span><br><span class="line">Superblock backups stored on blocks:</span><br><span class="line">        32768, 98304, 163840, 229376, 294912, 819200, 884736, 1605632, 2654208,</span><br><span class="line">        4096000</span><br><span class="line"></span><br><span class="line">Allocating group tables: <span class="keyword">done</span></span><br><span class="line">Writing inode tables: <span class="keyword">done</span></span><br><span class="line">Creating journal (32768 blocks): <span class="keyword">done</span></span><br><span class="line">Writing superblocks and filesystem accounting information: <span class="keyword">done</span></span><br></pre></td></tr></table></figure><p>è¿™æ ·ï¼ŒUç›˜å°±è¢«æ ¼å¼åŒ–å®Œäº†ï¼Œæ‹”æ’ U ç›˜å¯ä»¥é‡æ–°æŒ‚è½½ï¼Œæˆ–è€…ä½ æƒ³ç”¨ä»¥ä¸‹å‘½ä»¤æŒ‚è½½ä¹Ÿè¡Œ</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">mkdir /mnt/onmp</span><br><span class="line">mount -t ext4 /dev/sda1 /mnt/onmp</span><br></pre></td></tr></table></figure><blockquote><p>æœ¬æ–‡ç« å‘è¡¨äºåº•å™ªåšå®¢ <a href="https://zhih.me">https://zhih.me</a> , è½¬è½½è¯·æ³¨æ˜</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> æ•™ç¨‹ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> shell </tag>
            
            <tag> è·¯ç”±å™¨ </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>ONMPå®‰è£…æ•™ç¨‹</title>
      <link href="/onmp-installation/"/>
      <url>/onmp-installation/</url>
      
        <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>ä¹‹å‰ç”¨è¿‡æè·¯ç”± 1sï¼Œåˆ·äº†æ©å±± Hå¤§çš„å›ºä»¶ï¼Œå‘ç°å†…ç½®äº† web ç¯å¢ƒï¼Œæ²¡æƒ³åˆ°ä¸€ä¸ªè·¯ç”±å™¨éƒ½èƒ½è·‘çš„åŠ¨ LNMPã€‚æˆ‘ä¹‹å‰æœ€æé™çš„å°è¯•å°±æ˜¯åœ¨ä¸€ä¸ª 4åˆ€3å¹´ çš„ sentris ovz å°é¸¡ä¸Šè·‘è¿‡ WordPress ï¼Œé‚£å°å°é¸¡ é…ç½®å¾ˆä½ï¼Œåªæœ‰ 64M çš„å†…å­˜ğŸ˜‚ã€‚ä¸è¿‡ LNMP æµç•…è¿è¡Œçš„å› ç´ æŒºå¤šï¼ŒPHP åƒ CPUã€MySQL åƒ IOï¼Œä¸åŒçš„ç¨‹åºè¡¨ç°ä¹Ÿä¸ä¸€æ ·ã€‚é‚£å°æè·¯ç”±è¢«æˆ‘æŠ˜è…¾äº†æ²¡ä¸¤ä¸‹å°±æ”¾å¼ƒäº†åœ¨ä¸Šé¢æ­ç½‘ç«™ï¼Œæ¯•ç«Ÿæ€§èƒ½å¤ªä½ã€‚</p><p>åæ¥æˆ‘ä¸Šè½¦äº†æ–è®¯ K2Pï¼Œæ‹¿å›æ¥èŠ±äº†ä¸€ä¸ªæ™šä¸Šæ”¹å¥½äº† 32+512+usbï¼Œåˆ·çš„æ˜¯ç¯å¤§çš„ç¡¬æ”¹å›ºä»¶ï¼Œå°‘äº†Hå¤§å›ºä»¶çš„é‡Œé¢çš„ä¸°å¯Œæ‹“å±•ï¼Œæ„Ÿè§‰éƒ½ä¸å¯¹äº†ï¼Œk2p æ—¢ç„¶ç¡¬æ”¹äº†ï¼Œé‚£å°±å¥½å¥½ç©å®ƒï¼Œä¹‹å‰ä¸æ˜¯å«Œå¼ƒæ 1s çš„æ€§èƒ½ä¸è¶³å˜›ï¼Œç°åœ¨ K2P æ¯”èµ·å®ƒæ¥è¯´ï¼Œæ€§èƒ½å¼ºäº†ä¸€äº›ï¼Œè¿å­˜å¤§ã€CPUå¼ºã€è¿˜æ˜¯ USB3.0ï¼Œé‚£å°±å†™ä¸ªä¸€é”®å®‰è£… web ç¯å¢ƒå§ï¼Œäºæ˜¯å°±æœ‰äº†è¿™ä¸ªé¡¹ç›®ã€‚</p><h2 id="ç®€è¿°"><a href="#ç®€è¿°" class="headerlink" title="ç®€è¿°"></a>ç®€è¿°</h2><p>ONMP æ˜¯ä¸€ä¸ª web ç¯å¢ƒå¿«é€Ÿå®‰è£…è„šæœ¬ï¼Œé€‚ç”¨äºå®‰è£…äº† <a href="https://entware.net/" target="_blank" rel="noopener">Entware</a> çš„è·¯ç”±å™¨ï¼Œç›®å‰å·²ç»åœ¨ Padavanã€LEDEï¼ˆopenwrtï¼‰ã€æ¢…æ—ä¸Šæµ‹è¯•æˆåŠŸã€‚</p><p>å’Œ LNMP æœ‰ä»€ä¹ˆä¸åŒï¼Ÿ<br>LNMP ä»£è¡¨çš„æ˜¯ï¼šLinux ç³»ç»Ÿä¸‹ Nginx/MySQL/PHP è¿™ç§ç½‘ç«™æœåŠ¡å™¨æ¶æ„ï¼Œè€Œä¸ºäº†åŒºåˆ†è·¯ç”±å™¨ç¯å¢ƒçš„ä¸åŒï¼Œä½¿ç”¨çš„ ONMP è¿™ä¸ªå‘½åï¼Œæœ¬è´¨è¿˜æ˜¯ LNMPã€‚</p><p>é¡¹ç›®åœ°å€ï¼š<a href="https://github.com/xzhih/ONMP" target="_blank" rel="noopener">https://github.com/xzhih/ONMP</a></p><h2 id="ç‰¹æ€§"><a href="#ç‰¹æ€§" class="headerlink" title="ç‰¹æ€§"></a>ç‰¹æ€§</h2><p>æ­¤è„šæœ¬ä¸ä»…è‡ªåŠ¨åŒ–å®‰è£… web ç¯å¢ƒï¼Œè¿˜å†…ç½®äº†ä¸€äº›å¥½ç”¨çš„ç½‘ç«™ç¨‹åºä¸€é”®å…é…ç½®å¿«é€Ÿå®‰è£…ã€‚</p><figure class="highlight less"><table><tr><td class="code"><pre><span class="line"><span class="selector-tag">ONMP</span>å†…ç½®äº†ä»¥ä¸‹ç¨‹åºçš„ä¸€é”®å®‰è£…ï¼š</span><br><span class="line">(<span class="number">1</span>) <span class="selector-tag">phpMyAdmin</span>ï¼ˆæ•°æ®åº“ç®¡ç†å·¥å…·ï¼‰</span><br><span class="line">(<span class="number">2</span>) <span class="selector-tag">WordPress</span>ï¼ˆä½¿ç”¨æœ€å¹¿æ³›çš„<span class="selector-tag">CMS</span>ï¼‰</span><br><span class="line">(<span class="number">3</span>) <span class="selector-tag">Owncloud</span>ï¼ˆç»å…¸çš„ç§æœ‰äº‘ï¼‰</span><br><span class="line">(<span class="number">4</span>) <span class="selector-tag">Nextcloud</span>ï¼ˆ<span class="selector-tag">Owncloud</span>å›¢é˜Ÿçš„æ–°ä½œï¼Œç¾è§‚å¼ºå¤§çš„ä¸ªäººäº‘ç›˜ï¼‰</span><br><span class="line">(<span class="number">5</span>) <span class="selector-tag">h5ai</span>ï¼ˆä¼˜ç§€çš„æ–‡ä»¶ç›®å½•ï¼‰</span><br><span class="line">(<span class="number">6</span>) <span class="selector-tag">Lychee</span>ï¼ˆä¸€ä¸ªå¾ˆå¥½çœ‹ï¼Œæ˜“äºä½¿ç”¨çš„<span class="selector-tag">Web</span>ç›¸å†Œï¼‰</span><br><span class="line">(<span class="number">7</span>) <span class="selector-tag">Kodexplorer</span>ï¼ˆå¯é“äº‘<span class="selector-tag">aka</span>èŠ’æœäº‘åœ¨çº¿æ–‡æ¡£ç®¡ç†å™¨ï¼‰</span><br><span class="line">(<span class="number">8</span>) <span class="selector-tag">Netdata</span>ï¼ˆè¯¦ç»†å¾—æƒŠäººçš„æœåŠ¡å™¨ç›‘æ§é¢æ¿ï¼‰</span><br><span class="line">(<span class="number">9</span>) <span class="selector-tag">Typecho</span> (æµç•…çš„è½»é‡çº§å¼€æºåšå®¢ç¨‹åº)</span><br><span class="line">(<span class="number">10</span>) <span class="selector-tag">Z-Blog</span> (ä½“ç§¯å°ï¼Œé€Ÿåº¦å¿«çš„PHPåšå®¢ç¨‹åº)</span><br><span class="line">(<span class="number">11</span>) <span class="selector-tag">DzzOffice</span> (å¼€æºåŠå…¬å¹³å°)</span><br></pre></td></tr></table></figure><h2 id="å®‰è£…æ•™ç¨‹"><a href="#å®‰è£…æ•™ç¨‹" class="headerlink" title="å®‰è£…æ•™ç¨‹"></a>å®‰è£…æ•™ç¨‹</h2><h3 id="1-å®‰è£…-Entware"><a href="#1-å®‰è£…-Entware" class="headerlink" title="1. å®‰è£… Entware"></a>1. å®‰è£… Entware</h3><p>Entware æ˜¯ä¸€ä¸ªé€‚ç”¨äºåµŒå…¥å¼ç³»ç»Ÿçš„è½¯ä»¶åŒ…åº“ï¼Œä½¿ç”¨ opkg åŒ…ç®¡ç†ç³»ç»Ÿè¿›è¡Œç®¡ç†ï¼Œç°åœ¨åœ¨å®˜æ–¹çš„æºä¸Šå·²ç»æœ‰è¶…è¿‡2000ä¸ªè½¯ä»¶åŒ…äº†ï¼Œå¯ä»¥è¯´æ˜¯éå¸¸çš„ä¸°å¯Œ</p><p>ä¸åŒçš„å›ºä»¶ï¼Œå®‰è£…æ–¹å¼éƒ½ä¸ä¸€æ ·ï¼Œè¯·è®¤å‡†å®‰è£…æ–¹å¼ï¼ˆè‡ªå·±æ˜¯ä»€ä¹ˆå›ºä»¶æ€»è¯¥æ‡‚å¾—å§ğŸ˜‚ï¼‰</p><p><a href="https://zhih.me/Padavan-entware/">åœ¨ Padavan ä¸Šä½¿ç”¨ Entware</a></p><p><a href="https://zhih.me/LEDE-entware">åœ¨ LEDE ä¸Šä½¿ç”¨ Entware</a></p><p><a href="https://zhih.me/Merlin-entware">åœ¨æ¢…æ—ä¸Šä½¿ç”¨ Entware</a></p><h3 id="2-å®‰è£…onmp"><a href="#2-å®‰è£…onmp" class="headerlink" title="2. å®‰è£…onmp"></a>2. å®‰è£…onmp</h3><p>ä¸€é”®å‘½ä»¤ï¼Œå¤åˆ¶-&gt;ç²˜è´´-&gt;å›è½¦</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sh -c <span class="string">"<span class="variable">$(curl -kfsSL https://raw.githubusercontent.com/xzhih/ONMP/master/oneclick.sh)</span>"</span></span><br></pre></td></tr></table></figure><p>ä¸€é•¿ä¸²çš„å¤åˆ¶å¦‚æœå‡ºé”™ï¼Œå¯ä»¥æŒ‰ç…§ä»¥ä¸‹ç»™å‡ºçš„å‘½ä»¤ï¼Œä¸€æ­¥æ­¥è¿›è¡Œå®‰è£…</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># è¿›å…¥ entware æŒ‚è½½ç›®å½•</span></span><br><span class="line"><span class="built_in">cd</span> /opt &amp;&amp; opkg install wget unzip </span><br><span class="line"></span><br><span class="line"><span class="comment"># ä¸‹è½½è½¯ä»¶åŒ…</span></span><br><span class="line">wget --no-check-certificate -O /opt/onmp.zip https://github.com/xzhih/ONMP/archive/master.zip </span><br><span class="line"></span><br><span class="line"><span class="comment"># è§£å‹</span></span><br><span class="line">unzip /opt/onmp.zip</span><br><span class="line"></span><br><span class="line"><span class="built_in">cd</span> /opt/onmp</span><br><span class="line"></span><br><span class="line"><span class="comment"># è¿è¡Œ</span></span><br><span class="line">chmod +x ./onmp.sh </span><br><span class="line">./onmp.sh</span><br></pre></td></tr></table></figure><p>è¦æ˜¯æ­£å¸¸è¿è¡Œåˆ°è„šæœ¬ï¼Œä¼šå‡ºç°ä¸‹é¢çš„æƒ…æ™¯ï¼Œé€‰1å®‰è£…å³å¯</p><p><img src="https://pic.zhih.me/blog/posts/onmp-installation/å®‰è£….jpg" alt="å®‰è£…"></p><p>æ­£å¸¸å®‰è£…ä¸­è¦æ˜¯å‡ºç°é”™è¯¯ï¼Œä¼šæœ‰é”™è¯¯ä¿¡æ¯ï¼Œæ ¹æ®æç¤ºæ“ä½œï¼Œç›®å‰å¾—åˆ°çš„å¤§å¤šæ•°åé¦ˆéƒ½æ˜¯ç½‘ç»œé—®é¢˜ï¼Œå› ä¸º entware çš„æºåœ¨å›½å¤–ï¼Œè€Œä¸”ä»–ä»¬çš„ç®¡ç†è€…è¯´ä¹‹å‰å—åˆ°äº†æ¥è‡ªäºšæ´²çš„ DDOSï¼Œæ‰€ä»¥å¯¹è¿™è¾¹é™æµäº†ï¼Œé€Ÿåº¦è¾ƒæ…¢ã€‚é‡åˆ°è¿™ç§æƒ…å†µï¼Œå¯ä»¥å»çœ‹çœ‹å‰§ï¼Œæ²¡å‡†å›æ¥çš„æ—¶å€™å°±å¥½äº†ğŸ˜„</p><p>å®‰è£…æˆåŠŸå¾—åˆ°çš„ç»“æœæ˜¯è¿™æ ·çš„</p><p><img src="https://pic.zhih.me/blog/posts/onmp-installation/å®‰è£…æˆåŠŸ.jpg" alt="å®‰è£…æˆåŠŸ"></p><p>å¦‚æœä½ ä¹Ÿæ˜¯å’Œä¸Šå›¾ä¸€æ ·ï¼Œé‚£ä¹ˆæ­å–œä½ ï¼ŒæˆåŠŸçš„å®‰è£…ä¸Šäº† ONMPï¼Œä½ å¯ä»¥å°½æƒ…çš„ç©è€äº†</p><h2 id="ONMP-è¯¦ç»†ä½¿ç”¨æ•™ç¨‹"><a href="#ONMP-è¯¦ç»†ä½¿ç”¨æ•™ç¨‹" class="headerlink" title="ONMP è¯¦ç»†ä½¿ç”¨æ•™ç¨‹"></a>ONMP è¯¦ç»†ä½¿ç”¨æ•™ç¨‹</h2><h3 id="åŸºæœ¬å‘½ä»¤ï¼š"><a href="#åŸºæœ¬å‘½ä»¤ï¼š" class="headerlink" title="åŸºæœ¬å‘½ä»¤ï¼š"></a>åŸºæœ¬å‘½ä»¤ï¼š</h3><figure class="highlight livecodeserver"><table><tr><td class="code"><pre><span class="line">ç®¡ç†ï¼šonmp <span class="built_in">open</span></span><br><span class="line">å¯åŠ¨ã€åœæ­¢ã€é‡å¯ï¼šonmp <span class="built_in">start</span>|<span class="built_in">stop</span>|restart</span><br><span class="line">æŸ¥çœ‹ç½‘ç«™åˆ—è¡¨ï¼šonmp list</span><br></pre></td></tr></table></figure><h3 id="è®¾ç½®æ•°æ®åº“å¯†ç ï¼š"><a href="#è®¾ç½®æ•°æ®åº“å¯†ç ï¼š" class="headerlink" title="è®¾ç½®æ•°æ®åº“å¯†ç ï¼š"></a>è®¾ç½®æ•°æ®åº“å¯†ç ï¼š</h3><p>è¾“å…¥ <code>onmp open</code> åé€‰æ‹©3ï¼Œä¼šæç¤º <code>Enter password:</code> ï¼Œè¿™ä¸ªæ—¶å€™è¦è¾“å…¥å½“å‰æ•°æ®åº“çš„å¯†ç ï¼Œæ¯”å¦‚æˆ‘åˆå§‹è®¾ç½®çš„æ•°æ®åº“å¯†ç æ˜¯ 123456ï¼Œå›è½¦åè¦æ˜¯å¯†ç æ­£ç¡®ï¼Œä¼šæç¤ºè¾“å…¥ä½ è¦è®¾ç½®çš„æ–°å¯†ç ï¼Œå›è½¦åä¼šæç¤ºå†æ¬¡è¾“å…¥ç¡®è®¤ã€‚ä¹Ÿå°±æ˜¯ï¼Œä¸€æ¬¡æ—§å¯†ç ï¼Œä¸¤æ¬¡æ–°å¯†ç ã€‚</p><p>è¿™ä¸ªä½ç½®å¾ˆç®€å•ï¼Œä½†æ˜¯å¾ˆå¤šäººéƒ½è¯´æ”¹ä¸äº†å¯†ç ï¼Œå…¶å®æ˜¯æ²¡çœ‹æç¤ºï¼Œæ²¡è¾“å…¥æ—§å¯†ç ï¼Œæ‰€ä»¥æˆ‘å†™æ¸…æ¥šä¸€äº›ã€‚</p><blockquote><p>æœ¬æ–‡ç« å‘è¡¨äºåº•å™ªåšå®¢ <a href="https://zhih.me">https://zhih.me</a> , è½¬è½½è¯·æ³¨æ˜</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> æ•™ç¨‹ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> onmp </tag>
            
            <tag> shell </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>åœ¨Padavan ä¸Šä½¿ç”¨Entware</title>
      <link href="/Padavan-entware/"/>
      <url>/Padavan-entware/</url>
      
        <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>Entware æ˜¯ä¸€ä¸ªé€‚ç”¨äºåµŒå…¥å¼ç³»ç»Ÿçš„è½¯ä»¶åŒ…åº“ï¼Œä½¿ç”¨ opkg åŒ…ç®¡ç†ç³»ç»Ÿè¿›è¡Œç®¡ç†ï¼Œç°åœ¨åœ¨å®˜æ–¹çš„æºä¸Šå·²ç»æœ‰è¶…è¿‡ 2000 ä¸ªè½¯ä»¶åŒ…äº†ï¼Œå¯ä»¥è¯´æ˜¯éå¸¸çš„ä¸°å¯Œ</p><p>å®˜æ–¹åœ°å€ï¼š<a href="https://entware.net/" target="_blank" rel="noopener">Entware</a></p><h2 id="Uç›˜ã€ç¡¬ç›˜æ ¼å¼åŒ–ï¼ˆå¯é€‰ï¼‰"><a href="#Uç›˜ã€ç¡¬ç›˜æ ¼å¼åŒ–ï¼ˆå¯é€‰ï¼‰" class="headerlink" title="Uç›˜ã€ç¡¬ç›˜æ ¼å¼åŒ–ï¼ˆå¯é€‰ï¼‰"></a>Uç›˜ã€ç¡¬ç›˜æ ¼å¼åŒ–ï¼ˆå¯é€‰ï¼‰</h2><p>æˆ‘ä»¬çš„è®¾å¤‡æœ¬èº«çš„å‚¨å­˜è¾ƒå°‘ï¼Œè€Œä¸”å¦‚æœå“ªå¤©å´©äº†ï¼Œæ•°æ®è¿˜æœ‰æ‰¾ä¸å›çš„é£é™©ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¸€èˆ¬æŠŠè½¯ä»¶åŒ…å’Œç¨‹åºå®‰è£…åˆ° U ç›˜ä¹‹ç±»çš„å¤–ç½®è®¾å¤‡ä¸Šï¼Œæ‰€ä»¥éœ€è¦å¯¹å®ƒè¿›è¡Œæ ¼å¼åŒ–ï¼Œä»¥ä¸‹æ•™ç¨‹å…¨åŸºäº ext4 åˆ†åŒºæ ¼å¼ï¼ŒNTFS æ ¼å¼æˆ‘ä¸ªäººä¸æ¨èä½¿ç”¨</p><p>æ ¼å¼åŒ–æ•™ç¨‹ï¼š<a href="https://zhih.me/format-Upan-partition">å¦‚ä½•åœ¨è·¯ç”±å™¨ä¸Šæ ¼å¼åŒ–Uç›˜ã€ç¡¬ç›˜</a></p><h2 id="å®‰è£…-Entware"><a href="#å®‰è£…-Entware" class="headerlink" title="å®‰è£… Entware"></a>å®‰è£… Entware</h2><h3 id="1-æ–°å»º-opt-æ–‡ä»¶å¤¹"><a href="#1-æ–°å»º-opt-æ–‡ä»¶å¤¹" class="headerlink" title="1. æ–°å»º opt æ–‡ä»¶å¤¹"></a>1. æ–°å»º opt æ–‡ä»¶å¤¹</h3><ul><li><p>å¦‚æœä½ æ˜¯åœ¨ç”µè„‘ä¸Šæ ¼å¼åŒ–çš„ U ç›˜ï¼Œå¹¶ä¸”çŸ¥é“æ€ä¹ˆåœ¨ç”µè„‘ä¸Šè¯»å– ext4 åˆ†åŒºï¼Œé‚£ä¹ˆåœ¨ ext4 åˆ†åŒºçš„æ ¹ç›®å½•æ–°å»ºä¸€ä¸ª opt æ–‡ä»¶å¤¹</p></li><li><p>æˆ–è€…ä½ å¯ä»¥æŠŠ U ç›˜æ’åˆ°è·¯ç”±å™¨ä¸Šï¼Œå¼€å¯ samba å¹¶é€šè¿‡ç”µè„‘è®¿é—® sambaï¼Œåœ¨ U ç›˜ä¸‹åˆ›å»º opt æ–‡ä»¶å¤¹</p></li><li><p>å¦‚æœä½ ä¸Šé¢çš„ä¸ä¼šï¼Œå¹¶ä¸”æŒ‰ç…§æˆ‘çš„æ•™ç¨‹åœ¨è·¯ç”±å™¨ä¸Šæ ¼å¼åŒ– U ç›˜ï¼Œè¿˜å¯ä»¥æŒ‰ç…§ä»¥ä¸‹åšæ³•</p></li></ul><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">ejusb</span><br><span class="line">mkdir /media/onmp</span><br><span class="line">mount -t ext4 /dev/sda1 /media/onmp</span><br><span class="line"><span class="comment"># /dev/sda1 æ˜¯ä½ çš„ ext4 åˆ†åŒº</span></span><br><span class="line"></span><br><span class="line">mkdir /media/onmp/opt</span><br></pre></td></tr></table></figure><p>è¿™æ ·å°±åˆ›å»ºå¥½ opt æ–‡ä»¶å¤¹äº†ï¼Œä¹‹åè£…çš„æ‰€æœ‰ä¸œè¥¿éƒ½ä¼šåœ¨é‡Œé¢</p><h3 id="2-å¼€å¯-Entware"><a href="#2-å¼€å¯-Entware" class="headerlink" title="2. å¼€å¯ Entware"></a>2. å¼€å¯ Entware</h3><p>å…ˆå¸è½½ U ç›˜</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">ejusb</span><br></pre></td></tr></table></figure><p>ç„¶ååœ¨è·¯ç”±å™¨ç®¡ç†é¡µæ‰“å¼€ Entware</p><p><img src="https://pic.zhih.me/blog/posts/Padavan-entware/åœ¨Padavanä¸Šä½¿ç”¨entware.jpg" alt="åœ¨ Padavan ä¸Šä½¿ç”¨ entware "></p><p>æ‹”ä¸‹ U ç›˜å†é‡æ–°æ’å…¥ï¼Œç­‰ä¸€å°ä¼šå„¿</p><h3 id="3-æŸ¥çœ‹æ˜¯å¦æˆåŠŸæŒ‚è½½-opt"><a href="#3-æŸ¥çœ‹æ˜¯å¦æˆåŠŸæŒ‚è½½-opt" class="headerlink" title="3. æŸ¥çœ‹æ˜¯å¦æˆåŠŸæŒ‚è½½ /opt"></a>3. æŸ¥çœ‹æ˜¯å¦æˆåŠŸæŒ‚è½½ /opt</h3><p>è¿›å…¥ shellï¼Œè¾“å…¥ <code>df -h</code>ï¼Œçœ‹åˆ° <code>/opt</code> æŒ‚è½½äº†å°±å¯¹äº†</p><p><img src="https://pic.zhih.me/blog/posts/Padavan-entware/æŸ¥çœ‹æ˜¯å¦æˆåŠŸæŒ‚è½½.jpg" alt="æŸ¥çœ‹æ˜¯å¦æˆåŠŸæŒ‚è½½ /opt"></p><p>å¦‚æœ opt æ²¡æŒ‚è½½ï¼Œè¯´æ˜æ²¡å®‰è£…ä¸Šï¼Œè¯·ä¿è¯ opt æ–‡ä»¶å¤¹å·²ç»åˆ›å»ºæ­£ç¡®ï¼Œç¡®è®¤æ— è¯¯ï¼Œåˆ™å¯ä»¥è¿› shell è¾“å…¥ <code>opkg.sh</code> å›è½¦å®‰è£…</p><p>å¦‚æœä½¿ç”¨å›ºä»¶è‡ªå¸¦è„šæœ¬å‡ºç°é”™è¯¯ï¼Œå¯ä»¥å°è¯•ä½¿ç”¨ä»¥ä¸‹è„šæœ¬</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">wget -O - http://bin.entware.net/mipselsf-k3.4/installer/generic.sh | /bin/sh</span><br></pre></td></tr></table></figure><h3 id="æµ‹è¯•-opkg-å‘½ä»¤"><a href="#æµ‹è¯•-opkg-å‘½ä»¤" class="headerlink" title="æµ‹è¯• opkg å‘½ä»¤"></a>æµ‹è¯• opkg å‘½ä»¤</h3><p>ä»¥ä¸Šæ­¥éª¤ä¹‹åï¼Œä¸å‡ºæ„å¤–å°±è£…ä¸Šäº†ï¼Œæˆ‘ä»¬ç°åœ¨å¯ä»¥æµ‹è¯•ä¸€ä¸‹</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">opkg update</span><br></pre></td></tr></table></figure><h2 id="å…¶ä»–"><a href="#å…¶ä»–" class="headerlink" title="å…¶ä»–"></a>å…¶ä»–</h2><p><a href="https://zhih.me/LEDE-entware/">åœ¨ LEDE ä¸Šä½¿ç”¨ Entware</a></p><p><a href="https://zhih.me/Merlin-entware/">åœ¨æ¢…æ—ä¸Šä½¿ç”¨ Entware</a></p><p>ONMP æ˜¯ä¸€ä¸ª web ç¯å¢ƒå¿«é€Ÿå®‰è£…è„šæœ¬ï¼Œé€‚ç”¨äºå®‰è£…äº† <a href="https://entware.net/" target="_blank" rel="noopener">Entware</a> çš„è·¯ç”±å™¨ï¼Œç›®å‰å·²ç»åœ¨ Padavanã€LEDEï¼ˆopenwrtï¼‰ã€æ¢…æ—ä¸Šæµ‹è¯•æˆåŠŸã€‚</p><p><a href="https://zhih.me/onmp-installation/">ONMP å®‰è£…æ•™ç¨‹</a></p><blockquote><p>æœ¬æ–‡ç« å‘è¡¨äºåº•å™ªåšå®¢ <a href="https://zhih.me">https://zhih.me</a> , è½¬è½½è¯·æ³¨æ˜</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> æ•™ç¨‹ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> onmp </tag>
            
            <tag> entware </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>åœ¨LEDEä¸Šä½¿ç”¨Entware</title>
      <link href="/LEDE-entware/"/>
      <url>/LEDE-entware/</url>
      
        <content type="html"><![CDATA[<h2 id="å¼•è¨€"><a href="#å¼•è¨€" class="headerlink" title="å¼•è¨€"></a>å¼•è¨€</h2><p>Entware æ˜¯ä¸€ä¸ªé€‚ç”¨äºåµŒå…¥å¼ç³»ç»Ÿçš„è½¯ä»¶åŒ…åº“ï¼Œä½¿ç”¨ opkg åŒ…ç®¡ç†ç³»ç»Ÿè¿›è¡Œç®¡ç†ï¼Œç°åœ¨åœ¨å®˜æ–¹çš„æºä¸Šå·²ç»æœ‰è¶…è¿‡2000ä¸ªè½¯ä»¶åŒ…äº†ï¼Œå¯ä»¥è¯´æ˜¯éå¸¸çš„ä¸°å¯Œ</p><p>å®˜æ–¹åœ°å€ï¼š<a href="https://entware.net/" target="_blank" rel="noopener">Entware</a></p><h2 id="Uç›˜ã€ç¡¬ç›˜æ ¼å¼åŒ–ï¼ˆå¯é€‰ï¼‰"><a href="#Uç›˜ã€ç¡¬ç›˜æ ¼å¼åŒ–ï¼ˆå¯é€‰ï¼‰" class="headerlink" title="Uç›˜ã€ç¡¬ç›˜æ ¼å¼åŒ–ï¼ˆå¯é€‰ï¼‰"></a>Uç›˜ã€ç¡¬ç›˜æ ¼å¼åŒ–ï¼ˆå¯é€‰ï¼‰</h2><p>æˆ‘ä»¬çš„è®¾å¤‡æœ¬èº«çš„å‚¨å­˜è¾ƒå°‘ï¼Œè€Œä¸”å¦‚æœå“ªå¤©å´©äº†ï¼Œæ•°æ®è¿˜æœ‰æ‰¾ä¸å›çš„é£é™©ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¸€èˆ¬æŠŠè½¯ä»¶åŒ…å’Œç¨‹åºå®‰è£…åˆ°Uç›˜ä¹‹ç±»çš„å¤–ç½®è®¾å¤‡ä¸Šï¼Œæ‰€ä»¥éœ€è¦å¯¹å®ƒè¿›è¡Œæ ¼å¼åŒ–ï¼ŒNTFS æ ¼å¼æˆ‘ä¸ªäººä¸æ¨èä½¿ç”¨</p><p>æ ¼å¼åŒ–æ•™ç¨‹ï¼š<a href="https://zhih.me/format-Upan-partition">å¦‚ä½•åœ¨è·¯ç”±å™¨ä¸Šæ ¼å¼åŒ–Uç›˜ã€ç¡¬ç›˜</a></p><h2 id="ä¸€é”®å®‰è£…"><a href="#ä¸€é”®å®‰è£…" class="headerlink" title="ä¸€é”®å®‰è£…"></a>ä¸€é”®å®‰è£…</h2><p>ç”¨ä»¥ä¸‹å‘½ä»¤å¯ä»¥å®ç°ä¸€é”®å®‰è£…ï¼Œæ­¤è„šæœ¬åªæ”¯æŒ ext4 åˆ†åŒº</p><p>è¿è¡Œå‘½ä»¤ï¼Œé€‰æ‹©è¦å®‰è£…åˆ°çš„åˆ†åŒºï¼Œç­‰å¾…å®‰è£…å®Œæˆ</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sh -c <span class="string">"<span class="variable">$(curl -kfsSL https://raw.githubusercontent.com/xzhih/ONMP/master/lede-ent.sh)</span>"</span></span><br></pre></td></tr></table></figure><p>å¦‚æœæç¤ºæ‰¾ä¸åˆ° curl å‘½ä»¤ï¼Œå¯ä»¥ç”¨ä¸‹é¢è¿™ä¸ªæ–¹æ³•</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">cd</span> /tmp</span><br><span class="line">wget -c -O https://raw.githubusercontent.com/xzhih/ONMP/master/lede-ent.sh</span><br><span class="line">chmod +x ./lede-ent.sh</span><br><span class="line">./lede-ent.sh</span><br></pre></td></tr></table></figure><p>ä¸€é”®å®‰è£…å¦‚æœå‡ºé”™ï¼Œæˆ–è€…é‡å¯å Entware å¤±æ•ˆï¼Œå¯ä»¥ä½¿ç”¨ä¸‹é¢çš„æ‰‹åŠ¨å®‰è£…</p><h2 id="æ‰‹åŠ¨å®‰è£…"><a href="#æ‰‹åŠ¨å®‰è£…" class="headerlink" title="æ‰‹åŠ¨å®‰è£…"></a>æ‰‹åŠ¨å®‰è£…</h2><p>æ‰‹åŠ¨å®‰è£…å¯ä¸€é”®å®‰è£…ä¸åŒï¼Œä¸€é”®å®‰è£…ä½¿ç”¨è½¯è¿æ¥ opt çš„æ–¹å¼ï¼Œè€Œæ‰‹åŠ¨åˆ™æ˜¯ä»¥æŒ‚è½½ç‚¹çš„æ–¹å¼ï¼Œå¯ä»¥è¯´æ›´ç¨³å®š</p><h3 id="Uç›˜æŒ‚è½½"><a href="#Uç›˜æŒ‚è½½" class="headerlink" title="Uç›˜æŒ‚è½½"></a>Uç›˜æŒ‚è½½</h3><p>åˆ†åŒºã€æ ¼å¼éƒ½æ²¡é—®é¢˜ä¹‹åï¼Œå¼€å§‹æŒ‚è½½</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">mkdir /mnt/onmp</span><br></pre></td></tr></table></figure><h4 id="æŒ‚è½½æ–¹æ³•1"><a href="#æŒ‚è½½æ–¹æ³•1" class="headerlink" title="æŒ‚è½½æ–¹æ³•1"></a>æŒ‚è½½æ–¹æ³•1</h4><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">mount -t ext4 /dev/sda1 /mnt/onmp</span><br><span class="line"><span class="comment"># è¿™æ ·å°±æŒ‚è½½ä¸Šäº†</span></span><br><span class="line"></span><br><span class="line">df -h</span><br><span class="line">Filesystem                Size      Used Available Use% Mounted on</span><br><span class="line">/dev/sda1               975.5M      2.5M    906.6M   0% /mnt/onmp</span><br><span class="line"><span class="comment"># å¯ä»¥çœ‹åˆ°å·²ç»æŒ‚è½½</span></span><br></pre></td></tr></table></figure><h4 id="æŒ‚è½½æ–¹æ³•2ï¼ˆæ¨èï¼‰"><a href="#æŒ‚è½½æ–¹æ³•2ï¼ˆæ¨èï¼‰" class="headerlink" title="æŒ‚è½½æ–¹æ³•2ï¼ˆæ¨èï¼‰"></a>æŒ‚è½½æ–¹æ³•2ï¼ˆæ¨èï¼‰</h4><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">vi /etc/fstab <span class="comment"># æŒ‰ä¸€ä¸‹iç¼–è¾‘æ–‡ä»¶</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æ·»åŠ ä¸‹é¢è¿™ä¸€è¡Œ</span></span><br><span class="line">/dev/sda1 /mnt/onmp ext4 defaults 0 1 </span><br><span class="line"><span class="comment"># æŒ‰ä¸€ä¸‹Escå†è¾“å…¥å†’å·`:`ï¼Œè¾“å…¥wqå›è½¦ä¿å­˜</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># ä»¥åæ¯æ¬¡è¦æŒ‚è½½å°±ç›´æ¥è¾“å…¥è¿™ä¸ªå‘½ä»¤</span></span><br><span class="line">mount -a</span><br></pre></td></tr></table></figure><p>å¼€æœºè‡ªåŠ¨æŒ‚è½½</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">vi /etc/rc.local <span class="comment"># ç¼–è¾‘ï¼ŒvimåŸºæœ¬ç”¨æ³•å’Œä¸Šé¢ä¸€æ ·</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># åœ¨exit 0ä¹‹å‰æ·»åŠ ä»¥ä¸‹å‘½ä»¤ï¼Œå¼€æœºåä¼šè‡ªåŠ¨æ‰§è¡ŒæŒ‚è½½</span></span><br><span class="line">mount -a</span><br></pre></td></tr></table></figure><h3 id="å®‰è£…å’Œä½¿ç”¨-Entware"><a href="#å®‰è£…å’Œä½¿ç”¨-Entware" class="headerlink" title="å®‰è£…å’Œä½¿ç”¨ Entware"></a>å®‰è£…å’Œä½¿ç”¨ Entware</h3><h4 id="1-æŒ‚è½½opt"><a href="#1-æŒ‚è½½opt" class="headerlink" title="1. æŒ‚è½½opt"></a>1. æŒ‚è½½opt</h4><p>åœ¨Uç›˜ä¸Šåˆ›å»ºä¸€ä¸ªç©ºçš„ opt æ–‡ä»¶å¤¹</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">mkdir /mnt/onmp/opt</span><br></pre></td></tr></table></figure><p>åœ¨ç³»ç»Ÿæ ¹ç›®å½•åˆ›å»º opt æ–‡ä»¶å¤¹ï¼Œå¹¶ç»‘å®šUç›˜çš„ opt æ–‡ä»¶å¤¹</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">mkdir /opt</span><br><span class="line">mount -o <span class="built_in">bind</span> /mnt/onmp/opt /opt</span><br><span class="line"><span class="comment"># å¯ä»¥ç”¨ mount æˆ– df -h å‘½ä»¤æŸ¥çœ‹æ˜¯å¦æŒ‚è½½æˆåŠŸ</span></span><br></pre></td></tr></table></figure><h4 id="2-è¿è¡Œ-Entware-å®‰è£…å‘½ä»¤"><a href="#2-è¿è¡Œ-Entware-å®‰è£…å‘½ä»¤" class="headerlink" title="2. è¿è¡Œ Entware å®‰è£…å‘½ä»¤"></a>2. è¿è¡Œ Entware å®‰è£…å‘½ä»¤</h4><p>ä¸åŒçš„ CPU å¹³å°æœ‰ä¸åŒçš„å‘½ä»¤ï¼Œå¯ä»¥ä½¿ç”¨ <code>uname -m</code> å‘½ä»¤æŸ¥çœ‹å¹³å°</p><ul><li>armv5</li></ul><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">wget -O - http://bin.entware.net/armv5sf-k3.2/installer/generic.sh | /bin/sh</span><br></pre></td></tr></table></figure><ul><li>armv7</li></ul><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">wget -O - http://bin.entware.net/armv7sf-k3.2/installer/generic.sh | /bin/sh</span><br></pre></td></tr></table></figure><ul><li>armv8 (aarch64)</li></ul><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">wget -O - http://bin.entware.net/aarch64-k3.10/installer/generic.sh | /bin/sh</span><br></pre></td></tr></table></figure><ul><li>x86-64</li></ul><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">wget -O - http://bin.entware.net/x64-k3.2/installer/generic.sh | /bin/sh</span><br></pre></td></tr></table></figure><ul><li>MIPS</li></ul><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">wget -O - http://bin.entware.net/mipselsf-k3.4/installer/generic.sh | /bin/sh</span><br></pre></td></tr></table></figure><p>åœ¨è¾“å…¥å‘½ä»¤ä¹‹åä¹‹åä¼šè‡ªå·±è·‘èµ·æ¥ï¼Œå‡ºç°ä»¥ä¸‹ç»“æœå°±ä»£è¡¨æˆåŠŸï¼Œæ²¡æˆåŠŸçš„è®°å¾—æŠŠUç›˜ä¸Šçš„optæ–‡ä»¶å¤¹æ¸…ç©ºå†æ¥</p><figure class="highlight coq"><table><tr><td class="code"><pre><span class="line"><span class="keyword">Info</span>: Congratulations!</span><br><span class="line"><span class="keyword">Info</span>: <span class="keyword">If</span> there are no errors above <span class="keyword">then</span> Entware was successfully initialized.</span><br></pre></td></tr></table></figure><h4 id="3-å¼€æœºå¯åŠ¨"><a href="#3-å¼€æœºå¯åŠ¨" class="headerlink" title="3. å¼€æœºå¯åŠ¨"></a>3. å¼€æœºå¯åŠ¨</h4><p>ç¼–è¾‘ <code>/etc/rc.local</code> å°†ä»¥ä¸‹ä»£ç åŠ åœ¨ <code>exit 0</code> ä¹‹å‰ï¼Œ<code>mount -a</code> ä¹‹å</p><figure class="highlight armasm"><table><tr><td class="code"><pre><span class="line"><span class="symbol">mkdir</span> -p /<span class="meta">opt</span></span><br><span class="line"><span class="symbol">mount</span> -o <span class="keyword">bind </span>/mnt/onmp/<span class="meta">opt</span> /<span class="meta">opt</span></span><br><span class="line">/<span class="meta">opt</span>/etc/init.d/rc.unslung start</span><br></pre></td></tr></table></figure><h4 id="4-ç¯å¢ƒå˜é‡"><a href="#4-ç¯å¢ƒå˜é‡" class="headerlink" title="4. ç¯å¢ƒå˜é‡"></a>4. ç¯å¢ƒå˜é‡</h4><p>ç¼–è¾‘ <code>/etc/profile</code> åœ¨ä»–çš„æœ€ååŠ å…¥ä»¥ä¸‹ä»£ç </p><figure class="highlight vim"><table><tr><td class="code"><pre><span class="line">. /<span class="keyword">opt</span>/etc/<span class="keyword">profile</span></span><br></pre></td></tr></table></figure><p>è¿™æ ·å¼€æœºä¹‹åå°†ä¼šæ·»åŠ  <code>/opt/bin</code> å’Œ <code>/opt/sbin</code> åˆ°ç¯å¢ƒå˜é‡ PATH é‡Œ</p><p><strong>æ³¨æ„</strong>ï¼Œ<code>.</code> çš„åé¢æœ‰ä¸€ä¸ªç©ºæ ¼ï¼Œä¸æ˜¯è¿ç€çš„</p><h4 id="5-é‡å¯"><a href="#5-é‡å¯" class="headerlink" title="5. é‡å¯"></a>5. é‡å¯</h4><p>é‡å¯ä¹‹åï¼Œå¯ä»¥ä½¿ç”¨ä¸€ä¸‹å‘½ä»¤æ£€æŸ¥æ˜¯å¦æˆåŠŸ</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># æ£€æŸ¥ç¯å¢ƒå˜é‡</span></span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$PATH</span></span><br><span class="line"><span class="comment"># å¯ä»¥çœ‹åˆ°å·²ç»æœ‰/optçš„è·¯å¾„äº†</span></span><br><span class="line">/opt/bin:/opt/sbin:/usr/sbin:/usr/bin:/sbin:/bin </span><br><span class="line"></span><br><span class="line"><span class="comment"># æ£€æŸ¥ `/opt` æŒ‚è½½æƒ…å†µ</span></span><br><span class="line">df -h</span><br><span class="line">/dev/sda1               975.5M     13.9M    895.2M   2% /mnt/onmp <span class="comment"># Uç›˜æŒ‚è½½æˆåŠŸ</span></span><br><span class="line">/dev/sda1               975.5M     13.9M    895.2M   2% /opt <span class="comment"># optæŒ‚è½½æˆåŠŸ</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># opkg æ›´æ–°æ•°æ®</span></span><br><span class="line">opkg update</span><br><span class="line">Downloading http://pkg.entware.net/binaries/x86-64/Packages.gz </span><br><span class="line">Updated list of available packages <span class="keyword">in</span> /opt/var/opkg-lists/packages <span class="comment"># æˆåŠŸ</span></span><br></pre></td></tr></table></figure><p>ç»è¿‡ä»¥ä¸Šæ­¥éª¤ï¼Œå·²ç»å¯ä»¥ä» <code>Entware</code> ä¸Šè¿›è¡Œä¸‹è½½å®‰è£…åŒ…å¹¶å®‰è£…åˆ°Uç›˜ä¸Š</p><p>è¿™ä¸‹å¯ä»¥äº«å—ä¸°å¯Œçš„è½¯ä»¶åŒ…ï¼Œè¿˜ä¸å ç”¨å†…éƒ¨å‚¨å­˜ç©ºé—´ï¼Œéå¸¸é€‚åˆLEDEè½¯è·¯ç”±<br>æˆ‘çš„ onmp ä¸€é”®åŒ…ä¹Ÿå¯ä»¥åœ¨ LEDE ä¸Šä½¿ç”¨äº†</p><h2 id="Tips"><a href="#Tips" class="headerlink" title="Tips"></a>Tips</h2><p>æ¯æ¬¡å‡çº§å›ºä»¶åå¦‚æœå¤±æ•ˆäº†ï¼Œé‡æ–°è®¾ç½®å¼€æœºå¯åŠ¨å’Œç¯å¢ƒå˜é‡å³å¯</p><h2 id="PS"><a href="#PS" class="headerlink" title="PS"></a>PS</h2><p><a href="https://zhih.me/Merlin-entware/">åœ¨æ¢…æ—ä¸Šä½¿ç”¨Entware</a></p><p><a href="https://zhih.me/Padavan-entware/">åœ¨Padavanä¸Šä½¿ç”¨entware</a></p><p>ONMP æ˜¯ä¸€ä¸ª web ç¯å¢ƒå¿«é€Ÿå®‰è£…è„šæœ¬ï¼Œé€‚ç”¨äºå®‰è£…äº† <a href="https://entware.net/" target="_blank" rel="noopener">Entware</a> çš„è·¯ç”±å™¨ï¼Œç›®å‰å·²ç»åœ¨ Padavanã€LEDEï¼ˆopenwrtï¼‰ã€æ¢…æ—ä¸Šæµ‹è¯•æˆåŠŸã€‚</p><p><a href="https://zhih.me/onmp-installation/">ONMP å®‰è£…æ•™ç¨‹</a></p><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><p><a href="https://github.com/Entware/Entware/wiki/Install-on-Synology-NAS" target="_blank" rel="noopener">Install on Synology NAS</a></p><p><a href="https://bitbucket.org/padavan/rt-n56u/wiki/EN/HowToConfigureEntware" target="_blank" rel="noopener">How To Configure Routers Asus RT-N56U/RT-N65U For Entware Usage</a></p><blockquote><p>æœ¬æ–‡ç« å‘è¡¨äºåº•å™ªåšå®¢ <a href="https://zhih.me">https://zhih.me</a> , è½¬è½½è¯·æ³¨æ˜</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> æ•™ç¨‹ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> LEDE </tag>
            
            <tag> onmp </tag>
            
            <tag> entware </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>åœ¨æ¢…æ—ä¸Šä½¿ç”¨Entware</title>
      <link href="/Merlin-entware/"/>
      <url>/Merlin-entware/</url>
      
        <content type="html"><![CDATA[<h2 id="å¼•è¨€"><a href="#å¼•è¨€" class="headerlink" title="å¼•è¨€"></a>å¼•è¨€</h2><p>Entware æ˜¯ä¸€ä¸ªé€‚ç”¨äºåµŒå…¥å¼ç³»ç»Ÿçš„è½¯ä»¶åŒ…åº“ï¼Œä½¿ç”¨ opkg åŒ…ç®¡ç†ç³»ç»Ÿè¿›è¡Œç®¡ç†ï¼Œç°åœ¨åœ¨å®˜æ–¹çš„æºä¸Šå·²ç»æœ‰è¶…è¿‡ 2000 ä¸ªè½¯ä»¶åŒ…äº†ï¼Œå¯ä»¥è¯´æ˜¯éå¸¸çš„ä¸°å¯Œ</p><p>å®˜æ–¹åœ°å€ï¼š<a href="https://entware.net/" target="_blank" rel="noopener">Entware</a></p><h2 id="Uç›˜ã€ç¡¬ç›˜æ ¼å¼åŒ–ï¼ˆå¯é€‰ï¼‰"><a href="#Uç›˜ã€ç¡¬ç›˜æ ¼å¼åŒ–ï¼ˆå¯é€‰ï¼‰" class="headerlink" title="Uç›˜ã€ç¡¬ç›˜æ ¼å¼åŒ–ï¼ˆå¯é€‰ï¼‰"></a>Uç›˜ã€ç¡¬ç›˜æ ¼å¼åŒ–ï¼ˆå¯é€‰ï¼‰</h2><p>æˆ‘ä»¬çš„è®¾å¤‡æœ¬èº«çš„å‚¨å­˜è¾ƒå°‘ï¼Œè€Œä¸”å¦‚æœå“ªå¤©å´©äº†ï¼Œæ•°æ®è¿˜æœ‰æ‰¾ä¸å›çš„é£é™©ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¸€èˆ¬æŠŠè½¯ä»¶åŒ…å’Œç¨‹åºå®‰è£…åˆ°Uç›˜ä¹‹ç±»çš„å¤–ç½®è®¾å¤‡ä¸Šï¼Œæ‰€ä»¥éœ€è¦å¯¹å®ƒæ ¼å¼åŒ–ä¸º ext4ï¼ŒNTFS æ ¼å¼ä¸æ¨èä½¿ç”¨</p><p>æ ¼å¼åŒ–æ•™ç¨‹ï¼š<a href="https://zhih.me/format-Upan-partition">å¦‚ä½•åœ¨è·¯ç”±å™¨ä¸Šæ ¼å¼åŒ–Uç›˜ã€ç¡¬ç›˜</a></p><h2 id="Uç›˜æŒ‚è½½ï¼ˆå¯é€‰ï¼‰"><a href="#Uç›˜æŒ‚è½½ï¼ˆå¯é€‰ï¼‰" class="headerlink" title="Uç›˜æŒ‚è½½ï¼ˆå¯é€‰ï¼‰"></a>Uç›˜æŒ‚è½½ï¼ˆå¯é€‰ï¼‰</h2><p>æ¢…æ—å›ºä»¶å¯ä»¥åœ¨æ’å…¥ç£ç›˜çš„æ—¶å€™è‡ªåŠ¨è¯†åˆ«æ–‡ä»¶ç³»ç»Ÿå¹¶æŒ‚è½½ï¼Œæ‰€ä»¥è¯´æ˜¯ç›¸å½“æ–¹ä¾¿äº†ï¼Œä¸€èˆ¬æˆ‘ä»¬éƒ½ä¸éœ€è¦æ‰§è¡Œè¿™ä¸€æ­¥ï¼Œä¸è¿‡æœ‰äº›å›ºä»¶å¯èƒ½è¿˜æ²¡æœ‰å¾ˆå®Œå–„ï¼Œæ‰€ä»¥æˆ‘ç»™å‡ºä»¥ä¸‹ä¸€ç§æŒ‚è½½çš„æ–¹æ³•ï¼Œä¾›å‚è€ƒã€‚</p><p>åˆ†åŒºã€æ ¼å¼éƒ½æ²¡é—®é¢˜ä¹‹åï¼Œå¼€å§‹æŒ‚è½½</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">mkdir /mnt/sda1</span><br><span class="line">mount -t ext4 /dev/sda1 /mnt/sda1/</span><br><span class="line"><span class="comment"># è¿™æ ·å°±æŒ‚è½½ä¸Šäº†</span></span><br><span class="line">df -h</span><br><span class="line">Filesystem                Size      Used Available Use% Mounted on</span><br><span class="line">/dev/sda1               975.5M      2.5M    906.6M   0% /tmp/mnt/sda1</span><br><span class="line"><span class="comment"># å¯ä»¥çœ‹åˆ°å·²ç»æŒ‚è½½</span></span><br></pre></td></tr></table></figure><h2 id="å®‰è£…å’Œä½¿ç”¨-Entware"><a href="#å®‰è£…å’Œä½¿ç”¨-Entware" class="headerlink" title="å®‰è£…å’Œä½¿ç”¨ Entware"></a>å®‰è£…å’Œä½¿ç”¨ Entware</h2><p>æ¢…æ—å†…ç½®äº†ä¸€ä¸ªå®‰è£…å‘½ä»¤å¾ˆæ–¹ä¾¿</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">entware-setup.sh</span><br><span class="line"></span><br><span class="line"><span class="comment"># ç„¶åä¼šæç¤ºä½ é€‰æ‹©å“ªä¸ªåˆ†åŒºï¼Œå°±é€‰æ‹©åˆšæ‰æŒ‚è½½çš„é‚£ä¸ª</span></span><br><span class="line">Â·Â·Â·çœç•¥</span><br><span class="line">Info:  Looking <span class="keyword">for</span> available partitions...</span><br><span class="line">[1] --&gt; /tmp/mnt/sda1</span><br><span class="line">=&gt;  Please enter partition number or 0 to <span class="built_in">exit</span></span><br><span class="line">[0-1]: 1 <span class="comment"># é€‰1å›è½¦</span></span><br><span class="line">Â·Â·Â·çœç•¥</span><br><span class="line"><span class="comment"># è·‘å®Œä¹‹ååªè¦ä¸æç¤ºé”™è¯¯ï¼Œå°±æ˜¯å®‰è£…æˆåŠŸäº†</span></span><br></pre></td></tr></table></figure><p>ç»è¿‡ä»¥ä¸Šæ­¥éª¤ï¼Œå·²ç»å¯ä»¥ä» Entware ä¸Šè¿›è¡Œä¸‹è½½å®‰è£…åŒ…å¹¶å®‰è£…åˆ°Uç›˜ä¸Š</p><p>è¿™ä¸‹å¯ä»¥äº«å—ä¸°å¯Œçš„è½¯ä»¶åŒ…ï¼Œè¿˜ä¸å ç”¨å†…éƒ¨å‚¨å­˜ç©ºé—´</p><h2 id="PS"><a href="#PS" class="headerlink" title="PS"></a>PS</h2><p><a href="https://zhih.me/Padavan-entware/">åœ¨Padavanä¸Šä½¿ç”¨entware</a></p><p><a href="https://zhih.me/LEDE-entware/">åœ¨LEDEä¸Šä½¿ç”¨Entware</a></p><p>ONMP æ˜¯ä¸€ä¸ª web ç¯å¢ƒå¿«é€Ÿå®‰è£…è„šæœ¬ï¼Œé€‚ç”¨äºå®‰è£…äº† <a href="https://entware.net/" target="_blank" rel="noopener">Entware</a> çš„è·¯ç”±å™¨ï¼Œç›®å‰å·²ç»åœ¨ Padavanã€LEDEï¼ˆopenwrtï¼‰ã€æ¢…æ—ä¸Šæµ‹è¯•æˆåŠŸã€‚</p><p><a href="https://zhih.me/onmp-installation/">ONMP å®‰è£…æ•™ç¨‹</a></p><blockquote><p>æœ¬æ–‡ç« å‘è¡¨äºåº•å™ªåšå®¢ <a href="https://zhih.me">https://zhih.me</a> , è½¬è½½è¯·æ³¨æ˜</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> æ•™ç¨‹ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> onmp </tag>
            
            <tag> entware </tag>
            
            <tag> æ¢…æ— </tag>
            
        </tags>
      
    </entry>
    
  
  
</search>
